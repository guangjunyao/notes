<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-05-31 Wed 22:33 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title></title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="weiwu" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline14">1. Create GitHub Pages:</a>
<ul>
<li><a href="#orgheadline1">1.1. Create a repository</a></li>
<li><a href="#orgheadline2">1.2. Clone the repository</a></li>
<li><a href="#orgheadline3">1.3. Create folder structure</a></li>
<li><a href="#orgheadline4">1.4. Add lines in spacemacs configuration file to publish the org project</a></li>
<li><a href="#orgheadline5">1.5. Publish personal html files</a></li>
<li><a href="#orgheadline6">1.6. Attach markdown files in the org file.</a></li>
<li><a href="#orgheadline7">1.7. Publish ipython file directly.</a></li>
<li><a href="#orgheadline8">1.8. Insert file links in sitemap.org</a></li>
<li><a href="#orgheadline13">1.9. The export options template</a>
<ul>
<li><a href="#orgheadline9">1.9.1. Insert basic information using C-c C-e # default</a></li>
<li><a href="#orgheadline12">1.9.2. Add export templates configuration files</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline18">2. Basic operations in Emacs</a>
<ul>
<li><a href="#orgheadline15">2.1. special syntax</a></li>
<li><a href="#orgheadline16">2.2. insert table box</a></li>
<li><a href="#orgheadline17">2.3. shortcut :</a></li>
</ul>
</li>
<li><a href="#orgheadline29">3. ORG Mode</a>
<ul>
<li><a href="#orgheadline19">3.1. Structure editing</a></li>
<li><a href="#orgheadline23">3.2. Latex</a>
<ul>
<li><a href="#orgheadline20">3.2.1. Greeks:</a></li>
<li><a href="#orgheadline21">3.2.2. Superscript, subscript</a></li>
<li><a href="#orgheadline22">3.2.3. Derivatives, Limits, Sums and Integrals</a></li>
</ul>
</li>
<li><a href="#orgheadline25">3.3. ditaa figures</a>
<ul>
<li><a href="#orgheadline24">3.3.1. Connected elements with colors</a></li>
</ul>
</li>
<li><a href="#orgheadline28">3.4. UML diagrams with PlantUML</a>
<ul>
<li><a href="#orgheadline26">3.4.1. Class diagrams</a></li>
<li><a href="#orgheadline27">3.4.2. Sequences diagrams</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline36">4. 第一天：准备开始</a>
<ul>
<li><a href="#orgheadline30">4.1. 基础操作</a></li>
<li><a href="#orgheadline31">4.2. 内置功能</a></li>
<li><a href="#orgheadline35">4.3. 学习基础 Elisp</a>
<ul>
<li><a href="#orgheadline32">4.3.1. 开始 Hacking！</a></li>
<li><a href="#orgheadline33">4.3.2. 插件管理</a></li>
<li><a href="#orgheadline34">4.3.3. Org-mode</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline39">5. 为一级标题</a>
<ul>
<li><a href="#orgheadline38">5.1. 为二级标题</a>
<ul>
<li><a href="#orgheadline37">5.1.1. 为三级标题并以此类推</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline43">6. 第二天：高级自定义</a>
<ul>
<li><a href="#orgheadline40">6.1. Emacs 也很美</a></li>
<li><a href="#orgheadline42">6.2. JavaScript IDE</a>
<ul>
<li><a href="#orgheadline41">6.2.1. Org-mode 进阶</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline46">7. 第三天：配置文件模块化（上）</a>
<ul>
<li><a href="#orgheadline44">7.1. 多文件存储配置文件(上)</a></li>
<li><a href="#orgheadline45">7.2. Major 与 Minor Mode 详解</a></li>
</ul>
</li>
<li><a href="#orgheadline54">8. 第四天：配置文件模块化（下）以及使用优化</a>
<ul>
<li><a href="#orgheadline47">8.1. 配置文件模块化（下）</a></li>
<li><a href="#orgheadline51">8.2. 更好的默认设置</a>
<ul>
<li><a href="#orgheadline48">8.2.1. 代码缩进</a></li>
<li><a href="#orgheadline49">8.2.2. 缩写补全</a></li>
<li><a href="#orgheadline50">8.2.3. Hippie 补全</a></li>
</ul>
</li>
<li><a href="#orgheadline52">8.3. Dired Mode</a></li>
<li><a href="#orgheadline53">8.4. Org-mode 管理 Emacs 配置</a></li>
</ul>
</li>
<li><a href="#orgheadline61">9. 第五天：打造前端开发神器</a>
<ul>
<li><a href="#orgheadline55">9.1. web-mode</a></li>
<li><a href="#orgheadline56">9.2. js2-refactor</a></li>
<li><a href="#orgheadline57">9.3. 优化 occur 与 imenu</a></li>
<li><a href="#orgheadline58">9.4. expand-region</a></li>
<li><a href="#orgheadline59">9.5. iedit</a></li>
<li><a href="#orgheadline60">9.6. Org 导出</a></li>
</ul>
</li>
<li><a href="#orgheadline68">10. 第六天：代码片段与语法检查器</a>
<ul>
<li><a href="#orgheadline62">10.1. Org-mode 进阶使用</a></li>
<li><a href="#orgheadline63">10.2. 批量修改文件名</a></li>
<li><a href="#orgheadline64">10.3. 搜索与替换</a></li>
<li><a href="#orgheadline65">10.4. 语法检查器（Linter）</a></li>
<li><a href="#orgheadline67">10.5. 代码块</a>
<ul>
<li><a href="#orgheadline66">10.5.1. auto-yasnippet</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline77">11. 第七天：Evil 模式</a>
<ul>
<li><a href="#orgheadline69">11.1. Evil 的安装</a></li>
<li><a href="#orgheadline75">11.2. Evil 模式插件</a>
<ul>
<li><a href="#orgheadline70">11.2.1. Leader Key</a></li>
<li><a href="#orgheadline71">11.2.2. Window-numbering</a></li>
<li><a href="#orgheadline72">11.2.3. Evil-Surround</a></li>
<li><a href="#orgheadline73">11.2.4. Evil-nerd-commenter</a></li>
<li><a href="#orgheadline74">11.2.5. Which-key</a></li>
</ul>
</li>
<li><a href="#orgheadline76">11.3. Org Mode 中的搜索</a></li>
</ul>
</li>
<li><a href="#orgheadline83">12. 第八天：Cask 介绍与实践</a>
<ul>
<li><a href="#orgheadline78">12.1. Cask 的安装</a></li>
<li><a href="#orgheadline79">12.2. 为何使用 Cask</a></li>
<li><a href="#orgheadline82">12.3. 故障排除</a>
<ul>
<li><a href="#orgheadline80">12.3.1. Emacs24.5 时不能安装 <b>let-alist</b></a></li>
<li><a href="#orgheadline81">12.3.2. 在 Emacs24.5 中没有定义 define-advice</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline96">13. 第九天：Macro 与 Use-package</a>
<ul>
<li><a href="#orgheadline87">13.1. Macro</a>
<ul>
<li><a href="#orgheadline84">13.1.1. 什么是 Macro</a></li>
<li><a href="#orgheadline85">13.1.2. backquote</a></li>
<li><a href="#orgheadline86">13.1.3. 为什么使用宏</a></li>
</ul>
</li>
<li><a href="#orgheadline95">13.2. Use-package</a>
<ul>
<li><a href="#orgheadline88">13.2.1. 简介</a></li>
<li><a href="#orgheadline93">13.2.2. 一些简单的用法</a></li>
<li><a href="#orgheadline94">13.2.3. 为什么使用 Use-package</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline103">14. 第十天: Company-mode 与 auto-completion</a>
<ul>
<li><a href="#orgheadline97">14.1. 升级 Package 之后有 BUG 怎么办</a></li>
<li><a href="#orgheadline98">14.2. Use-package 的更多用法</a></li>
<li><a href="#orgheadline99">14.3. Company-mode 的工作原理</a></li>
<li><a href="#orgheadline100">14.4. 为什么有时 Python 的补全 不工作</a></li>
<li><a href="#orgheadline101">14.5. Group Backend</a></li>
<li><a href="#orgheadline102">14.6. 怎样写一个简单的补全后端</a></li>
</ul>
</li>
<li><a href="#orgheadline114">15. 第十一天: Spacemacs 简介及安装</a>
<ul>
<li><a href="#orgheadline104">15.1. 安装 Spacemacs</a></li>
<li><a href="#orgheadline105">15.2. 添加内置的 layer</a></li>
<li><a href="#orgheadline113">15.3. 一些简单的配置</a>
<ul>
<li><a href="#orgheadline106">15.3.1. 启动时全屏显示</a></li>
<li><a href="#orgheadline107">15.3.2. ivy layer</a></li>
<li><a href="#orgheadline108">15.3.3. 查看 layer 下的 文档信息</a></li>
<li><a href="#orgheadline109">15.3.4. 删除安装的 package</a></li>
<li><a href="#orgheadline110">15.3.5. 安装 package</a></li>
<li><a href="#orgheadline111">15.3.6. 配置 customize-group</a></li>
<li><a href="#orgheadline112">15.3.7. 修改主题</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline120">16. 第十二天: 创建你的第一个 Spacemacs Layer</a>
<ul>
<li><a href="#orgheadline115">16.1. 如何更新 Sapcemacs</a></li>
<li><a href="#orgheadline116">16.2. variables 变量</a></li>
<li><a href="#orgheadline117">16.3. 定制 modeline</a></li>
<li><a href="#orgheadline118">16.4. 创建自己的 layer</a></li>
<li><a href="#orgheadline119">16.5. 文档</a></li>
</ul>
</li>
<li><a href="#orgheadline127">17. emacs python workflow.</a>
<ul>
<li><a href="#orgheadline121">17.1. install elpy, jedi</a></li>
<li><a href="#orgheadline122">17.2. Keybinding</a></li>
<li><a href="#orgheadline123">17.3. upgrade git</a></li>
<li><a href="#orgheadline124">17.4. reinstall EMACS</a></li>
<li><a href="#orgheadline125">17.5. Spacemacs Dired</a></li>
<li><a href="#orgheadline126">17.6. magit</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
C-h t
tutorial
</p>
<div id="outline-container-orgheadline14" class="outline-2">
<h2 id="orgheadline14"><span class="section-number-2">1</span> Create GitHub Pages:</h2>
<div class="outline-text-2" id="text-1">
<p>
GitHub Pages is easy for websites for you and your projects. GitHub Pages is hosted directly from your GitHub repository.Just edit, push, and your changes are live.
Tutorial of how to create studying notes pages hosted on GitHub Pages.
</p>
</div>

<div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1"><span class="section-number-3">1.1</span> Create a repository</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Head over to Github and create a new repository named username.github.io, where username is your username on Github.
</p>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2"><span class="section-number-3">1.2</span> Clone the repository</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Go to the folder where you want to store your project, and clone the new repository:
</p>
<div class="org-src-container">

<pre class="src src-sh">git clone https://github.com/username/username.github.io
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">1.3</span> Create folder structure</h3>
<div class="outline-text-3" id="text-1-3">
<pre class="example">
[[repository name]]
├── css/
├── img/
├── index.org
├── docs/
├── CS
└── sitemap.org
</pre>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-3">
<h3 id="orgheadline4"><span class="section-number-3">1.4</span> Add lines in spacemacs configuration file to publish the org project</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">

<pre class="src src-elisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">ox-publish</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>setq org-publish-project-alist
'<span style="color: #66D9EF;">(</span>
<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"org-notes"</span>
 <span style="color: #F92672;">:base-directory</span> <span style="color: #E6DB74;">"~/repository_folder/"</span>
 <span style="color: #F92672;">:base-extension</span> <span style="color: #E6DB74;">"org"</span>
 <span style="color: #F92672;">:publishing-directory</span> <span style="color: #E6DB74;">"~/repository_folder/docs/"</span>
 <span style="color: #F92672;">:recursive</span> t
 <span style="color: #F92672;">:publishing-function</span> org-html-publish-to-html
 <span style="color: #F92672;">:headline-levels</span> <span style="color: #AE81FF;">4</span>             <span style="color: #75715E;">; </span><span style="color: #75715E;">Just the default for this project.</span>
 <span style="color: #F92672;">:auto-preamble</span> t
 <span style="color: #A6E22E;">)</span>
<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"org-static"</span>
 <span style="color: #F92672;">:base-directory</span> <span style="color: #E6DB74;">"~/repository_folder/"</span>
 <span style="color: #F92672;">:base-extension</span> <span style="color: #E6DB74;">"css</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">js</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">png</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">jpg</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">gif</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">pdf</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">mp3</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">ogg</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">|</span><span style="color: #E6DB74;">swf"</span>
 <span style="color: #F92672;">:publishing-directory</span> <span style="color: #E6DB74;">"~/repository_folder/docs/"</span>
 <span style="color: #F92672;">:recursive</span> t
 <span style="color: #F92672;">:publishing-function</span> org-publish-attachment
 <span style="color: #A6E22E;">)</span>
<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-3">
<h3 id="orgheadline5"><span class="section-number-3">1.5</span> Publish personal html files</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>copy html and attachment folders under the main folder.</li>
<li>insert the link in the sitemap org file.</li>
<li>publish all.</li>
<li>copy html and attachment folder under the docs folder.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">1.6</span> Attach markdown files in the org file.</h3>
</div>

<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">1.7</span> Publish ipython file directly.</h3>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">1.8</span> Insert file links in sitemap.org</h3>
<div class="outline-text-3" id="text-1-8">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">[</span><span style="color: #66D9EF;">[</span>file:remember.org<span style="color: #66D9EF;">][</span>remember<span style="color: #66D9EF;">]</span><span style="color: #AE81FF;">]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">1.9</span> The export options template</h3>
<div class="outline-text-3" id="text-1-9">
</div><div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9"><span class="section-number-4">1.9.1</span> Insert basic information using C-c C-e # default</h4>
<div class="outline-text-4" id="text-1-9-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">#+TITLE: filename with the extension omitted
#+DATE: &lt;2013-06-04 Tue&gt;
#+AUTHOR: Your name
#+EMAIL: Your email address
#+OPTIONS: '<span style="color: #F92672;">:t</span> *:t -:t <span style="color: #F92672;">::t</span> &lt;:t H:3 \n:nil ^:t arch:headline author:t c:nil
#+OPTIONS: creator:comment d:<span style="color: #AE81FF;">(</span>not LOGBOOK<span style="color: #AE81FF;">)</span> date:t e:t email:nil f:t inline:t
#+OPTIONS: num:t p:nil pri:nil stat:t tags:t tasks:t tex:t timestamp:t toc:t
#+OPTIONS: todo:t |:t
#+CREATOR: Emacs 24.3.50.3 <span style="color: #AE81FF;">(</span>Org mode 8.0.3<span style="color: #AE81FF;">)</span>
#+DESCRIPTION:
#+EXCLUDE_TAGS: noexport
#+KEYWORDS:
#+LANGUAGE: en
#+SELECT_TAGS: export
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline12" class="outline-4">
<h4 id="orgheadline12"><span class="section-number-4">1.9.2</span> Add export templates configuration files</h4>
<div class="outline-text-4" id="text-1-9-2">
<p>
Create the following files under the org-configuration directory
</p>
</div>
<ol class="org-ol"><li><a id="orgheadline10"></a>level-0.org<br  /><div class="outline-text-5" id="text-1-9-2-1">
<p>
:#+STYLE: &lt;link rel="stylesheet" type="text/css" href="stylesheet.css" /&gt;
</p>
</div></li>
<li><a id="orgheadline11"></a>level-1.org<br  /><div class="outline-text-5" id="text-1-9-2-2">
<p>
:#+STYLE: &lt;link rel="stylesheet" type="text/css" href="../stylesheet.css" /&gt;
</p>
</div></li></ol>
</div>
</div>
</div>
<div id="outline-container-orgheadline18" class="outline-2">
<h2 id="orgheadline18"><span class="section-number-2">2</span> Basic operations in Emacs</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">2.1</span> special syntax</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Insert file link:
Press [[, file: file link, ], backspace, [, [alias, ], ].
</p>
</div>
</div>
<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">2.2</span> insert table box</h3>
<div class="outline-text-3" id="text-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">name1</th>
<th scope="col" class="org-left">name2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">row1</td>
<td class="org-left">value</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
<div class="org-src-container">

<pre class="src src-sh">| name <span style="color: #AE81FF;">1</span> | name <span style="color: #AE81FF;">2</span>|,
|- tab,
enter,
|
</pre>
</div>

<ul class="org-ul">
<li>Initial visibility</li>
</ul>
<p>
Show all shortcut: C-u C-u &lt;TAB&gt;, shirt+&lt;TAB&gt;
</p>

<p>
Or change the start-up configuration.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">#+STARTUP: overview
#+STARTUP: content
#+STARTUP: showall
#+STARTUP: showeverything
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17"><span class="section-number-3">2.3</span> shortcut :</h3>
<div class="outline-text-3" id="text-2-3">
<p>
<b>获取帮助</b>
</p>
<ul class="org-ul">
<li><code>C-h k</code> 寻找快捷键的帮助信息: after the command enter the key combination.</li>
<li><code>C-h v</code> 寻找变量的帮助信息</li>
<li><code>C-h f</code> 寻找函数的帮助信息</li>
<li><code>C-l</code> move the current cursor to the center of the screen.</li>

<li>&lt;s, press tab to get the src box.</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgheadline29" class="outline-2">
<h2 id="orgheadline29"><span class="section-number-2">3</span> ORG Mode</h2>
<div class="outline-text-2" id="text-3">
<p>
<a href="http://ehneilsen.net/notebook/orgExamples/org-examples.html#sec-4">Example</a>
</p>
</div>
<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19"><span class="section-number-3">3.1</span> Structure editing</h3>
<div class="outline-text-3" id="text-3-1">
<p>
M-&lt;RET&gt;     (org-insert-heading)
Insert a new heading/item with the same level as the one at point.
If the command is used at the beginning of a line, and if there is a heading or a plain list item (see Plain lists) at point, the new heading/item is created before the current line. When used at the beginning of a regular line of text, turn that line into a heading.
</p>

<p>
When this command is used in the middle of a line, the line is split and the rest of the line becomes the new item or headline. If you do not want the line to be split, customize org-M-RET-may-split-line.
</p>

<p>
Calling the command with a C-u prefix unconditionally inserts a new heading at the end of the current subtree, thus preserving its contents. With a double C-u C-u prefix, the new heading is created at the end of the parent subtree instead.
</p>

<p>
C-&lt;RET&gt;     (org-insert-heading-respect-content)
Insert a new heading at the end of the current subtree.
M-S-&lt;RET&gt;     (org-insert-todo-heading)
Insert new TODO entry with same level as current heading. See also the variable org-treat-insert-todo-heading-as-state-change.
C-S-&lt;RET&gt;     (org-insert-todo-heading-respect-content)
Insert new TODO entry with same level as current heading. Like C-&lt;RET&gt;, the new headline will be inserted after the current subtree.
&lt;TAB&gt;     (org-cycle)
In a new entry with no text yet, the first &lt;TAB&gt; demotes the entry to become a child of the previous one. The next &lt;TAB&gt; makes it a parent, and so on, all the way to top level. Yet another &lt;TAB&gt;, and you are back to the initial level.
M-&lt;left&gt;     (org-do-promote)
Promote current heading by one level.
M-&lt;right&gt;     (org-do-demote)
Demote current heading by one level.
M-S-&lt;left&gt;     (org-promote-subtree)
Promote the current subtree by one level.
M-S-&lt;right&gt;     (org-demote-subtree)
Demote the current subtree by one level.
M-S-&lt;up&gt;     (org-move-subtree-up)
Move subtree up (swap with previous subtree of same level).
M-S-&lt;down&gt;     (org-move-subtree-down)
Move subtree down (swap with next subtree of same level).
M-h     (org-mark-element)
Mark the element at point. Hitting repeatedly will mark subsequent elements of the one just marked. E.g., hitting &lt;M-h&gt; on a paragraph will mark it, hitting &lt;M-h&gt; immediately again will mark the next one.
C-c @     (org-mark-subtree)
Mark the subtree at point. Hitting repeatedly will mark subsequent subtrees of the same level than the marked subtree.
C-c C-x C-w     (org-cut-subtree)
Kill subtree, i.e., remove it from buffer but save in kill ring. With a numeric prefix argument N, kill N sequential subtrees.
C-c C-x M-w     (org-copy-subtree)
Copy subtree to kill ring. With a numeric prefix argument N, copy the N sequential subtrees.
C-c C-x C-y     (org-paste-subtree)
Yank subtree from kill ring. This does modify the level of the subtree to make sure the tree fits in nicely at the yank position. The yank level can also be specified with a numeric prefix argument, or by yanking after a headline marker like ‘****’.
C-y     (org-yank)
Depending on the options org-yank-adjusted-subtrees and org-yank-folded-subtrees, Org's internal yank command will paste subtrees folded and in a clever way, using the same command as C-c C-x C-y. With the default settings, no level adjustment will take place, but the yanked tree will be folded unless doing so would swallow text previously visible. Any prefix argument to this command will force a normal yank to be executed, with the prefix passed along. A good way to force a normal yank is C-u C-y. If you use yank-pop after a yank, it will yank previous kill items plainly, without adjustment and folding.
C-c C-x c     (org-clone-subtree-with-time-shift)
Clone a subtree by making a number of sibling copies of it. You will be prompted for the number of copies to make, and you can also specify if any timestamps in the entry should be shifted. This can be useful, for example, to create a number of tasks related to a series of lectures to prepare. For more details, see the docstring of the command org-clone-subtree-with-time-shift.
C-c C-w     (org-refile)
Refile entry or region to a different location. See Refile and copy.
C-c ^     (org-sort)
Sort same-level entries. When there is an active region, all entries in the region will be sorted. Otherwise the children of the current headline are sorted. The command prompts for the sorting method, which can be alphabetically, numerically, by time (first timestamp with active preferred, creation time, scheduled time, deadline time), by priority, by TODO keyword (in the sequence the keywords have been defined in the setup) or by the value of a property. Reverse sorting is possible as well. You can also supply your own function to extract the sorting key. With a C-u prefix, sorting will be case-sensitive.
C-x n s     (org-narrow-to-subtree)
Narrow buffer to current subtree.
C-x n b     (org-narrow-to-block)
Narrow buffer to current block.
C-x n w     (widen)
Widen buffer to remove narrowing.
C-c *     (org-toggle-heading)
Turn a normal line or plain list item into a headline (so that it becomes a subheading at its location). Also turn a headline into a normal line by removing the stars. If there is an active region, turn all lines in the region into headlines. If the first line in the region was an item, turn only the item lines into headlines. Finally, if the first line is a headline, remove the stars from all headlines in the region.
</p>
</div>
</div>
<div id="outline-container-orgheadline23" class="outline-3">
<h3 id="orgheadline23"><span class="section-number-3">3.2</span> Latex</h3>
<div class="outline-text-3" id="text-3-2">
</div><div id="outline-container-orgheadline20" class="outline-4">
<h4 id="orgheadline20"><span class="section-number-4">3.2.1</span> Greeks:</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
\[\alpha, \beta, \gamma\]
</p>
</div>
</div>
<div id="outline-container-orgheadline21" class="outline-4">
<h4 id="orgheadline21"><span class="section-number-4">3.2.2</span> Superscript, subscript</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
\[R_{sun} = 6.96 x 10^8 m\]
</p>
</div>
</div>
<div id="outline-container-orgheadline22" class="outline-4">
<h4 id="orgheadline22"><span class="section-number-4">3.2.3</span> Derivatives, Limits, Sums and Integrals</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
\[\frac{du}{dt}\]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\frac{du}{dt}
</pre>
</div>
<p>
the Heat Equation$$\[ \frac{\partial u}{\partial t}
   = h<sup>2</sup> \left( \frac{\partial^2 u}{\partial x^2}
</p>
<ul class="org-ul">
<li>\frac{\partial^2 u}{\partial y^2}</li>
<li>\frac{\partial^2 u}{\partial z^2} \right) \]$$</li>
</ul>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\[ \frac{\partial u}{\partial t}
   = h^2 \left<span style="color: #AE81FF;">(</span> \frac{\partial^2 u}{\partial x^2}
      + \frac{\partial^2 u}{\partial y^2}
      + \frac{\partial^2 u}{\partial z^2} \right<span style="color: #AE81FF;">)</span> \]
</pre>
</div>
<p>
\[\lim_{x \to +\infty}, \inf_{x > s}\]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\lim_{x \to +\infty}, \inf_{x &gt; s}
</pre>
</div>
<p>
\[\[ \sum_{k=1}^n k^2 = \frac{1}{2} n (n+1).\] \]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\[ \sum_{k=1}^n k^2 = \frac{1}{2} n <span style="color: #AE81FF;">(</span>n+1<span style="color: #AE81FF;">)</span>.\]
</pre>
</div>
<p>
\[\[ \int_a^b f(x)\,dx.\] \]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\[ \int_a^b f<span style="color: #AE81FF;">(</span>x<span style="color: #AE81FF;">)</span>\,dx.\]
</pre>
</div>
<p>
\[\[ \int_0^{+\infty} x^n e^{-x} \,dx = n!.\]
\[ \int \cos \theta \,d\theta = \sin \theta.\]
\[ \int_{x^2 + y^2 \leq R^2} f(x,y)\,dx\,dy
   = \int_{\theta=0}^{2\pi} \int_{r=0}^R
      f(r\cos\theta,r\sin\theta) r\,dr\,d\theta.\] \]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\[ \int_0^{+\infty} x^n e^{-x} \,dx = n!.\]
\[ \int \cos \theta \,d\theta = \sin \theta.\]
\[ \int_{x^2 + y^2 \leq R^2} f<span style="color: #AE81FF;">(</span>x,y<span style="color: #AE81FF;">)</span>\,dx\,dy
   = \int_{\theta=0}^{2\pi} \int_{r=0}^R
      f<span style="color: #AE81FF;">(</span>r\cos\theta,r\sin\theta<span style="color: #AE81FF;">)</span> r\,dr\,d\theta.\]
</pre>
</div>
<p>
\[\[ \int \!\!\! \int_D f(x,y)\,dx\,dy.\] \]
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">\[ \int \!\!\! \int_D f<span style="color: #AE81FF;">(</span>x,y<span style="color: #AE81FF;">)</span>\,dx\,dy.\]
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline25" class="outline-3">
<h3 id="orgheadline25"><span class="section-number-3">3.3</span> ditaa figures</h3>
<div class="outline-text-3" id="text-3-3">
</div><div id="outline-container-orgheadline24" class="outline-4">
<h4 id="orgheadline24"><span class="section-number-4">3.3.1</span> Connected elements with colors</h4>
<div class="outline-text-4" id="text-3-3-1">
<div class="org-src-container">

<pre class="src src-ditaa">+------+   +-----+   +-----+   +-----+
|{io}  |   |{d}  |   |{s}  |   |cBLU |
| Foo  +---+ Bar +---+ Baz +---+ Moo |
|      |   |     |   |     |   |     |
+------+   +-----+   +--+--+   +-----+
                        |
           /-----\      |      +------+
           |     |      |      | c1AB |
           | Goo +------+---=--+ Shoo |
           \-----/             |      |
                               +------+
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28"><span class="section-number-3">3.4</span> UML diagrams with PlantUML</h3>
<div class="outline-text-3" id="text-3-4">
</div><div id="outline-container-orgheadline26" class="outline-4">
<h4 id="orgheadline26"><span class="section-number-4">3.4.1</span> Class diagrams</h4>
<div class="outline-text-4" id="text-3-4-1">
<div class="org-src-container">

<pre class="src src-plantuml">skinparam monochrome true
FitsHdu &lt;|-- PrimaryHdu
FitsHdu &lt;|-- ExtensionHdu

FitsHdu : header
FitsHdu : getHeaderKeyword()

ExtensionHdu &lt;|-- ImageHdu
ImageHdu : image
ImageHdu : getPixel(row, column)

ExtensionHdu &lt;|-- BinaryTableHdu
BinaryTableHdu : table
BinaryTableHdu : getRow(row)
BinaryTableHdu : getColumn(column)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline27" class="outline-4">
<h4 id="orgheadline27"><span class="section-number-4">3.4.2</span> Sequences diagrams</h4>
<div class="outline-text-4" id="text-3-4-2">
<div class="org-src-container">

<pre class="src src-plantuml">skinparam monochrome true
 Foo -&gt; Bar: synchronous call
 Foo -&gt;&gt; Bar: asynchronous call
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline36" class="outline-2">
<h2 id="orgheadline36"><span class="section-number-2">4</span> 第一天：准备开始</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30"><span class="section-number-3">4.1</span> 基础操作</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li><code>C-h t</code> to open the tutorial.</li>
<li>cursor movement(C-f C-b C-n C-p C-a C-e)</li>
<li>kill one line(<code>C-k</code>)</li>
<li>one file can only have one major mode, but multiple minor mode.</li>
<li><code>C-x C-r</code> open file as read only.</li>
<li><code>C-h m</code> view install modes and packages.</li>
</ul>
<p>
因为 Control 键在 Emacs 中极为常用，所以为了更方便地使用 Emacs 的键位修改，需要
对其做出修改。建议将大写锁定键（Caps Lock）替换为 Control 键。这里是一个可以参考
的把大写锁定键替换为 Control 键的教程：<a href="https://www.emacswiki.org/emacs/MovingTheCtrlKey">移动 Control 键 (Moving The Ctrl Key)。</a>如
果这个的教程不适用于你的操作系统，请自行搜索其它的修改方式。
</p>

<p>
常见符号所代表的意义如下
</p>

<ul class="org-ul">
<li>M(eta)，在 Mac 下为 Option 键</li>
<li>s(uper)，在 Mac 环境下为左 Command 键</li>
<li>S(Shift)</li>
<li>C(trl)</li>
</ul>

<p>
光标的移动是编辑器中最常用的操作所以必须熟知。
</p>

<ul class="org-ul">
<li><code>C-f</code> 为前移一个字符， <code>f</code> 代表 forward。</li>
<li><code>C-b</code> 为后移一个字符， <code>b</code> 代表 backward。</li>
<li><code>C-p</code> 为上移至前一行， <code>p</code> 代表 previous。</li>
<li><code>C-n</code> 为上移至下一行， <code>n</code> 代表 next。</li>
<li><code>C-a</code> 为移至行首， <code>a</code> 代表 ahead。</li>
<li><code>C-e</code> 为移至行尾， <code>e</code> 代表 end。</li>
</ul>

<p>
常用的文件操作快捷键组合也必须熟记。
</p>

<ul class="org-ul">
<li><code>C-x C-f</code> 为打开目标文件， <code>f</code> 代表 find/file</li>
<li><code>C-x C-s</code> 为保存当前缓冲区（Buffer）， <code>s</code> 代表 save</li>
</ul>

<p>
<code>C-x</code> 是 Emacs 的快捷键中常用的前缀命令。这些前缀命令常常代表了一系列有关联的指
令，十分重要，请特别牢记。其它常见的还有 <code>C-c</code>, <code>C-h</code> 。打断组合键为 <code>C-g</code> ，它
用于终端取消之前的指令。快捷键就是用预先绑定好的方式告诉 Emacs 去执行指定的命令。
（之后会介绍到更多有关绑定的内容）
</p>
</div>
</div>

<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31"><span class="section-number-3">4.2</span> 内置功能</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Emacs 功能强大，但是部分功能默认情况下并未开启。下面就有几个例子，
</p>

<p>
编辑器内显示行号可使用 <code>M-x linum-mode</code> 来开启。
</p>

<p>
<b>获取帮助</b>
</p>

<p>
Emacs 是一个富文档编辑器（Self document, extensible editor）而下面的三种方法在学
习 Emacs 的过程中也非常重要。他们分别是，
</p>

<ul class="org-ul">
<li><code>C-h k</code> 寻找快捷键的帮助信息</li>
<li><code>C-h v</code> 寻找变量的帮助信息</li>
<li><code>C-h f</code> 寻找函数的帮助信息</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline35" class="outline-3">
<h3 id="orgheadline35"><span class="section-number-3">4.3</span> 学习基础 Elisp</h3>
<div class="outline-text-3" id="text-4-3">
<p>
请务必完成<a href="https://learnxinyminutes.com/docs/elisp/">这篇教程（Learn X in Y Minutes）</a>来了解 Elisp 的使用（阅读时间大约 15
分钟），你也可以在<a href="https://learnxinyminutes.com/docs/zh-cn/elisp-cn/">这里</a>找到它的中文版。Emacs Lisp 为一个函数式的语言，所以它全部
功能都是由函数来实现的。
</p>

<p>
下面为一些简单的例子
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">2 + 2</span>
<span style="color: #AE81FF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">2 + 3 * 4</span>
<span style="color: #AE81FF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #66D9EF;">(</span>* <span style="color: #AE81FF;">3</span> <span style="color: #AE81FF;">4</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#23450;&#20041;&#21464;&#37327;</span>
<span style="color: #AE81FF;">(</span>setq name <span style="color: #E6DB74;">"username"</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>message name<span style="color: #AE81FF;">)</span> <span style="color: #75715E;">; </span><span style="color: #75715E;">-&gt; "username"</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#23450;&#20041;&#20989;&#25968;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">func</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"Hello, %s"</span> name<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#25191;&#34892;&#20989;&#25968;</span>
<span style="color: #AE81FF;">(</span>func<span style="color: #AE81FF;">)</span> <span style="color: #75715E;">; </span><span style="color: #75715E;">-&gt; Hello, username</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#35774;&#32622;&#24555;&#25463;&#38190;</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"&lt;f1&gt;"</span><span style="color: #66D9EF;">)</span> 'func<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20351;&#20989;&#25968;&#21487;&#30452;&#25509;&#34987;&#35843;&#29992;&#21487;&#28155;&#21152; (interactive)</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">func</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"Hello, %s"</span> name<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline32" class="outline-4">
<h4 id="orgheadline32"><span class="section-number-4">4.3.1</span> 开始 Hacking！</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
Emacs 的配置文件默认保存在 <code>~/.emacs.d/init.el</code> 文件中。（如果其不存在可自行创建，
配置文件也可保存在 <code>~/.emacs</code> 文件中，他们之间的区别我们会在后面做讨论）
</p>

<p>
<b><b>注意：</b></b> 如果希望把配置放在 <code>~/.emacs.d/init.el</code> 文件中，那么需要手工删除
<code>~/.emacs</code> 文件。
</p>

<p>
在开始配置之前让我们先来区别 Emacs 中 Major Mode 与 Minor Mode 的区别。Major
Mode 通常是定义对于一种文件类型编辑的核心规则，例如语法高亮、缩进、快捷键绑定等。
而 Minor Mode 是除去 Major Mode 所提供的核心功能以外的额外编辑功能（辅助功能）。
例如在下面的配置文件中 <code>tool-bar-mode</code> 与 <code>linum-mode</code> 等均为 Minor Mode*。
</p>

<p>
简单来说就是，一种文件类型同时只能存在一种 Major Mode 但是它可以同时激活一种或多
种 Minor Mode。如果你希望知道当前的模式信息，可以使用 <code>C-h m</code> 来显示当前所有开启
的全部 Minor Mode 的信息。
</p>

<p>
<b>简单的编辑器自定义</b>
</p>

<p>
下面是一些简单的编辑器配置信息，你需要做的就是将其写入你的配置文件中
（ <code>~/.emacs.d/init.el</code> ）即可。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20851;&#38381;&#24037;&#20855;&#26639;&#65292;tool-bar-mode &#21363;&#20026;&#19968;&#20010; Minor Mode</span>
<span style="color: #AE81FF;">(</span>tool-bar-mode <span style="color: #AE81FF;">-1</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20851;&#38381;&#25991;&#20214;&#28369;&#21160;&#25511;&#20214;</span>
<span style="color: #AE81FF;">(</span>scroll-bar-mode <span style="color: #AE81FF;">-1</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#26174;&#31034;&#34892;&#21495;</span>
<span style="color: #AE81FF;">(</span>global-linum-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#26356;&#25913;&#20809;&#26631;&#30340;&#26679;&#24335;&#65288;&#19981;&#33021;&#29983;&#25928;&#65292;&#35299;&#20915;&#26041;&#26696;&#35265;&#31532;&#20108;&#38598;&#65289;</span>
<span style="color: #AE81FF;">(</span>setq cursor-type 'bar<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20851;&#38381;&#21551;&#21160;&#24110;&#21161;&#30011;&#38754;</span>
<span style="color: #AE81FF;">(</span>setq inhibit-splash-screen <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20851;&#38381;&#32553;&#36827; (&#31532;&#20108;&#22825;&#20013;&#34987;&#21435;&#38500;)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(electric-indent-mode -1)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#26356;&#25913;&#26174;&#31034;&#23383;&#20307;&#22823;&#23567; 16pt</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">http://stackoverflow.com/questions/294664/how-to-set-the-font-size-in-emacs</span>
<span style="color: #AE81FF;">(</span>set-face-attribute 'default nil <span style="color: #F92672;">:height</span> <span style="color: #AE81FF;">160</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#24555;&#36895;&#25171;&#24320;&#37197;&#32622;&#25991;&#20214;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">open-init-file</span><span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>find-file <span style="color: #E6DB74;">"~/.emacs.d/init.el"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#36825;&#19968;&#34892;&#20195;&#30721;&#65292;&#23558;&#20989;&#25968; open-init-file &#32465;&#23450;&#21040; &lt;f2&gt; &#38190;&#19978;</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"&lt;f2&gt;"</span><span style="color: #66D9EF;">)</span> 'open-init-file<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在每次编辑配置文件后，刚刚做的修改并不会立刻生效。这时你需要重启编辑器或者重新加
载配置文件。重新加载配置文件你需要在当前配置文件中使用 <code>M-x load-file</code> 双击两次
回车确认默认文件名，或者使用 <code>M-x eval-buffer</code> 去执行当前缓冲区的所有 Lisp 命令。
你也可以使用 <code>C-x C-e</code> 来执行某一行的 Lisp 代码。这些可使刚刚修改的配置文件生效。
当然你也可以将这些函数绑定为快捷键。
</p>
<ul class="org-ul">
<li>learn elisp shortcut.</li>
</ul>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">This gives an introduction to Emacs Lisp in 15 minutes (v0.2d)</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Author: Bastien / @bzg2 / https://bzg.fr</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">First make sure you read this text by Peter Norvig:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">http://norvig.com/21-days.html</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Then install GNU Emacs 24.3:</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Debian: apt-get install emacs (or see your distro instructions)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">OSX: http://emacsformacosx.com/emacs-builds/Emacs-24.3-universal-10.6.8.dmg</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Windows: http://ftp.gnu.org/gnu/windows/emacs/emacs-24.3-bin-i386.zip</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">More general information can be found at:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">http://www.gnu.org/software/emacs/#Obtaining</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Important warning:</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Going through this tutorial won't damage your computer unless</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">you get so angry that you throw it on the floor.  In that case,</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">I hereby decline any responsibility.  Have fun!</span>

<span style="color: #75715E;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Fire up Emacs.</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Hit the `q' key to dismiss the welcome message.</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now look at the gray line at the bottom of the window:</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">"*scratch*" is the name of the editing space you are now in.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">This editing space is called a "buffer".</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">The scratch buffer is the default buffer when opening Emacs.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">You are never editing files: you are editing buffers that you</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">can save to a file.</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">"Lisp interaction" refers to a set of commands available here.</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Emacs has a built-in set of commands available in every buffer,</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">and several subsets of commands available when you activate a</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">specific mode.  Here we use the `</span><span style="color: #AE81FF;">lisp-interaction-mode</span><span style="color: #75715E;">', which</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">comes with commands to evaluate and navigate within Elisp code.</span>

<span style="color: #75715E;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Semi-colons start comments anywhere on a line.</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Elisp programs are made of symbolic expressions ("sexps"):</span>
<span style="color: #AE81FF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">This symbolic expression reads as "Add 2 to 2".</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Sexps are enclosed into parentheses, possibly nested:</span>
<span style="color: #AE81FF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">A symbolic expression contains atoms or other symbolic</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">expressions.  In the above examples, 1 and 2 are atoms,</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(+ 2 (+ 1 1)) and (+ 1 1) are symbolic expressions.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">From `</span><span style="color: #AE81FF;">lisp-interaction-mode</span><span style="color: #75715E;">' you can evaluate sexps.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Put the cursor right after the closing parenthesis then</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">hold down the control and hit the j keys ("C-j" for short).</span>

<span style="color: #AE81FF;">(</span>+ <span style="color: #AE81FF;">3</span> <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;;           </span><span style="color: #75715E;">^ cursor here</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-j</span><span style="color: #75715E;">' =&gt; 6</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-j</span><span style="color: #75715E;">' inserts the result of the evaluation in the buffer.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' displays the same result in Emacs bottom line,</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">called the "minibuffer".  We will generally use `</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">',</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">as we don't want to clutter the buffer with useless text.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">setq</span><span style="color: #75715E;">' stores a value into a variable:</span>
<span style="color: #AE81FF;">(</span>setq my-name <span style="color: #E6DB74;">"Bastien"</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; "Bastien" (displayed in the mini-buffer)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">insert</span><span style="color: #75715E;">' will insert "Hello!" where the cursor is:</span>
<span style="color: #AE81FF;">(</span>insert <span style="color: #E6DB74;">"Hello!"</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; "Hello!"</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">We used `</span><span style="color: #AE81FF;">insert</span><span style="color: #75715E;">' with only one argument "Hello!", but</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">we can pass more arguments -- here we use two:</span>

<span style="color: #AE81FF;">(</span>insert <span style="color: #E6DB74;">"Hello"</span> <span style="color: #E6DB74;">" world!"</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; "Hello world!"</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You can use variables instead of strings:</span>
<span style="color: #AE81FF;">(</span>insert <span style="color: #E6DB74;">"Hello, I am "</span> my-name<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; "Hello, I am Bastien"</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You can combine sexps into functions:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">hello</span> <span style="color: #66D9EF;">()</span> <span style="color: #66D9EF;">(</span>insert <span style="color: #E6DB74;">"Hello, I am "</span> my-name<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; hello</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You can evaluate functions:</span>
<span style="color: #AE81FF;">(</span>hello<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; Hello, I am Bastien</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">The empty parentheses in the function's definition means that</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">it does not accept arguments.  But always using `</span><span style="color: #AE81FF;">my-name</span><span style="color: #75715E;">' is</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">boring, let's tell the function to accept one argument (here</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">the argument is called "name"):</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">hello</span> <span style="color: #66D9EF;">(</span>name<span style="color: #66D9EF;">)</span> <span style="color: #66D9EF;">(</span>insert <span style="color: #E6DB74;">"Hello "</span> name<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; hello</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now let's call the function with the string "you" as the value</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">for its unique argument:</span>
<span style="color: #AE81FF;">(</span>hello <span style="color: #E6DB74;">"you"</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">' =&gt; "Hello you"</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Yeah!</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Take a breath.</span>

<span style="color: #75715E;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now switch to a new buffer named "*test*" in another window:</span>

<span style="color: #AE81FF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">'</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">=&gt; [screen has two windows and cursor is in the *test* buffer]</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Mouse over the top window and left-click to go back.  Or you can</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">use `</span><span style="color: #AE81FF;">C-xo</span><span style="color: #75715E;">' (i.e. hold down control-x and hit o) to go to the other</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">window interactively.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You can combine several sexps with `</span><span style="color: #AE81FF;">progn</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">progn</span>
  <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>hello <span style="color: #E6DB74;">"you"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">'</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">=&gt; [The screen has two windows and cursor is in the *test* buffer]</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now if you don't mind, I'll stop asking you to hit `</span><span style="color: #AE81FF;">C-xC-e</span><span style="color: #75715E;">': do it</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">for every sexp that follows.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Always go back to the *scratch* buffer with the mouse or `</span><span style="color: #AE81FF;">C-xo</span><span style="color: #75715E;">'.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">It's often useful to erase the buffer:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">progn</span>
  <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>erase-buffer<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>hello <span style="color: #E6DB74;">"there"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Or to go back to the other window:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">progn</span>
  <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>erase-buffer<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>hello <span style="color: #E6DB74;">"you"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You can bind a value to a local variable with `</span><span style="color: #AE81FF;">let</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">let</span> <span style="color: #66D9EF;">(</span><span style="color: #A6E22E;">(</span>local-name <span style="color: #E6DB74;">"you"</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>erase-buffer<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>hello local-name<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">No need to use `</span><span style="color: #AE81FF;">progn</span><span style="color: #75715E;">' in that case, since `</span><span style="color: #AE81FF;">let</span><span style="color: #75715E;">' also combines</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">several sexps.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's format a string:</span>
<span style="color: #AE81FF;">(</span>format <span style="color: #E6DB74;">"Hello %s!\n"</span> <span style="color: #E6DB74;">"visitor"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">%s is a place-holder for a string, replaced by "visitor".</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">\n is the newline character.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's refine our function by using format:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">hello</span> <span style="color: #66D9EF;">(</span>name<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>insert <span style="color: #A6E22E;">(</span>format <span style="color: #E6DB74;">"Hello %s!\n"</span> name<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>hello <span style="color: #E6DB74;">"you"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's create another function which uses `</span><span style="color: #AE81FF;">let</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">greeting</span> <span style="color: #66D9EF;">(</span>name<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">let</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>your-name <span style="color: #E6DB74;">"Bastien"</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>insert <span style="color: #E6DB74;">(</span>format <span style="color: #E6DB74;">"Hello %s!\n\nI am %s."</span>
                    name       <span style="color: #75715E;">; </span><span style="color: #75715E;">the argument of the function</span>
                    your-name  <span style="color: #75715E;">; </span><span style="color: #75715E;">the let-bound variable "Bastien"</span>
                    <span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">And evaluate it:</span>
<span style="color: #AE81FF;">(</span>greeting <span style="color: #E6DB74;">"you"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Some functions are interactive:</span>
<span style="color: #AE81FF;">(</span>read-from-minibuffer <span style="color: #E6DB74;">"Enter your name: "</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Evaluating this function returns what you entered at the prompt.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's make our `</span><span style="color: #AE81FF;">greeting</span><span style="color: #75715E;">' function prompt for your name:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">greeting</span> <span style="color: #66D9EF;">(</span>from-name<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">let</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>your-name <span style="color: #FD971F;">(</span>read-from-minibuffer <span style="color: #E6DB74;">"Enter your name: "</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>insert <span style="color: #E6DB74;">(</span>format <span style="color: #E6DB74;">"Hello!\n\nI am %s and you are %s."</span>
                    from-name <span style="color: #75715E;">; </span><span style="color: #75715E;">the argument of the function</span>
                    your-name <span style="color: #75715E;">; </span><span style="color: #75715E;">the let-bound var, entered at prompt</span>
                    <span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>greeting <span style="color: #E6DB74;">"Bastien"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's complete it by displaying the results in the other window:</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">greeting</span> <span style="color: #66D9EF;">(</span>from-name<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">let</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>your-name <span style="color: #FD971F;">(</span>read-from-minibuffer <span style="color: #E6DB74;">"Enter your name: "</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>erase-buffer<span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>insert <span style="color: #E6DB74;">(</span>format <span style="color: #E6DB74;">"Hello %s!\n\nI am %s."</span> your-name from-name<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now test it:</span>
<span style="color: #AE81FF;">(</span>greeting <span style="color: #E6DB74;">"Bastien"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Take a breath.</span>

<span style="color: #75715E;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's store a list of names:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">If you want to create a literal list of data, use ' to stop it from</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">being evaluated - literally, "quote" the data.</span>
<span style="color: #AE81FF;">(</span>setq list-of-names '<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"Sarah"</span> <span style="color: #E6DB74;">"Chloe"</span> <span style="color: #E6DB74;">"Mathilde"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Get the first element of this list with `</span><span style="color: #AE81FF;">car</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span>car list-of-names<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Get a list of all but the first element with `</span><span style="color: #AE81FF;">cdr</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span>cdr list-of-names<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Add an element to the beginning of a list with `</span><span style="color: #AE81FF;">push</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span>push <span style="color: #E6DB74;">"Stephanie"</span> list-of-names<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #d0bf8f;">NOTE</span><span style="color: #75715E;">: `</span><span style="color: #AE81FF;">car</span><span style="color: #75715E;">' and `</span><span style="color: #AE81FF;">cdr</span><span style="color: #75715E;">' don't modify the list, but `</span><span style="color: #AE81FF;">push</span><span style="color: #75715E;">' does.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">This is an important difference: some functions don't have any</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">side-effects (like `</span><span style="color: #AE81FF;">car</span><span style="color: #75715E;">') while others have (like `</span><span style="color: #AE81FF;">push</span><span style="color: #75715E;">').</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's call `</span><span style="color: #AE81FF;">hello</span><span style="color: #75715E;">' for each element in `</span><span style="color: #AE81FF;">list-of-names</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span>mapcar 'hello list-of-names<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Refine `</span><span style="color: #AE81FF;">greeting</span><span style="color: #75715E;">' to say hello to everyone in `</span><span style="color: #AE81FF;">list-of-names</span><span style="color: #75715E;">':</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">greeting</span> <span style="color: #66D9EF;">()</span>
    <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>erase-buffer<span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>mapcar 'hello list-of-names<span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>greeting<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Remember the `</span><span style="color: #AE81FF;">hello</span><span style="color: #75715E;">' function we defined above?  It takes one</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">argument, a name.  `</span><span style="color: #AE81FF;">mapcar</span><span style="color: #75715E;">' calls `</span><span style="color: #AE81FF;">hello</span><span style="color: #75715E;">', successively using each</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">element of `</span><span style="color: #AE81FF;">list-of-names</span><span style="color: #75715E;">' as the argument for `</span><span style="color: #AE81FF;">hello</span><span style="color: #75715E;">'.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Now let's arrange a bit what we have in the displayed buffer:</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">replace-hello-by-bonjour</span> <span style="color: #66D9EF;">()</span>
    <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>goto-char <span style="color: #A6E22E;">(</span>point-min<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span><span style="color: #F92672;">while</span> <span style="color: #A6E22E;">(</span>search-forward <span style="color: #E6DB74;">"Hello"</span><span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span>replace-match <span style="color: #E6DB74;">"Bonjour"</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">(goto-char (point-min)) goes to the beginning of the buffer.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(search-forward "Hello") searches for the string "Hello".</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(while x y) evaluates the y sexp(s) while x returns something.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">If x returns `</span><span style="color: #AE81FF;">nil</span><span style="color: #75715E;">' (nothing), we exit the while loop.</span>

<span style="color: #AE81FF;">(</span>replace-hello-by-bonjour<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You should see all occurrences of "Hello" in the *test* buffer</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">replaced by "Bonjour".</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">You should also get an error: "Search failed: Hello".</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">To avoid this error, you need to tell `</span><span style="color: #AE81FF;">search-forward</span><span style="color: #75715E;">' whether it</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">should stop searching at some point in the buffer, and whether it</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">should silently fail when nothing is found:</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">(search-forward "Hello" nil 't) does the trick:</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">The `</span><span style="color: #AE81FF;">nil</span><span style="color: #75715E;">' argument says: the search is not bound to a position.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">The `'t' argument says: silently fail when nothing is found.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">We use this sexp in the function below, which doesn't throw an error:</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">hello-to-bonjour</span> <span style="color: #66D9EF;">()</span>
    <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>erase-buffer<span style="color: #66D9EF;">)</span>
    <span style="color: #75715E;">;; </span><span style="color: #75715E;">Say hello to names in `</span><span style="color: #AE81FF;">list-of-names</span><span style="color: #75715E;">'</span>
    <span style="color: #66D9EF;">(</span>mapcar 'hello list-of-names<span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>goto-char <span style="color: #A6E22E;">(</span>point-min<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #75715E;">;; </span><span style="color: #75715E;">Replace "Hello" by "Bonjour"</span>
    <span style="color: #66D9EF;">(</span><span style="color: #F92672;">while</span> <span style="color: #A6E22E;">(</span>search-forward <span style="color: #E6DB74;">"Hello"</span> nil 't<span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span>replace-match <span style="color: #E6DB74;">"Bonjour"</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>hello-to-bonjour<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Let's colorize the names:</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">boldify-names</span> <span style="color: #66D9EF;">()</span>
    <span style="color: #66D9EF;">(</span>switch-to-buffer-other-window <span style="color: #E6DB74;">"*test*"</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>goto-char <span style="color: #A6E22E;">(</span>point-min<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span><span style="color: #F92672;">while</span> <span style="color: #A6E22E;">(</span>re-search-forward <span style="color: #E6DB74;">"Bonjour </span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">!"</span> nil 't<span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span>add-text-properties <span style="color: #E6DB74;">(</span>match-beginning <span style="color: #AE81FF;">1</span><span style="color: #E6DB74;">)</span>
                           <span style="color: #E6DB74;">(</span>match-end <span style="color: #AE81FF;">1</span><span style="color: #E6DB74;">)</span>
                           <span style="color: #E6DB74;">(</span>list 'face 'bold<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>other-window <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">This functions introduces `</span><span style="color: #AE81FF;">re-search-forward</span><span style="color: #75715E;">': instead of</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">searching for the string "Bonjour", you search for a pattern,</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">using a "regular expression" (abbreviated in the prefix "re-").</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">The regular expression is "Bonjour \\(.+\\)!" and it reads:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">the string "Bonjour ", and</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">a group of            | this is the \\( ... \\) construct</span>
<span style="color: #75715E;">;;   </span><span style="color: #75715E;">any character       | this is the .</span>
<span style="color: #75715E;">;;   </span><span style="color: #75715E;">possibly repeated   | this is the +</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">and the "!" string.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Ready?  Test it!</span>

<span style="color: #AE81FF;">(</span>boldify-names<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">`</span><span style="color: #AE81FF;">add-text-properties</span><span style="color: #75715E;">' adds... text properties, like a face.</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">OK, we are done.  Happy hacking!</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">If you want to know more about a variable or a function:</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">C-h v a-variable RET</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">C-h f a-function RET</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">To read the Emacs Lisp manual with Emacs:</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">C-h i m elisp RET</span>
<span style="color: #75715E;">;;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">To read an online introduction to Emacs Lisp:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">https://www.gnu.org/software/emacs/manual/html_node/eintr/index.html</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Thanks to these people for their feedback and suggestions:</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- Wes Hardaker</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- notbob</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- Kevin Montuori</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- Arne Babenhauserheide</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- Alan Schmitt</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- LinXitoW</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">- Aaron Meurer</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline33" class="outline-4">
<h4 id="orgheadline33"><span class="section-number-4">4.3.2</span> 插件管理</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
使用默认的插件管理系统（可在菜单栏 <code>Options &gt; Manage Emacs Packages</code> 中找到）安
装 <a href="http://company-mode.github.io/">Company</a> 插件，他是一个用于代码补全的插件。它的名字代表补全一切的意思（ <b>Comp</b>
lete <b>Any</b> thing）。因为默认的插件管理系统提供的插件十分有限，所以我们会在之后的
几天中继续将其强化。
</p>

<p>
使用的下面的配置将 Company-mode 在全局模式下激活
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">; </span><span style="color: #75715E;">&#24320;&#21551;&#20840;&#23616; Company &#34917;&#20840;</span>
<span style="color: #AE81FF;">(</span>global-company-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>navigate in the global company mode <code>M-p M-n</code></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline34" class="outline-4">
<h4 id="orgheadline34"><span class="section-number-4">4.3.3</span> Org-mode</h4>
<div class="outline-text-4" id="text-4-3-3">
<p>
简单的 Org-mode 使用，它可以列出提纲，并方便地使用 <code>tab</code> 键来对其进行展开与关闭。
<code>C-c C-t</code> 可以将一个条目转换成一条待办事件。
</p>

<p>
#+BEGIN<sub>SRC</sub> emacs-lisp
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline39" class="outline-2">
<h2 id="orgheadline39"><span class="section-number-2">5</span> 为一级标题</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-orgheadline38" class="outline-3">
<h3 id="orgheadline38"><span class="section-number-3">5.1</span> 为二级标题</h3>
<div class="outline-text-3" id="text-5-1">
</div><div id="outline-container-orgheadline37" class="outline-4">
<h4 id="orgheadline37"><span class="section-number-4">5.1.1</span> 为三级标题并以此类推</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
#+END<sub>SRC</sub>
</p>
<ul class="org-ul">
<li><code>C-c C-t</code> insert todo item. <code>C-c C-t</code> on todo item, label DONE.</li>
<li>[ ], <code>C-c C-c</code> check in the check box.</li>
<li><code>&lt;s TAB</code> auto complete source code block.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline43" class="outline-2">
<h2 id="orgheadline43"><span class="section-number-2">6</span> 第二天：高级自定义</h2>
<div class="outline-text-2" id="text-6">
<p>
<b>说在最前面</b>
</p>

<p>
如果你想深入学习 Emacs Lisp 可以阅读 GNU 提供的 <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html">An Introduction to Programming
in Emacs Lisp</a> 。（也可以 <code>M-x info</code> 然后选择 Emacs Lisp Intro）
</p>

<p>
我们先解决前一天中遇到的一些问题。首先是在对象是一个缓冲区局部变量（Buffer-local
variable）的时候，比如这里的 <code>cursor-type</code> ，我们需要区分 <code>setq</code> 与
<code>setq-default</code> ： <code>setq</code> 设置当前缓冲区（Buffer）中的变量值， <code>setq-default</code> 设
置的为全局的变量的值（具体内容可以在 <a href="http://stackoverflow.com/questions/18172728/the-difference-between-setq-and-setq-default-in-emacs-lisp">StackOverflow 找到</a>）。下面是一个例子，用于
设置光标样式的方法。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq-default cursor-type 'bar<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
今天我们需要将第一天关闭的自动缩进 (<code>electric-indent-mode</code>) 从配置文件中去除，它
是 Emacs 24.4 中加入的新特性，你可以在这篇<a href="http://emacsredux.com/blog/2014/01/19/a-peek-at-emacs-24-dot-4-auto-indentation-by-default/">文章</a>中找到更多关于它的内容。我们之前关
闭它是因为，它存在不理想的缩进效果（在 Emacs Lisp 中用分号做注释时
<code>fancy-comment</code> 会造成很远的缩进，其实解决方法是使用 Emacs Lisp 推荐的两个分号而
不是一个 <code>;;</code> ，这样就可以避免这个问题。于是我们也就将其从配置文件中删除）
</p>

<p>
因为通常我们的配置文件以及项目文件均使用版本控制系统，所以自动生成的备份文件就显
得有些多余。我们还可以禁止 Emacs 自动生成备份文件，例如 <code>init.el~</code> 。（ <code>~</code> 为后
缀的文件为自动生成的备份文件）我们可以使用下面的方法将其关闭。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq make-backup-files nil<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
关于分屏的使用，如果你已经读过 Emacs 自带的教程，现在你应该已经掌握了基本的分屏
操作方法了。关于分屏的更多内容你可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window.html">这里</a>找到。
</p>

<ul class="org-ul">
<li><code>C-x 1</code> 仅保留当前窗口</li>
<li><code>C-x 2</code> 将当前窗口分到上边</li>
<li><code>C-x 3</code> 将当前窗口分到右边</li>
</ul>

<p>
使用下面的配置来加入最近打开过文件的选项让我们更快捷的在图形界面的菜单中打开最近
编辑过的文件。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">recentf</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>recentf-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>setq recentf-max-menu-item <span style="color: #AE81FF;">10</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#36825;&#20010;&#24555;&#25463;&#38190;&#32465;&#23450;&#21487;&#20197;&#29992;&#20043;&#21518;&#30340;&#25554;&#20214; counsel &#20195;&#26367;</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(global-set-key (kbd "C-x C-r") 'recentf-open-files)</span>
</pre>
</div>

<p>
<code>require</code> 的意思为从文件中加载特性，你可以在杀哥的网站读到关于 Emacs Lisp 库系统
的更多内容，文章在<a href="http://ergoemacs.org/emacs/elisp_library_system.html">这里</a>。
</p>

<p>
使用下面的配置文件将删除功能配置成与其他图形界面的编辑器相同，即当你选中一段文字
之后输入一个字符会替换掉你选中部分的文字。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>delete-selection-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
下面的这些函数可以让你找到不同函数，变量以及快捷键所定义的文件位置。因为非常常用
所以我们建议将其设置为与查找文档类似的快捷键（如下所示），
</p>

<ul class="org-ul">
<li><code>find-function</code> （ <code>C-h C-f</code> ）</li>
<li><code>find-variable</code> （ <code>C-h C-v</code> ）</li>
<li><code>find-function-on-key</code> （ <code>C-h C-k</code> ）</li>
</ul>

<p>
在我们进入下一个部分之间让我们来看看使用 <code>~/.emacs.d/init.el</code> 与 <code>~/.emacs</code> 的区
别（更多关于他们区别的讨论可在<a href="http://emacs.stackexchange.com/questions/1/are-there-any-advantages-to-using-emacs-d-init-el-instead-of-emacs">这里</a>找到）。简单来说请使用前者，因为它有下面的两个
优点，
</p>

<ul class="org-ul">
<li>它可以更好将所有 Emacs 相关的文件整合在一个目录内（干净的 <code>HOME</code> ，网盘备份等优点）</li>
<li>更好的版本控制</li>
</ul>
</div>

<div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40"><span class="section-number-3">6.1</span> Emacs 也很美</h3>
<div class="outline-text-3" id="text-6-1">
<p>
<b>配置插件源</b>
</p>

<p>
在进行美化之前我们需要配置插件的源（默认的源非常有限），最常使用的是 <a href="https://melpa.org/">MELPA</a>
（Milkypostman's Emacs Lisp Package Archive）。它有非常多的插件（3000 多个插件）。
一个插件下载的次数多并不能说明它非常有用，也许这个插件是其他的插件的依赖。在<a href="https://melpa.org/#/getting-started">这里</a>
你可以找到其安装使用方法。添加源后，我们就可以使用 <code>M-x package-list-packages</code>
来查看所有 MELPA 上的插件了。在表单中可以使用 <code>I</code> 来标记安装 <code>D</code> 来标记删除，
<code>U</code> 来更新，并用 <code>X</code> 来确认。
</p>

<p>
你可以直接将下面的代码复制到你的配置文件顶端，从而直接使用 Melpa 作为插件的源。
你可以将你需要的插件名字写在 <code>my/packages</code> 中，Emacs 在启动时会自动下载未被安装
的插件。
</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp"> <span style="color: #AE81FF;">(</span><span style="color: #F92672;">when</span> <span style="color: #66D9EF;">(</span>&gt;= emacs-major-version <span style="color: #AE81FF;">24</span><span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">package</span><span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span>package-initialize<span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span>setq package-archives '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"gnu"</span>   . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/gnu/"</span><span style="color: #E6DB74;">)</span>
                      <span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"melpa"</span> . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/melpa/"</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#27880;&#24847; elpa.emacs-china.org &#26159; Emacs China &#20013;&#25991;&#31038;&#21306;&#22312;&#22269;&#20869;&#25645;&#24314;&#30340;&#19968;&#20010; ELPA &#38236;&#20687;</span>

 <span style="color: #75715E;">;; </span><span style="color: #75715E;">cl - Common Lisp Extension</span>
 <span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">cl</span><span style="color: #AE81FF;">)</span>

 <span style="color: #75715E;">;; </span><span style="color: #75715E;">Add Packages</span>
 <span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">my/packages</span> '<span style="color: #66D9EF;">(</span>
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Auto-completion ---</span>
                company
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Better Editor ---</span>
                hungry-delete
                swiper
                counsel
                smartparens
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Major Mode ---</span>
                js2-mode
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Minor Mode ---</span>
                nodejs-repl
                exec-path-from-shell
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Themes ---</span>
                monokai-theme
                <span style="color: #75715E;">;; </span><span style="color: #75715E;">solarized-theme</span>
                <span style="color: #66D9EF;">)</span> <span style="color: #75715E;">"Default packages"</span><span style="color: #AE81FF;">)</span>

 <span style="color: #AE81FF;">(</span>setq package-selected-packages my/packages<span style="color: #AE81FF;">)</span>

 <span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">my/packages-installed-p</span> <span style="color: #66D9EF;">()</span>
     <span style="color: #66D9EF;">(</span>loop for pkg in my/packages
           when <span style="color: #A6E22E;">(</span>not <span style="color: #E6DB74;">(</span>package-installed-p pkg<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span> do <span style="color: #A6E22E;">(</span>return nil<span style="color: #A6E22E;">)</span>
           finally <span style="color: #A6E22E;">(</span>return t<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

 <span style="color: #AE81FF;">(</span><span style="color: #F92672;">unless</span> <span style="color: #66D9EF;">(</span>my/packages-installed-p<span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"%s"</span> <span style="color: #E6DB74;">"Refreshing package database..."</span><span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span>package-refresh-contents<span style="color: #66D9EF;">)</span>
     <span style="color: #66D9EF;">(</span><span style="color: #F92672;">dolist</span> <span style="color: #A6E22E;">(</span>pkg my/packages<span style="color: #A6E22E;">)</span>
       <span style="color: #A6E22E;">(</span><span style="color: #F92672;">when</span> <span style="color: #E6DB74;">(</span>not <span style="color: #FD971F;">(</span>package-installed-p pkg<span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
         <span style="color: #E6DB74;">(</span>package-install pkg<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

 <span style="color: #75715E;">;; </span><span style="color: #75715E;">Find Executable Path on OS X</span>
 <span style="color: #AE81FF;">(</span><span style="color: #F92672;">when</span> <span style="color: #66D9EF;">(</span>memq window-system '<span style="color: #A6E22E;">(</span>mac ns<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
   <span style="color: #66D9EF;">(</span>exec-path-from-shell-initialize<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
关于上面这段配置代码有几个知识点，首先就是这段配置文件中用到了 <code>loop for ... in</code>
，它来自 <code>cl</code> 即 Common Lisp 扩展。 <code>for</code> , <code>in</code>, <code>collect</code> 均为 <code>cl-loop</code> 中的
保留关键字。下面是一些简单的 <code>cl-loop</code> 的使用示例：
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#36941;&#21382;&#27599;&#19968;&#20010;&#32531;&#20914;&#21306;&#65288;Buffer&#65289;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">cl-loop</span> for buf in <span style="color: #66D9EF;">(</span>buffer-list<span style="color: #66D9EF;">)</span>
         collect <span style="color: #66D9EF;">(</span>buffer-file-name buf<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#23547;&#25214; 729 &#30340;&#24179;&#26041;&#26681;&#65288;&#35774;&#32622;&#26368;&#22823;&#20026; 100 &#20026;&#20102;&#38450;&#27490;&#26080;&#38480;&#24490;&#29615;&#65289;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">cl-loop</span> for x from <span style="color: #AE81FF;">1</span> to <span style="color: #AE81FF;">100</span>
         for y = <span style="color: #66D9EF;">(</span>* x x<span style="color: #66D9EF;">)</span>
         until <span style="color: #66D9EF;">(</span>&gt;= y <span style="color: #AE81FF;">729</span><span style="color: #66D9EF;">)</span>
         finally return <span style="color: #66D9EF;">(</span>list x <span style="color: #A6E22E;">(</span>= y <span style="color: #AE81FF;">729</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
你可以在<a href="http://www.gnu.org/software/emacs/manual/html_mono/cl.html#Loop-Facility">这里</a>找到更多关于循环的使用说明。
</p>

<p>
其次就是它使用到了 <code>quote</code>, 它其实就是我们之前常常见到的 ='= （单引号）的完全体。
因为它在 Lisp 中十分常用，所以就提供了简写的方法。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#19979;&#38754;&#20004;&#34892;&#30340;&#25928;&#26524;&#23436;&#20840;&#30456;&#21516;&#30340;</span>
<span style="color: #AE81FF;">(</span>quote foo<span style="color: #AE81FF;">)</span>
'foo
</pre>
</div>

<p>
<code>quote</code> 的意思是不要执行后面的内容，返回它原本的内容（具体请参考下面的例子）
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>print '<span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span> <span style="color: #75715E;">;; </span><span style="color: #75715E;">-&gt; (+ 1 1)</span>
<span style="color: #AE81FF;">(</span>print <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>  <span style="color: #75715E;">;; </span><span style="color: #75715E;">-&gt; 2</span>
</pre>
</div>

<p>
更多关于 <code>quote</code> 的内容可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Quoting.html">这里</a>找到，或者在<a href="http://stackoverflow.com/questions/134887/when-to-use-quote-in-lisp">这里</a>找到 StackOverflow 上对于它的讨论。
</p>

<p>
这样我们就可以区分下面三行代码的区别，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#31532;&#19968;&#31181;</span>
<span style="color: #AE81FF;">(</span>setq package-selected-packages my/packages<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#31532;&#20108;&#31181;</span>
<span style="color: #AE81FF;">(</span>setq package-selected-packages 'my/packages<span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#31532;&#19977;&#31181;</span>
<span style="color: #AE81FF;">(</span>setq package-selected-packages <span style="color: #66D9EF;">(</span>quote my/packages<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
第一种设置是在缓冲区中设置一个名为 <code>package-selected-packages</code> 的变量，将其的值
设定为 <code>my/packages</code> 变量的值。第二种和第三种其实是完全相同的，将一个名为
<code>package-selected-packages</code> 的变量设置为 <code>my/packages</code> 。
</p>

<p>
我们可以用下面代码将 Emacs 设置为开启默认全屏，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq initial-frame-alist <span style="color: #66D9EF;">(</span>quote <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>fullscreen . maximized<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
我们也可以启用自动括号匹配（Highlight Matching Parenthesis），随后会介绍插件来增
强这个匹配的功能。你可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html">这里</a>读到关于钩子的更多信息。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'emacs-lisp-mode-hook 'show-paren-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
高亮当前行，当文本内容很多时可以很容易找到光标的位置。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-hl-line-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
<b>安装主题</b>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-to-list my/packages 'monokai-theme<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
然后使用下面的配置使其每次打开编辑器时加载主题，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>load-theme 'monokai <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
<b>推荐插件</b>
</p>

<ul class="org-ul">
<li><a href="http://company-mode.github.io/">company</a></li>
<li><a href="https://github.com/nflath/hungry-delete">hungry-delete</a></li>
<li><a href="https://github.com/nonsequitur/smex">Smex</a> (如果你使用 Counsel 来增强你的 <code>M-x</code> ，那么就不需要再安装 Smex 了)</li>
<li><a href="https://github.com/abo-abo/swiper">Swiper &amp; Counsel</a></li>
<li><a href="https://github.com/Fuco1/smartparens">smartparens</a></li>
</ul>

<p>
使用 <code>M-x customize-group</code> 后选择对应的插件名称，可以进入可视化选项区对指定的插
件做自定义设置。当选择 Save for future session 后，刚刚做的设计就会被保存在你的
配置文件（ <code>init.el</code> ）中。关于各个插件的安装与使用方法通常都可以在其官方页面找
到（GitHub Pages 或者是项目仓库中的 README 文件）。我们强烈建议大家在安装这些插
件后阅读使用方法来更好的将它们使用到你的日常工作当中使效率最大化。
</p>
</div>
</div>

<div id="outline-container-orgheadline42" class="outline-3">
<h3 id="orgheadline42"><span class="section-number-3">6.2</span> JavaScript IDE</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Emacs 提供的默认 JavaScript Major Mode 并不是非常好用。所以我们可以将默认的模式
替换成 <a href="https://github.com/mooz/js2-mode">js2-mode</a> 一个比默认模式好用的 Major Mode。我们可以通过 MELPA 来下载它，然
后用下面的代码将其启用。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq auto-mode-alist
      <span style="color: #66D9EF;">(</span>append
       '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"\\.js\\'"</span> . js2-mode<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
       auto-mode-alist<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
你可以在<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Auto-Major-Mode.html">这里</a>（How Emacs Chooses a Major Mode）找到 Emacs 是如何选择何时该选用何
种 Major Mode 的方法。
</p>

<p>
在这里我们需要知道 <code>auto-mode-alist</code> 的作用，这个变量是一个 <a href="https://www.emacswiki.org/emacs/AssociationList">AssociationList</a>，它
使用正则表达式（REGEXP）的规则来匹配不同类型文件应使用的 Major Mode。 下面是几个
正则表达式匹配的例子，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\`/tmp/fol/"</span> . text-mode<span style="color: #66D9EF;">)</span>
 <span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\.texinfo\\'"</span> . texinfo-mode<span style="color: #66D9EF;">)</span>
 <span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\.texi\\'"</span> . texinfo-mode<span style="color: #66D9EF;">)</span>
 <span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\.el\\'"</span> . emacs-lisp-mode<span style="color: #66D9EF;">)</span>
 <span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\.c\\'"</span> . c-mode<span style="color: #66D9EF;">)</span>
 <span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"\\.h\\'"</span> . c-mode<span style="color: #66D9EF;">)</span>
 &#8230;<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
下面是如何添加新的模式与对应文件类型的例子（与我们配置 <code>js2-mode</code> 时相似的例子），
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq auto-mode-alist
  <span style="color: #66D9EF;">(</span>append
   <span style="color: #75715E;">;; </span><span style="color: #75715E;">File name (within directory) starts with a dot.</span>
   '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"/\\.[</span><span style="color: #E6DB74; font-weight: bold;">^</span><span style="color: #E6DB74;">/]*\\'"</span> . fundamental-mode<span style="color: #E6DB74;">)</span>
     <span style="color: #75715E;">;; </span><span style="color: #75715E;">File name has no dot.</span>
     <span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"/[</span><span style="color: #E6DB74; font-weight: bold;">^</span><span style="color: #E6DB74;">\\./]*\\'"</span> . fundamental-mode<span style="color: #E6DB74;">)</span>
     <span style="color: #75715E;">;; </span><span style="color: #75715E;">File name ends in &#8216;.C&#8217;.</span>
     <span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"\\.C\\'"</span> . c++-mode<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
   auto-mode-alist<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在 <code>js2-mode</code> 模式中会提供
</p>

<ul class="org-ul">
<li>语法高亮</li>
<li>语法检查器（Linter）</li>
</ul>

<p>
执行缓冲区的代码可以使用 <code>nodejs-repl</code> 插件，它需要你的机器上已经安装了 NodeJS。
然而在 Mac OS X 上可能会出现找不到 NodeJS 可执行文件的问题，要解决这个问题你需要
安装另外一个 <code>exec-path-from-shell</code> 的插件并将其启用。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">when</span> <span style="color: #66D9EF;">(</span>memq window-system '<span style="color: #A6E22E;">(</span>mac ns<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>exec-path-from-shell-initialize<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
有了 <code>nodejs-repl</code> 我们就可以方便的测试和开发我们的 JavaScript 代码了（你可以在
<a href="https://github.com/mooz/js2-mode">这里</a>找到更多关于它的使用方法）。
</p>
</div>

<div id="outline-container-orgheadline41" class="outline-4">
<h4 id="orgheadline41"><span class="section-number-4">6.2.1</span> Org-mode 进阶</h4>
<div class="outline-text-4" id="text-6-2-1">
<p>
在 Org-mode 中你可以直接开启新的缓冲区（Buffer）直接用相应的 Major Mode 来编辑代
码块内的内容。在代码块中使用 =C-c '= 会直接打开对应模式的缓冲区（不仅限于 Lisp）。
这样就使在 Org-mode 中编辑代码变的十分方便快捷。
</p>

<p>
使用 <code>&lt;s</code> 然后 Tab 可以直接插入代码块的代码片段（Snippet），更多类似的代码片段
（Org-mode Easy Templates）可以在<a href="http://orgmode.org/manual/Easy-Templates.html">这里</a>找到。
</p>

<pre class="example">
#+BEGIN_SRC emacs-lisp
  ;; Your code goes here
  ;; 你的代码写在这里
#+END_SRC
</pre>

<p>
<b>添加 Org-mode 文本内语法高亮</b>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">org</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>setq org-src-fontify-natively t<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在 Org-mode 中重置有序列表序号可以直接使用 M-&lt;RET&gt; 。
</p>

<p>
<b>Agenda 的使用</b>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#35774;&#32622;&#40664;&#35748; Org Agenda &#25991;&#20214;&#30446;&#24405;</span>
<span style="color: #AE81FF;">(</span>setq org-agenda-files '<span style="color: #66D9EF;">(</span><span style="color: #E6DB74;">"~/org"</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#35774;&#32622; org-agenda &#25171;&#24320;&#24555;&#25463;&#38190;</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-c a"</span><span style="color: #66D9EF;">)</span> 'org-agenda<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
你只需将你的 <code>*.org</code> 文件放入上面所指定的文件夹中就可以开始使用 Agenda
模式了。
</p>

<ul class="org-ul">
<li><code>C-c C-s</code> 选择想要完成的时间</li>
<li><code>C-c C-d</code> 选择想要结束的时间</li>
<li><code>C-c a</code> 可以打开 Agenda 模式菜单并选择不同的可视方式（ <code>r</code> ）</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline46" class="outline-2">
<h2 id="orgheadline46"><span class="section-number-2">7</span> 第三天：配置文件模块化（上）</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44"><span class="section-number-3">7.1</span> 多文件存储配置文件(上)</h3>
<div class="outline-text-3" id="text-7-1">
<p>
将不同的配置代码放置到不同的文件中，使其模块化，这让我们的后续维护变得更加简单。
下面是我们现在的 <code>~/.emacs.d/</code> 目录中的样子，
</p>

<pre class="example">
├── auto-save-list # 自动生成的保存数据
├── elpa           # 下载的插件目录
├── init.el        # 我们的配置文件
└── recentf        # 最近访问的文件列表
</pre>

<p>
通常我们只保存配置文件和对其进行版本控制，其他的插件均为在第一次使用编辑器时再通
过网络重新下载，当然你也可以选择将全部配置文件进行版本控制来保证自己时刻拥有最稳
定的生产环境。
</p>

<p>
Elisp 中并没有命名空间（Namespace），换句话说就是所有的变量均为全局变量，所以其
命名方法就变的非常重要。下面是一个简单的命名规则，
</p>

<pre class="example">
#自定义变量可以使用自己的名字作为命名方式（可以是变量名或者函数名）
my/XXXX

#模式命名规则
ModeName-mode

#模式内的变量则可以使用
ModeName-VariableName
</pre>

<p>
遵守上面的命名规则可以最大程度的减少命名冲突发生的可能性。
</p>

<p>
现在我们想将原本混合在一起的配置文件分为下面的几个模块（每一个模块为一个独立的配
置文件并将其保存在指定的子目录中），它们分别是
</p>

<pre class="example">
init-packages.el        # 插件管理
init-ui.el              # 视觉层配置
init-better-defaults.el # 增强内置功能
init-keybindings.el     # 快捷键绑定
init-org.el             # Org 模式相关的全部设定
custome.el              # 存放使用编辑器接口产生的配置信息
</pre>

<p>
下面为将配置文件进行模块化后的目录结构，
</p>

<pre class="example">
├── init.el
└── lisp
    ├── comstom.el
    ├── init-better-defaults.el
    ├── init-helper.el
    ├── init-keybindings.el
    ├── init-packages.el
    ├── init-ui.el
    └── init-org.el
</pre>

<p>
使用模块化配置就可以让我们在之后的配置中迅速的定位与更改配置内容，让整个过程变得
更有条理也更加高效。
</p>

<p>
和之前一样 <code>init.el</code> 是配置文件的入口，现在它便成为了所有模块配置文件的入口，所
以要使用这些模块时，我们需要在其中引用需要加载的模块。下面以 <code>init-packages.el</code>
（此配置为添加插件的模块） 为例，详细说明如何模块化以及应用的方法。
</p>

<p>
下面是在模块化配置之前，我们所使用的配置文件 <code>~/.emacs.d/init.el</code> 的样子，我们将
所有的配置代码都放置在了同一个文件中（如下所示）
</p>

<p>
下面为 <code>~/.emacs.d/init.el</code> 文件的内容
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;;  </span><span style="color: #75715E;">__        __             __   ___</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|__)  /\  /  ` |__/  /\  / _` |__</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|    /~~\ \__, |  \ /~~\ \__&gt; |___</span>
<span style="color: #75715E;">;;                      </span><span style="color: #75715E;">__   ___        ___      ___</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|\/|  /\  |\ |  /\  / _` |__   |\/| |__  |\ |  |</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|  | /~~\ | \| /~~\ \__&gt; |___  |  | |___ | \|  |</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">when</span> <span style="color: #66D9EF;">(</span>&gt;= emacs-major-version <span style="color: #AE81FF;">24</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">package</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>package-initialize<span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>setq package-archives '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"gnu"</span>   . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/gnu/"</span><span style="color: #E6DB74;">)</span>
                         <span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"melpa"</span> . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/melpa/"</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">cl - Common Lisp Extension</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">cl</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Add Packages</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">my/packages</span> '<span style="color: #66D9EF;">(</span>
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Auto-completion ---</span>
         company
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Better Editor ---</span>
         smooth-scrolling
         hungry-delete
         swiper
         counsel
         smartparens
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Major Mode ---</span>
         js2-mode
         markdown-mode
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Minor Mode ---</span>
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">Quick Note Taking</span>
         deft
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">JavaScript REPL</span>
         nodejs-repl
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">Find OS X Executable Helper Package</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">...</span>
</pre>
</div>

<p>
之前为了更好的区分不同的区域我使用的方法是使用 ASCII Art 然后再以关键字来做搜索
跳转，但是这样再编辑工程中依旧十分缓慢和麻烦。于是我们现在要将配置文件全部模块化，
把不同部分的配置代码放置在不同的配置文件中，并在入口文件（ <code>~/.emacs.d/init.el</code>
）中依次引用不用的模块。
</p>

<p>
下面为 <code>~/.emacs.d/lisp/init-packages.el</code> 模块中的代码
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;;  </span><span style="color: #75715E;">__        __             __   ___</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|__)  /\  /  ` |__/  /\  / _` |__</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|    /~~\ \__, |  \ /~~\ \__&gt; |___</span>
<span style="color: #75715E;">;;                      </span><span style="color: #75715E;">__   ___        ___      ___</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|\/|  /\  |\ |  /\  / _` |__   |\/| |__  |\ |  |</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">|  | /~~\ | \| /~~\ \__&gt; |___  |  | |___ | \|  |</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">when</span> <span style="color: #66D9EF;">(</span>&gt;= emacs-major-version <span style="color: #AE81FF;">24</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">package</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>package-initialize<span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>setq package-archives '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"gnu"</span>   . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/gnu/"</span><span style="color: #E6DB74;">)</span>
                         <span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"melpa"</span> . <span style="color: #E6DB74;">"http://elpa.emacs-china.org/melpa/"</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">cl - Common Lisp Extension</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">cl</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Add Packages</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">my/packages</span> '<span style="color: #66D9EF;">(</span>
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Auto-completion ---</span>
         company
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Better Editor ---</span>
         smooth-scrolling
         hungry-delete
         swiper
         counsel
         smartparens
         popwin
         <span style="color: #75715E;">;; </span><span style="color: #75715E;">--- Major Mode ---</span>
         js2-mode
         markdown-mode

<span style="color: #75715E;">;; </span><span style="color: #75715E;">...</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#25991;&#20214;&#26411;&#23614;</span>
<span style="color: #A6E22E;">(</span><span style="color: #F92672;">provide</span> '<span style="color: #AE81FF;">init-packages</span><span style="color: #A6E22E;">)</span>
</pre>
</div>

<p>
下面为 <code>~/.emacs.d/init.el</code> 入口文件中的代码
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>package-initialize<span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>add-to-list 'load-path <span style="color: #E6DB74;">"~/.emacs.d/lisp/"</span><span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">Package Management</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">-----------------------------------------------------------------</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">init-packages</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
模块化要做的其实非常简单，我们要做的其实就是把某一个更改编辑器某定部分（例如，插
件管理，显示层，快捷键绑定等）的配置代码写入一个独立的文件中并在末尾为其添加
<code>(provide 'modul-name)</code> (这里我们的模块名为 <code>init-packages</code> )使其可以在入口文件
中被调用，然后再在入口文件中将其引用既可。
</p>

<p>
这里需要注意的是，我们需要在入口文件中添加 <code>(add-to-list 'load-path
"~/.emacs.d/lisp/")</code> 这可以让 Emacs 找到需要加载的模块所处的位置。
</p>

<p>
更多模块化的配置文件可以在<a href="https://github.com/zilongshanren/Learning-Emacs/tree/day3">这里</a>找到。
</p>
</div>
</div>

<div id="outline-container-orgheadline45" class="outline-3">
<h3 id="orgheadline45"><span class="section-number-3">7.2</span> Major 与 Minor Mode 详解</h3>
<div class="outline-text-3" id="text-7-2">
<p>
在这一节我们将详细介绍 Major Mode 与 Minor Mode 去区别。每一个文件类型都对应一个
Major Mode，它提供语法高亮以及缩进等基本的编辑支持功能，然后而 Minor Mode 则提供
其余的增强性的功能（例如 <code>linum-mode</code> ）。
</p>

<p>
在 Emacs 中，Major Mode 又分为三种，
</p>

<ul class="org-ul">
<li><code>text-mode</code> ，用于编辑文本文件</li>
<li><code>special-mode</code> ，特殊模式（很少见）</li>
<li><code>prog-mode</code> ，所有的编程语言的父模式</li>
</ul>

<p>
在每一个模式（mode）中它的名称与各个变量还有函数都是有特定的命名规则，比如所有的
模式都被命名为 <code>ModeName-mode</code> ，里面所设置的快捷键则为 <code>ModeName-mode-key-map</code>
，而所有的钩子则会被命名为 <code>ModeName-mode-hook</code> 。
</p>

<p>
注明：为了保持阅读的完整性，部分第三天的关于默认编辑器优化的内容被移至第四天。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline54" class="outline-2">
<h2 id="orgheadline54"><span class="section-number-2">8</span> 第四天：配置文件模块化（下）以及使用优化</h2>
<div class="outline-text-2" id="text-8">
</div><div id="outline-container-orgheadline47" class="outline-3">
<h3 id="orgheadline47"><span class="section-number-3">8.1</span> 配置文件模块化（下）</h3>
<div class="outline-text-3" id="text-8-1">
<p>
在这一部分我们首先需要知道的是什么是 <code>features</code> 。在 Emacs 中每一个 <code>feature</code> 都
是一个 Elisp 符号，用于代表一个 Lisp 插件（Package）。
</p>

<p>
当一个插件调用 <code>(provide 'symbol_name)</code> 函数时，Emacs 就会将这个符号加入到
<code>features</code> 的列表中去。你可以在<a href="http://ergoemacs.org/emacs/elisp_feature_name.html">这里</a>读到更多关于 feature 的内容。
</p>

<p>
接着我们需要弄明白的是 <code>load-file</code> , <code>load</code> , <code>require</code> , <code>autoload</code> 之间的区别。
（他们之间区别的链接已经再前面贴过了，你也可以在<a href="http://ergoemacs.org/emacs/elisp_library_system.html">这里</a>找到之前同样的链接）
</p>

<p>
简单来说， <code>load-file</code> 用于打开某一个指定的文件，用于当你不想让 Emacs 来去决定加
载某个配置文件时（ <code>.el</code> 或者 <code>.elc</code> 文件）。
</p>

<p>
<code>load</code> 搜索 <code>load-path</code> 中的路径并打开第一个所找到的匹配文件名的文件。此方法用于
你预先不知道文件路径的时候。
</p>

<p>
<code>require</code> 加载还未被加载的插件。首先它会查看变量 <code>features</code> 中是否存在所要加载的
符号如果不存在则使用上面提到的 <code>load</code> 将其载入。（有点类似于其他编程语言中的
<code>import</code> ）
</p>

<p>
<code>autoload</code> 用于仅在函数调用时加载文件，使用此方法可以大大节省编辑器的启动时间。
</p>
</div>
</div>

<div id="outline-container-orgheadline51" class="outline-3">
<h3 id="orgheadline51"><span class="section-number-3">8.2</span> 更好的默认设置</h3>
<div class="outline-text-3" id="text-8-2">
<p>
在这一节我们会配置我们的编辑器使其有更好的使用体验。整个过程就如同搭积木一般，将
更好的体验建立在已有的功能基础之上。这样的优化使整个过程变得更高效，也更有趣。
</p>

<p>
下面的代码可以是 Emacs 自动加载外部修改过的文件。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-auto-revert-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用下面的代码可以关闭自己生产的保存文件（之前我们已经关闭过了 Emacs 自动生产的
备份文件了，现在是关闭自动保存文件）。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq auto-save-default nil<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
如果你发现你在使用中发现了那些编辑行为与你预期的不相符时，你可以通过搜索引擎去寻
找解决方案然后将其加入你的配置中并打造一个真正属于你的神器！
</p>

<p>
<code>popwin</code> 插件可以自动将光标移动到，新创建的窗口中。使用下面的代码将其启用，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">popwin</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>popwin-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
也许你并不喜欢听到错误时的“哔哔”的警告提示音，使用下面的代码你可以关闭 Emacs 中的警告音，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq ring-bell-function 'ignore<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
每一次当 Emacs 需要与你确认某个命令时需要输入 <code>(yes or no)</code> 比较麻烦，所有我们可
以使用下面的代码，设置一个别名将其简化为只输入 <code>(y or n)</code> 。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>fset 'yes-or-no-p 'y-or-n-p<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline48" class="outline-4">
<h4 id="orgheadline48"><span class="section-number-4">8.2.1</span> 代码缩进</h4>
<div class="outline-text-4" id="text-8-2-1">
<p>
<code>indent-region</code> 可以帮我们重新缩进所选区域的代码，但是每一次都选中十分麻烦。使用
下面的代码可以一次重新缩进全部缓冲区的代码。（之后也会介绍更好用的，代码格式美化
的插件）
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">indent-buffer</span><span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>indent-region <span style="color: #A6E22E;">(</span>point-min<span style="color: #A6E22E;">)</span> <span style="color: #A6E22E;">(</span>point-max<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">indent-region-or-buffer</span><span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">save-excursion</span>
    <span style="color: #A6E22E;">(</span><span style="color: #F92672;">if</span> <span style="color: #E6DB74;">(</span>region-active-p<span style="color: #E6DB74;">)</span>
        <span style="color: #E6DB74;">(</span><span style="color: #F92672;">progn</span>
          <span style="color: #FD971F;">(</span>indent-region <span style="color: #F92672;">(</span>region-beginning<span style="color: #F92672;">)</span> <span style="color: #F92672;">(</span>region-end<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span>
          <span style="color: #FD971F;">(</span>message <span style="color: #E6DB74;">"Indent selected region."</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
      <span style="color: #E6DB74;">(</span><span style="color: #F92672;">progn</span>
        <span style="color: #FD971F;">(</span>indent-buffer<span style="color: #FD971F;">)</span>
        <span style="color: #FD971F;">(</span>message <span style="color: #E6DB74;">"Indent buffer."</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
然后再将其用下面的代码将其绑定为快捷键，第一个 <code>\</code> 用于将紧跟的 <code>\</code> 进行逃脱（escape）。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-M-\\"</span><span style="color: #66D9EF;">)</span> 'indent-region-or-buffer<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline49" class="outline-4">
<h4 id="orgheadline49"><span class="section-number-4">8.2.2</span> 缩写补全</h4>
<div class="outline-text-4" id="text-8-2-2">
<p>
使用下面的代码我们可以开启 <code>abbrev</code> 模式并定义一个缩写表，每当我们输入下面的缩写
并以空格结束时，Emacs 就会将其自动展开成为我们所需要的字符串。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq-default abbrev-mode t<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>define-abbrev-table 'global-abbrev-table '<span style="color: #66D9EF;">(</span>
                                            <span style="color: #75715E;">;; </span><span style="color: #75715E;">Shifu</span>
                                            <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"8zl"</span> <span style="color: #E6DB74;">"zilongshanren"</span><span style="color: #A6E22E;">)</span>
                                            <span style="color: #75715E;">;; </span><span style="color: #75715E;">Tudi</span>
                                            <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"8lxy"</span> <span style="color: #E6DB74;">"lixinyang"</span><span style="color: #A6E22E;">)</span>
                                           <span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
上面的缩写前使用的 <code>8</code> 也类似于命名空间的作用，使其不会与我们所常用的字符串冲突。
</p>
</div>
</div>

<div id="outline-container-orgheadline50" class="outline-4">
<h4 id="orgheadline50"><span class="section-number-4">8.2.3</span> Hippie 补全</h4>
<div class="outline-text-4" id="text-8-2-3">
<p>
Company 有时候补全功能并不是非常理想，这时就可以使用 Hippie Expand 来完成补全。
Company Mode 补全效果不理想的原因是在不同的区域中会使用不同的后端函数来完成补全，
但是当后端补全函数不能被激活时，则补全就不会被激活。
</p>


<p>
我们可以将下面的代码加入到我们的配置文件中，来增强 Hippie Expand 的功能，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq hippie-expand-try-function-list '<span style="color: #66D9EF;">(</span>try-expand-debbrev
                                        try-expand-debbrev-all-buffers
                                        try-expand-debbrev-from-kill
                                        try-complete-file-name-partially
                                        try-complete-file-name
                                        try-expand-all-abbrevs
                                        try-expand-list
                                        try-expand-line
                                        try-complete-lisp-symbol-partially
                                        try-complete-lisp-symbol<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
然后将其绑定为快捷键，使我们可以更方便的使用它。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"s-/"</span><span style="color: #66D9EF;">)</span> 'hippie-expand<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline52" class="outline-3">
<h3 id="orgheadline52"><span class="section-number-3">8.3</span> Dired Mode</h3>
<div class="outline-text-3" id="text-8-3">
<p>
Dired Mode 是一个强大的模式它能让我们完成和文件管理相关的所有操作。
</p>

<p>
使用 <code>C-x d</code> 就可以进入 Dired Mode，这个模式类似于图形界面系统中的资源管理器。你
可以在其中查看文件和目录的详细信息，对他们进行各种操作，甚至复制粘贴缓冲区中的内
容。下面是一些常用的操作（下面的所有键均需在 Dired Mode 下使用），
</p>

<ul class="org-ul">
<li><code>+</code> 创建目录</li>
<li><code>g</code> 刷新目录</li>
<li><code>C</code> 拷贝</li>
<li><code>D</code> 删除</li>
<li><code>R</code> 重命名</li>
<li><code>d</code> 标记删除</li>
<li><code>u</code> 取消标记</li>
<li><code>x</code> 执行所有的标记</li>
</ul>

<p>
这里有几点可以优化的地方。第一是删除目录的时候 Emacs 会询问是否递归删除或拷贝，
这也有些麻烦我们可以用下面的配置将其设定为默认递归删除目录（出于安全原因的考虑，
也许你需要保持此行为。所有文中的配置请务必按需配置）。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq dired-recursive-deletes 'always<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>setq dired-recursive-copies 'always<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
第二是，每一次你进入一个回车进入一个新的目录中是，一个新的缓冲区就会被建立。这使
得我们的缓冲区列表中充满了大量没有实际意义的记录。我们可以使用下面的代码，让
Emacs 重用唯一的一个缓冲区作为 Dired Mode 显示专用缓冲区。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>put 'dired-find-alternate-file 'disabled nil<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20027;&#21160;&#21152;&#36733; Dired Mode</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(require 'dired)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(defined-key dired-mode-map (kbd "RET") 'dired-find-alternate-file)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#24310;&#36831;&#21152;&#36733;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">with-eval-after-load</span> 'dired
    <span style="color: #66D9EF;">(</span>define-key dired-mode-map <span style="color: #A6E22E;">(</span>kbd <span style="color: #E6DB74;">"RET"</span><span style="color: #A6E22E;">)</span> 'dired-find-alternate-file<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用延迟加载可以使编辑器加载速度有所提升。
</p>

<p>
启用 <code>dired-x</code> 可以让每一次进入 Dired 模式时，使用新的快捷键 <code>C-x C-j</code> 就可以进
入当前文件夹的所在的路径。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">dired-x</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用 <code>(setq dired-dwin-target 1)</code> 则可以使当一个窗口（frame）中存在两个分屏
（window）时，将另一个分屏自动设置成拷贝地址的目标。
</p>

<p>
最后如果你是 Mac OS X 的用户，可以安装 <code>reveal-in-osx-finder</code> 这个插件（你可以在
<a href="https://melpa.org/#/reveal-in-osx-finder">这里</a>找到它），它可以将任意文件直接在 Finder 中打开。你想安装这个插件，将其添加至
第二天的插件列表中即可，下次启动 Emacs 时，它就会自动帮你完成下载。
</p>
</div>
</div>

<div id="outline-container-orgheadline53" class="outline-3">
<h3 id="orgheadline53"><span class="section-number-3">8.4</span> Org-mode 管理 Emacs 配置</h3>
<div class="outline-text-3" id="text-8-4">
<p>
Org-mode 下的文学编程将颠覆你对于 Emacs 的看法。因为我们也可以使用 Org 来管理
Emacs 的配置文件（笔者和他的师傅其实更倾向于模块管理配置文件）。
</p>

<p>
你需要将下面的代码放入配置入口文件（ <code>init.el</code> ）中，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>package-initialize<span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">org-install</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">ob-tangle</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>org-babel-load-file <span style="color: #66D9EF;">(</span>expand-file-name <span style="color: #E6DB74;">"org-file-name.org"</span> user-emacs-directory<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
之后我们需要做的仅仅只是将所有的配置文件放入 Org 模式中的代码块即可，并使用目录
结构来表述你的配置文件再把它保存在与入口文件相同的目录中即可（文件名为
<code>org-file-name.org</code> ）。Emacs 会提取其中的配置并使其生效。这样做的好处是可以使自
己和他人更直观的，理解你的配置文件或者代码。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline61" class="outline-2">
<h2 id="orgheadline61"><span class="section-number-2">9</span> 第五天：打造前端开发神器</h2>
<div class="outline-text-2" id="text-9">
<p>
照例我们先修复一些现在存在的小问题。首先是自动配对的小问题，在 Emacs Lisp 中我们
有时候只需要一个 ='= 但是 Emacs 很好心的帮我们做了补全，但这并不是我们需要的。我
们可以通过下面的代码来让使 Emacs Lisp 在 Emacs 中的编辑变得更方便（可以将其添加
至 <code>init-default.el</code> 配置文件中）。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>sp-local-pair 'emacs-lisp-mode <span style="color: #E6DB74;">"'"</span> nil <span style="color: #F92672;">:actions</span> nil<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>sp-local-pair 'lisp-interaction-mode <span style="color: #E6DB74;">"'"</span> nil <span style="color: #F92672;">:actions</span> nil<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20063;&#21487;&#20197;&#25226;&#19978;&#38754;&#20004;&#21477;&#21512;&#36215;&#26469;</span>
<span style="color: #AE81FF;">(</span>sp-local-pair '<span style="color: #66D9EF;">(</span>emacs-lisp-mode lisp-interaction-mode<span style="color: #66D9EF;">)</span> <span style="color: #E6DB74;">"'"</span> nil <span style="color: #F92672;">:actions</span> nil<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在添加配置代码后重启 Emacs 使其生效。当然这个方法你也可以运用在其他的各个 Major
Mode 中，如果你不想 Emacs 对某些符号进行类似的自动匹配补全。
</p>

<p>
<code>show-paren-mode</code> 可以使鼠标在括号上是高亮其所匹配的另一半括号，然而我们想要光标
在括号内时就高亮包含内容的两个括号，使用下面的代码就可以做到这一点。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>define-advice show-paren-function <span style="color: #66D9EF;">(</span><span style="color: #F92672;">:around</span> <span style="color: #A6E22E;">(</span>fn<span style="color: #A6E22E;">)</span> fix-show-paren-function<span style="color: #66D9EF;">)</span>
  <span style="color: #E6DB74;">"Highlight enclosing parens."</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">cond</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>looking-at-p <span style="color: #E6DB74;">"\\s("</span><span style="color: #E6DB74;">)</span> <span style="color: #E6DB74;">(</span>funcall fn<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
        <span style="color: #A6E22E;">(</span>t <span style="color: #E6DB74;">(</span><span style="color: #F92672;">save-excursion</span>
             <span style="color: #FD971F;">(</span><span style="color: #F92672;">ignore-errors</span> <span style="color: #F92672;">(</span>backward-up-list<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span>
             <span style="color: #FD971F;">(</span>funcall fn<span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
Lisp 的宏（Macro）类似于 C++ 中的模板，并可以生产新的代码（你可以在<a href="http://stackoverflow.com/questions/267862/what-makes-lisp-macros-so-special">这里</a>找到更多
关于宏的讨论）。使用它，我们可以增强某个函数的功能而不去更改这个函数的代码。
</p>

<p>
还有一个小问题就是解决在不同系统中的换行符，例如在 DOS 系统下的 <code>\r(^M)</code> 换行符，
这让我们有时候在 Unix 系统中很是头疼，因为它的存在会使版本控制误以为整行的代码都
被修改过而造成不必要的麻烦。（你可以在<a href="http://unix.stackexchange.com/questions/32001/what-is-m-and-how-do-i-get-rid-of-it">这里</a>找到更多关于 <code>\r(^M)</code> 的信息）
</p>

<p>
我们用两种方式来处理这个问题，隐藏这个换行符或者将其删除。首先下面是隐藏的方法，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">hidden-dos-eol</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #75715E;">"Do not show ^M in files containing mixed UNIX and DOS line endings."</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">unless</span> buffer-display-table
    <span style="color: #A6E22E;">(</span>setq buffer-display-table <span style="color: #E6DB74;">(</span>make-display-table<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>aset buffer-display-table ?\^M <span style="color: #A6E22E;">[]</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用下面的代码则可以定义函数将此换行符删除，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">remove-dos-eol</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #75715E;">"Replace DOS eolns CR LF with Unix eolns CR"</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>goto-char <span style="color: #A6E22E;">(</span>point-min<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">while</span> <span style="color: #A6E22E;">(</span>search-forward <span style="color: #E6DB74;">"\r"</span> nil t<span style="color: #A6E22E;">)</span> <span style="color: #A6E22E;">(</span>replace-match <span style="color: #E6DB74;">""</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline55" class="outline-3">
<h3 id="orgheadline55"><span class="section-number-3">9.1</span> web-mode</h3>
<div class="outline-text-3" id="text-9-1">
<p>
Emacs 自带的 HTML Mode 使用起来并不是那么的方便，而 web-mode 则是一个非常常用也
很强大的用于编辑前端代码的 Major Mode（你可以在<a href="https://github.com/fxbois/web-mode">这里</a>找到更多关于它的信息）。
</p>

<p>
首先我们需要安装它，照例我们需要将其添加至我们的插件列表中去。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">xinyang/packages</span> '<span style="color: #66D9EF;">(</span>
                           <span style="color: #75715E;">;; </span><span style="color: #75715E;">&#20320;&#20854;&#20182;&#30340;&#25554;&#20214;&#22312;&#36825;&#37324;</span>
                           web-mode
                           <span style="color: #66D9EF;">)</span> <span style="color: #75715E;">"Default packages"</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在安装完成后我们就可以开始配置它了，首先我们需要做的是将所有的 <code>*.html</code> 文件都使
用 web-mode 来打开。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq auto-mode-alist
      <span style="color: #66D9EF;">(</span>append
       '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"\\.js\\'"</span> . js2-mode<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
       '<span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">"\\.html\\'"</span> . web-mode<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
       auto-mode-alist<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
这样所有的 HTML 代码在 Emacs 中就会之间启用 web-mode 而非默认的 HTML Mode 了。你
可以阅读它的<a href="http://web-mode.org/">文档</a>来学习更多 web-mode 详细的使用方法。
</p>

<p>
例如使用 <code>M-;</code> 就可以注释当前行代码或选中行的代码。
</p>

<p>
接下来我们来做更多细节的配置，首先是缩减的大小的设置。因为 web-mode 支持在 HTML
文件中存在多语言，所以我们可以对不同的语言的缩减做出设置。下面的代码用于设置初始
的代码缩进，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">my-web-mode-indent-setup</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>setq web-mode-markup-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span> <span style="color: #75715E;">; </span><span style="color: #75715E;">web-mode, html tag in html file</span>
  <span style="color: #66D9EF;">(</span>setq web-mode-css-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span>    <span style="color: #75715E;">; </span><span style="color: #75715E;">web-mode, css in html file</span>
  <span style="color: #66D9EF;">(</span>setq web-mode-code-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #66D9EF;">)</span>   <span style="color: #75715E;">; </span><span style="color: #75715E;">web-mode, js code in html file</span>
  <span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>add-hook 'web-mode-hook 'my-web-mode-indent-setup<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
下面的函数可以用于在两个空格和四个空格之间进行切换，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">my-toggle-web-indent</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #75715E;">;; </span><span style="color: #75715E;">web development</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">if</span> <span style="color: #A6E22E;">(</span>or <span style="color: #E6DB74;">(</span>eq major-mode 'js-mode<span style="color: #E6DB74;">)</span> <span style="color: #E6DB74;">(</span>eq major-mode 'js2-mode<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span><span style="color: #F92672;">progn</span>
        <span style="color: #E6DB74;">(</span>setq js-indent-level <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> <span style="color: #F92672;">(</span>= js-indent-level <span style="color: #AE81FF;">2</span><span style="color: #F92672;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
        <span style="color: #E6DB74;">(</span>setq js2-basic-offset <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> <span style="color: #F92672;">(</span>= js2-basic-offset <span style="color: #AE81FF;">2</span><span style="color: #F92672;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>

  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">if</span> <span style="color: #A6E22E;">(</span>eq major-mode 'web-mode<span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span><span style="color: #F92672;">progn</span> <span style="color: #E6DB74;">(</span>setq web-mode-markup-indent-offset <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> <span style="color: #F92672;">(</span>= web-mode-markup-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #F92672;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
             <span style="color: #E6DB74;">(</span>setq web-mode-css-indent-offset <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> <span style="color: #F92672;">(</span>= web-mode-css-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #F92672;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
             <span style="color: #E6DB74;">(</span>setq web-mode-code-indent-offset <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> <span style="color: #F92672;">(</span>= web-mode-code-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #F92672;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">if</span> <span style="color: #A6E22E;">(</span>eq major-mode 'css-mode<span style="color: #A6E22E;">)</span>
      <span style="color: #A6E22E;">(</span>setq css-indent-offset <span style="color: #E6DB74;">(</span><span style="color: #F92672;">if</span> <span style="color: #FD971F;">(</span>= css-indent-offset <span style="color: #AE81FF;">2</span><span style="color: #FD971F;">)</span> <span style="color: #AE81FF;">4</span> <span style="color: #AE81FF;">2</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>

  <span style="color: #66D9EF;">(</span>setq indent-tabs-mode nil<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-c t i"</span><span style="color: #66D9EF;">)</span> 'my-toggle-web-indent<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline56" class="outline-3">
<h3 id="orgheadline56"><span class="section-number-3">9.2</span> js2-refactor</h3>
<div class="outline-text-3" id="text-9-2">
<p>
js2-refactor 是一个用于重构 JavaScript 的插件，它是一个 Minor Mode，你可以在
<a href="https://github.com/magnars/js2-refactor.el">GitHub</a> 找到更多关于这个插件的信息。
</p>

<p>
我们使用刚刚所提到的方法来安装 js2-refactor 插件。
</p>

<p>
在安装完成后，添加一个钩子（Hook）：
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'js2-mode-hook #'js2-refactor-mode<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>js2r-add-keybindings-with-prefix <span style="color: #E6DB74;">"C-c C-m"</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
我们可以使用 <code>C-c C-m</code> 然后输入功能前缀，例如 <code>em</code> 是 extract-method 的前缀。更
多的功能和使用方法也可以在上面给出的链接中找到，所有的前缀也可以在<a href="https://github.com/magnars/js2-refactor.el#refactorings">这里</a>找到。
</p>
</div>
</div>

<div id="outline-container-orgheadline57" class="outline-3">
<h3 id="orgheadline57"><span class="section-number-3">9.3</span> 优化 occur 与 imenu</h3>
<div class="outline-text-3" id="text-9-3">
<p>
下面的代码用于配置 Occur Mode 使其默认搜索当前被选中的或者在光标下的字符串：
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">occur-dwim</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #75715E;">"Call `</span><span style="color: #AE81FF;">occur</span><span style="color: #75715E;">' with a sane default."</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>push <span style="color: #A6E22E;">(</span><span style="color: #F92672;">if</span> <span style="color: #E6DB74;">(</span>region-active-p<span style="color: #E6DB74;">)</span>
            <span style="color: #E6DB74;">(</span>buffer-substring-no-properties
             <span style="color: #FD971F;">(</span>region-beginning<span style="color: #FD971F;">)</span>
             <span style="color: #FD971F;">(</span>region-end<span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
          <span style="color: #E6DB74;">(</span><span style="color: #F92672;">let</span> <span style="color: #FD971F;">(</span><span style="color: #F92672;">(</span>sym <span style="color: #AE81FF;">(</span>thing-at-point 'symbol<span style="color: #AE81FF;">)</span><span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span>
            <span style="color: #FD971F;">(</span><span style="color: #F92672;">when</span> <span style="color: #F92672;">(</span>stringp sym<span style="color: #F92672;">)</span>
              <span style="color: #F92672;">(</span>regexp-quote sym<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
        regexp-history<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>call-interactively 'occur<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"M-s o"</span><span style="color: #66D9EF;">)</span> 'occur-dwim<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
<code>dwim</code> 是按我说的做的缩写（Do what I mean）。
</p>

<p>
Occur 可以用于显示变量或函数的定义，我们可以通过 popwin 的 customize-group 将定
义显示设置为右边而不是默认的底部（ <code>customize-group &gt; popwin &gt; Popup Window
Position</code> 设置为 right），也可以在这里对其宽度进行调节。
</p>

<p>
Occur 与普通的搜索模式不同的是，它可以使用 Occur-Edit Mode (在弹出的窗口中按 <code>e</code>
进入编辑模式) 对搜索到的结果进行之间的编辑。
</p>

<p>
imenu 可以显示当前所有缓冲区的列表，下面的配置可以让其拥有更精确的跳转，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">js2-imenu-make-index</span> <span style="color: #66D9EF;">()</span>
      <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
      <span style="color: #66D9EF;">(</span><span style="color: #F92672;">save-excursion</span>
        <span style="color: #75715E;">;; </span><span style="color: #75715E;">(setq imenu-generic-expression '((nil "describe\\(\"\\(.+\\)\"" 1)))</span>
        <span style="color: #A6E22E;">(</span>imenu--generic-function '<span style="color: #E6DB74;">(</span><span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"describe"</span> <span style="color: #E6DB74;">"\\s-*describe\\s-*(\\s-*[\"']</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[\"']\\s-*,.*"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"it"</span> <span style="color: #E6DB74;">"\\s-*it\\s-*(\\s-*[\"']</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[\"']\\s-*,.*"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"test"</span> <span style="color: #E6DB74;">"\\s-*test\\s-*(\\s-*[\"']</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[\"']\\s-*,.*"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"before"</span> <span style="color: #E6DB74;">"\\s-*before\\s-*(\\s-*[\"']</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[\"']\\s-*,.*"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"after"</span> <span style="color: #E6DB74;">"\\s-*after\\s-*(\\s-*[\"']</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">.+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[\"']\\s-*,.*"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Function"</span> <span style="color: #E6DB74;">"function[ \t]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[a-zA-Z0-9_$.]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[ \t]*("</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Function"</span> <span style="color: #E6DB74;">"^[ \t]*</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[a-zA-Z0-9_$.]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[ \t]*=[ \t]*function[ \t]*("</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Function"</span> <span style="color: #E6DB74;">"^var[ \t]*</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[a-zA-Z0-9_$.]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[ \t]*=[ \t]*function[ \t]*("</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Function"</span> <span style="color: #E6DB74;">"^[ \t]*</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[a-zA-Z0-9_$.]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[ \t]*()[ \t]*{"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Function"</span> <span style="color: #E6DB74;">"^[ \t]*</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[a-zA-Z0-9_$.]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">[ \t]*:[ \t]*function[ \t]*("</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span>
                                   <span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"Task"</span> <span style="color: #E6DB74;">"[. \t]task([ \t]*['\"]</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">(</span><span style="color: #E6DB74;">[</span><span style="color: #E6DB74; font-weight: bold;">^</span><span style="color: #E6DB74;">'\"]+</span><span style="color: #AE81FF;">\\</span><span style="color: #E6DB74;">)</span><span style="color: #E6DB74;">"</span> <span style="color: #AE81FF;">1</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>add-hook 'js2-mode-hook
              <span style="color: #66D9EF;">(</span><span style="color: #F92672;">lambda</span> <span style="color: #A6E22E;">()</span>
                <span style="color: #A6E22E;">(</span>setq imenu-create-index-function 'js2-imenu-make-index<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"M-s i"</span><span style="color: #66D9EF;">)</span> 'counsel-imenu<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline58" class="outline-3">
<h3 id="orgheadline58"><span class="section-number-3">9.4</span> expand-region</h3>
<div class="outline-text-3" id="text-9-4">
<p>
使用同样的方法将 expand-region 添加至我们的插件列表中，重启 Emacs 安装插件。
</p>

<p>
再为其绑定一个快捷键，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-="</span><span style="color: #66D9EF;">)</span> 'er/expand-region<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用这个插件可以使我们更方便的选中一个区域。（更多使用方法和文档可以在<a href="https://github.com/magnars/expand-region.el">这里</a>找到）
</p>
</div>
</div>

<div id="outline-container-orgheadline59" class="outline-3">
<h3 id="orgheadline59"><span class="section-number-3">9.5</span> iedit</h3>
<div class="outline-text-3" id="text-9-5">
<p>
iedit 是一个可以同时编辑多个区域的插件，它类似 Sublime Text 中的多光标编辑。它的 GitHub 仓库在<a href="https://github.com/victorhge/iedit">这里</a>。
</p>

<p>
我们将其绑定快捷键以便更快捷的使用这个模式（ <code>C-;</code> 为默认快捷键），
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"M-s e"</span><span style="color: #66D9EF;">)</span> 'iedit-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
我们可以使用 Customized-group 来更改其高亮的背景色，将 <code>highlight</code> 改为 <code>region</code> 。
</p>
</div>
</div>

<div id="outline-container-orgheadline60" class="outline-3">
<h3 id="orgheadline60"><span class="section-number-3">9.6</span> Org 导出</h3>
<div class="outline-text-3" id="text-9-6">
<p>
使用 <code>C-c C-e</code> 可以将 Org-mode 文档导出为你需要的格式，例如 HTML 或者 PDF 文件。
你现在看到的这本教程就是由 Org-mode 所导出生成的。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline68" class="outline-2">
<h2 id="orgheadline68"><span class="section-number-2">10</span> 第六天：代码片段与语法检查器</h2>
<div class="outline-text-2" id="text-10">
<p>
在开始前我们需要注意的是之前模块化的配置文件 <code>init-keybindings.el</code> 应该放在所有
调用模块的最后面，因为也许在设置快捷键时某些函数还未被加载。
</p>

<p>
我们可以使用下面的配置来在 Company-mode 中使用 <code>C-n</code> 与 <code>C-p</code> 来选择补全项，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">with-eval-after-load</span> 'company
  <span style="color: #66D9EF;">(</span>define-key company-active-map <span style="color: #A6E22E;">(</span>kbd <span style="color: #E6DB74;">"M-n"</span><span style="color: #A6E22E;">)</span> nil<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>define-key company-active-map <span style="color: #A6E22E;">(</span>kbd <span style="color: #E6DB74;">"M-p"</span><span style="color: #A6E22E;">)</span> nil<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>define-key company-active-map <span style="color: #A6E22E;">(</span>kbd <span style="color: #E6DB74;">"C-n"</span><span style="color: #A6E22E;">)</span> #'company-select-next<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>define-key company-active-map <span style="color: #A6E22E;">(</span>kbd <span style="color: #E6DB74;">"C-p"</span><span style="color: #A6E22E;">)</span> #'company-select-previous<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>

<div id="outline-container-orgheadline62" class="outline-3">
<h3 id="orgheadline62"><span class="section-number-3">10.1</span> Org-mode 进阶使用</h3>
<div class="outline-text-3" id="text-10-1">
<p>
在学习代码片段和语法检查器（Linter）之前，我们先来学习一下如何使用 Org-mode 来做
学习笔记和安排工作时间。我们用下面的配置代码来设置一个模板（其中设置了待办事项的
优先级还有触发键），
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq org-capture-templates
      '<span style="color: #66D9EF;">(</span><span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"t"</span> <span style="color: #E6DB74;">"Todo"</span> entry <span style="color: #E6DB74;">(</span>file+headline <span style="color: #E6DB74;">"~/.emacs.d/gtd.org"</span> <span style="color: #E6DB74;">"&#24037;&#20316;&#23433;&#25490;"</span><span style="color: #E6DB74;">)</span>
         <span style="color: #E6DB74;">"* </span><span style="color: #cc9393;">TODO</span><span style="color: #E6DB74;"> [#B] %?\n  %i\n"</span>
         <span style="color: #F92672;">:empty-lines</span> <span style="color: #AE81FF;">1</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
我们也可以为其绑定一个快捷键，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-c r"</span><span style="color: #66D9EF;">)</span> 'org-capture<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
这个功能除了可以记录待办事项还有其他许许多多的功能例如获取将当前浏览器中的
URL（下面的例子只在 Mac OS X 平台有效）。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">YOUR_NAME/retrieve-chrome-current-tab-url</span><span style="color: #66D9EF;">()</span>
  <span style="color: #75715E;">"Get the URL of the active tab of the first window"</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
      <span style="color: #66D9EF;">(</span><span style="color: #F92672;">let</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>result <span style="color: #FD971F;">(</span>do-applescript
                     <span style="color: #F92672;">(</span>concat
                      <span style="color: #E6DB74;">"set frontmostApplication to path to frontmost application\n"</span>
                      <span style="color: #E6DB74;">"tell application \"Google Chrome\"\n"</span>
                      <span style="color: #E6DB74;">" set theUrl to get URL of active tab of first window\n"</span>
                      <span style="color: #E6DB74;">" set theResult to (get theUrl) \n"</span>
                      <span style="color: #E6DB74;">"end tell\n"</span>
                      <span style="color: #E6DB74;">"activate application (frontmostApplication as text)\n"</span>
                      <span style="color: #E6DB74;">"set links to {}\n"</span>
                      <span style="color: #E6DB74;">"copy theResult to the end of links\n"</span>
                      <span style="color: #E6DB74;">"return links as string\n"</span><span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
        <span style="color: #A6E22E;">(</span>format <span style="color: #E6DB74;">"%s"</span> <span style="color: #E6DB74;">(</span>s-chop-suffix <span style="color: #E6DB74;">"\""</span> <span style="color: #FD971F;">(</span>s-chop-prefix <span style="color: #E6DB74;">"\""</span> result<span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
更多有关 Org-capture 的内容可以在<a href="http://orgmode.org/manual/Capture.html">这里</a>找到。
</p>

<p>
Org-pomodoro 是一个番茄时间工作法的插件（更多关于这个工作法的信息可以在<a href="https://en.wikipedia.org/wiki/Pomodoro_Technique">这里</a>找到）。
它的 GitHub 地址在<a href="https://github.com/lolownia/org-pomodoro">这里</a>。在 <code>(require 'org-pomodoro)</code> 后可以通过 Customize-group
来对其进行设置，包括不同休息种类的时长。
</p>

<p>
因为每次保存中文的时候都需要选择解码，我们可以使用下面的配置将文本解码设置默认为 UTF-8，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>set-language-environment <span style="color: #E6DB74;">"UTF-8"</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
当 org-mode 不能生效时，我们需要将与 Org 相关的配置放置于 <code>with-eval-after-load</code> 中，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">with-eval-after-load</span> 'org
  <span style="color: #75715E;">;; </span><span style="color: #75715E;">Org &#27169;&#24335;&#30456;&#20851;&#35774;&#23450;</span>
  <span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline63" class="outline-3">
<h3 id="orgheadline63"><span class="section-number-3">10.2</span> 批量修改文件名</h3>
<div class="outline-text-3" id="text-10-2">
<p>
<code>C-x C-q</code> 就可以直接在 Dired Mode 中进行编辑，使用之前学的 iedit-mode 和区域选择
就可以直接对多个文件进行重命名编辑了。
</p>
</div>
</div>

<div id="outline-container-orgheadline64" class="outline-3">
<h3 id="orgheadline64"><span class="section-number-3">10.3</span> 搜索与替换</h3>
<div class="outline-text-3" id="text-10-3">
<p>
全局搜索在我们的编辑工作中是不可缺少的，今天我们介绍的是 ag。它是非常快速的命令
行搜索工具，它是 Linux 的所有搜索工具中最快的。
</p>

<pre class="example">
ag &gt; pt &gt; ack &gt; grep
</pre>

<p>
在使用 ag 前我们需要进行安装，下面是 Mac OS X 与 Ubuntu 下的安装方法，
</p>

<pre class="example">
# Mac OS X 通过 Homebrew 安装
brew install the_silver_searcher

# Ubuntu 下安装
apt-get install silversearcher-ag

# Windows 下通过 msys2 安装（确保在 path 中）
pacman -S mingw-w64-i686-ag # 32 位电脑
pacman -S mingw-w64-x86_64-ag # 64 位电脑
</pre>

<p>
安装好 ag 后我们就可以安装 helm-ag 插件了。（它的 GitHub 仓库地址在<a href="https://github.com/syohex/emacs-helm-ag">这里</a>）在安装
完成后可以为其设置快捷键，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-c p s"</span><span style="color: #66D9EF;">)</span> 'helm-do-ag-project-root<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用这个插件我们同样可以在缓冲区对搜索到的结果进行直接的修改，这样就可以做到快速
的搜索与替换。
</p>
</div>
</div>

<div id="outline-container-orgheadline65" class="outline-3">
<h3 id="orgheadline65"><span class="section-number-3">10.4</span> 语法检查器（Linter）</h3>
<div class="outline-text-3" id="text-10-4">
<p>
语法检查器可以在开发动态语言（Interpreted/Dynamic Programming Language）时极大的
提高你的开发效率，它会实时的检查你的代码并将句法错误（Syntax Error）与静态语义
（Static Semantic Error）错误进行高亮与提示。
</p>

<p>
我们在这里使用的例子是 JavaScript 的语法检查器 eslint 它的安装方法可以在<a href="https://github.com/eslint/eslint">这里</a>找到。
</p>

<p>
在安装好语法检查器后就可以安装 flycheck 的插件了，它的 GitHub 的地址在<a href="https://github.com/flycheck/flycheck">这里</a>。
</p>

<p>
使用下面的代码可以将 flycheck-mode 在特定模式下激活（下面的例子就是只有在打开
JavaScript 时才会激活语法检查器），
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'js2-mode-hook 'flycheck-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用 <code>flycheck-verify-setup</code> 可以进行语法检查器的选择。
</p>

<p>
eslint 检查器的配置也可以使用项目目录下的 <code>.eslintrc</code> 来进行配置，更多配置方法可
以在<a href="http://eslint.org/docs/user-guide/configuring">这里</a>找到。
</p>
</div>
</div>

<div id="outline-container-orgheadline67" class="outline-3">
<h3 id="orgheadline67"><span class="section-number-3">10.5</span> 代码块</h3>
<div class="outline-text-3" id="text-10-5">
<p>
<code>yasnippet</code> 是一个代码块补全的插件（<a href="https://github.com/capitaomorte/yasnippet">GitHub</a> 地址）。使用下面的配置文件将其在所有
的编程语言的模式中激活。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>yas-reload-all<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>add-hook 'prog-mode-hook #'yas-minor-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
自定义代码块的方法可以在上面提供的链接中找到。
</p>
</div>

<div id="outline-container-orgheadline66" class="outline-4">
<h4 id="orgheadline66"><span class="section-number-4">10.5.1</span> auto-yasnippet</h4>
<div class="outline-text-4" id="text-10-5-1">
<p>
<a href="https://github.com/abo-abo/auto-yasnippet">auto-yasnippet</a> 也是一个非常好用代码块补全插件。安装并未其设置快捷键，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"H-w"</span><span style="color: #66D9EF;">)</span> #'aya-create<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"H-y"</span><span style="color: #66D9EF;">)</span> #'aya-expand<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
简单的使用方法就是使用 <code>~</code> 来定义模板，然后调用 <code>aya-create</code> 再使用 <code>aya-expand</code> 来使用模板。
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline77" class="outline-2">
<h2 id="orgheadline77"><span class="section-number-2">11</span> 第七天：Evil 模式</h2>
<div class="outline-text-2" id="text-11">
<p>
开始之前我们先将 <code>C-w</code> 来使其可以向后删除一个单词，这样就可以与 Shell 中的快捷键操作同步。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"C-w"</span><span style="color: #66D9EF;">)</span> 'backward-kill-word<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
如果你不是 Vim 的用户，你可以选择跳过这一天的内容。但是我们强烈建议你花一些时间
来学习基本的 Vim 操作，即使 Emacs 是你的最爱 Vim 的快捷键也在一定程度会增加你的
编辑效率。基础的 Vim 操作可以在<a href="http://www.openvim.com/">这里</a>学会。
</p>

<p>
Evil 模式中的 State 就相当与 Vim 中的模式，常用的模式有下面几种（后面对于了相应
的 Emacs 中的 State），
</p>

<ul class="org-ul">
<li>Normal Mode -&gt; Normal State</li>
<li>Insert Mode -&gt; Insert State</li>
<li>Visual Mode -&gt; Visual State</li>
<li>Motion Mode -&gt; Motion State</li>
</ul>

<p>
还有一个 Emacs 中的特殊状态是 Emacs State。
</p>
</div>

<div id="outline-container-orgheadline69" class="outline-3">
<h3 id="orgheadline69"><span class="section-number-3">11.1</span> Evil 的安装</h3>
<div class="outline-text-3" id="text-11-1">
<p>
照例我们需要将 Evil 插件添加至我们的插件列表中来完成安装。在重启 Emacs 完成安装
后可以添加下面的代码将其激活。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>evil-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在激活 Evil 模式后就可以，在 Emacs 中使用 Vim 的快捷键了。有一点需要注意 <code>C-u</code>
在 Emacs 中有特殊的功所（Universal args）以能我们可以通过使用 <code>customize-group</code>
来对 Evil 模式进行修改，将 <code>Evil Want C U Scroll</code> 设置为开启。
</p>

<p>
下面的代码可以将 <code>insert state map</code> 中的快捷键清空，使其可以回退（Fallback）到
Emacs State 中，这样我们之前的 Emacs State 里面定义的 <code>C-w</code> 等快捷键就不会被
<code>evil insert minor mode state</code> 所覆盖，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setcdr evil-insert-state-map nil<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>define-key evil-insert-state-map <span style="color: #66D9EF;">[</span>escape<span style="color: #66D9EF;">]</span> 'evil-normal-state<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
这样你就可以使用 Evil 来在 Emacs 中完成百分之八十作用的快捷键操作了。
</p>

<p>
完整的 Evil Mode 的 PDF 版本的操作指南可以在<a href="https://bytebucket.org/lyro/evil/raw/default/doc/evil.pdf">这里</a>找到，建议从 Vim 转 Emacs 的用户
多次阅读来完整的掌握这个模式的使用方法。
</p>
</div>
</div>

<div id="outline-container-orgheadline75" class="outline-3">
<h3 id="orgheadline75"><span class="section-number-3">11.2</span> Evil 模式插件</h3>
<div class="outline-text-3" id="text-11-2">
</div><div id="outline-container-orgheadline70" class="outline-4">
<h4 id="orgheadline70"><span class="section-number-4">11.2.1</span> Leader Key</h4>
<div class="outline-text-4" id="text-11-2-1">
<p>
在 Emacs 中使用 Leader Key 可以通过 <a href="https://github.com/cofi/evil-leader">evil-leader</a> 来实现。你需要做的就是在安装后将其激活即可。
</p>

<p>
<b>提示</b>: 根据<a href="https://github.com/cofi/evil-leader">cofi/evil-leader</a> 的说明，你应该在激活 evil-mode 之前就激活 global-evil-leader-mode，否则 evil-leader 在几个初始缓冲区(scratch, Message,&#x2026;)上将不生效。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>global-evil-leader-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>


<p>
Leader Key 可以通过 customize-group 来进行设置（Evil Leader/Leader）。因为之后我
们会转移至 Spacemacs 所以我们可以将其设置为空格键 <code>SPC</code> 。
</p>

<p>
在通过下面的配置来设置简单的结合 Leader Key 快捷键组合（我们使用不同的键讲不同的
功能分组，例如我们使用 <code>f</code> 键来做关于文件的操作，使用 <code>b</code> 键来做关于缓冲区
（Buffer）的操作），
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>evil-leader/set-key
  <span style="color: #E6DB74;">"ff"</span> 'find-file
  <span style="color: #E6DB74;">"bb"</span> 'switch-to-buffer
  <span style="color: #E6DB74;">"0"</span>  'select-window-0
  <span style="color: #E6DB74;">"1"</span>  'select-window-1
  <span style="color: #E6DB74;">"2"</span>  'select-window-2
  <span style="color: #E6DB74;">"3"</span>  'select-window-3
  <span style="color: #E6DB74;">"w/"</span> 'split-window-right
  <span style="color: #E6DB74;">"w-"</span> 'split-window-below
  <span style="color: #E6DB74;">":"</span>  'counsel-M-x
  <span style="color: #E6DB74;">"wM"</span> 'delete-other-windows
  <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
注意上面窗口跳转相关的设置需要 window-numbering 安装后方可生效。
</p>
</div>
</div>

<div id="outline-container-orgheadline71" class="outline-4">
<h4 id="orgheadline71"><span class="section-number-4">11.2.2</span> Window-numbering</h4>
<div class="outline-text-4" id="text-11-2-2">
<p>
这个插件可以让我们快速的使用 Leader Key 与数字键的组合来在多个窗口之间进行跳转。
它的 GitHub 地址可以在<a href="https://github.com/nschum/window-numbering.el">这里</a>找到。
</p>

<p>
下载安装后通过下面的代码可以将其激活，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>window-numbering-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline72" class="outline-4">
<h4 id="orgheadline72"><span class="section-number-4">11.2.3</span> Evil-Surround</h4>
<div class="outline-text-4" id="text-11-2-3">
<p>
<a href="https://github.com/timcharper/evil-surround">Evil-surround</a> 是一个 Vim 上非常常用的插件改写的，使用它可以快速的将选中区域进行
匹配的操作，例如选中区域两边同时进行添加或修改括号，引号等操作。
</p>

<p>
下载安装后使用下面的代码将其激活，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">evil-surround</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>global-evil-surround-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
简单的使用方法就是在选中所选区域后，使用 <code>S(</code> 来将选中区域包括在括号之中。如果想
将括号改变成 ="= 可以在选中后使用 =cs("=
</p>
</div>
</div>


<div id="outline-container-orgheadline73" class="outline-4">
<h4 id="orgheadline73"><span class="section-number-4">11.2.4</span> Evil-nerd-commenter</h4>
<div class="outline-text-4" id="text-11-2-4">
<p>
这是一个快速添加与取消注释的插件，它的 GitHub 地址在<a href="https://github.com/redguardtoo/evil-nerd-commenter">这里</a>。
</p>

<p>
使用下面代码可以将其激活，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>evilnc-default-hotkeys<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用下面的代码将其与 Evil 模式进行绑定，这里我们选择使用 =,/= 作为快捷键。
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>define-key evil-normal-state-map <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">",/"</span><span style="color: #66D9EF;">)</span> 'evilnc-comment-or-uncomment-lines<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>define-key evil-visual-state-map <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">",/"</span><span style="color: #66D9EF;">)</span> 'evilnc-comment-or-uncomment-lines<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline74" class="outline-4">
<h4 id="orgheadline74"><span class="section-number-4">11.2.5</span> Which-key</h4>
<div class="outline-text-4" id="text-11-2-5">
<p>
<a href="https://github.com/justbur/emacs-which-key">which-key</a> 可以显示当前组合键下所有可以使用的全部组合键的选项。使用这个插件可以很
好的解决快捷键太多的问题，我们无需在记忆任何快捷键，而是根据自己的需求使用不同分
组的快捷键后再在其中去需找自己需要的功能。
</p>

<p>
在下载后可以使用下面的代码进行激活，
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>which-key-mode <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline76" class="outline-3">
<h3 id="orgheadline76"><span class="section-number-3">11.3</span> Org Mode 中的搜索</h3>
<div class="outline-text-3" id="text-11-3">
<p>
<code>C-c a</code> 中可以根据提示使用 <code>s</code> 来进行关键字所搜。使用 <code>t</code> 则可以进行代办事项的搜索。
</p>
</div>
</div>
</div>




<div id="outline-container-orgheadline83" class="outline-2">
<h2 id="orgheadline83"><span class="section-number-2">12</span> 第八天：Cask 介绍与实践</h2>
<div class="outline-text-2" id="text-12">
<p>
什么是 Cask:
</p>

<p>
Cask 是一个 Emacs Lisp 的项目管理工具.
</p>
</div>

<div id="outline-container-orgheadline78" class="outline-3">
<h3 id="orgheadline78"><span class="section-number-3">12.1</span> Cask 的安装</h3>
<div class="outline-text-3" id="text-12-1">
<p>
Cask 的地址: <a href="https://github.com/cask/cask">Cask</a>
</p>

<p>
可以使用如下命令安装 Cask:
</p>

<div class="org-src-container">

<pre class="src src-shell">curl -fsSL https://raw.githubusercontent.com/cask/cask/master/go | python
</pre>
</div>

<p>
安装过程中 Cask 将会进行 Bootstrap, 安装一些包到~/.emacs.d 目录中.
</p>

<p>
安装完成之后需要将 Cask 的可执行文件目录加入到 PATH 中.
</p>

<p>
可以看到, Cask 的安装过程在 ~/.emacs.d 中新建了一个 .Cask 目录.
</p>

<p>
安装 Pallet: Pallet 是一个基于 Cask 的包管理工具, 可以使用 Emacs 的包安装方式安装.
</p>

<p>
然后使用以下代码启用 Pallet:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>pallet-mode<span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>pallet-init<span style="color: #AE81FF;">)</span>    <span style="color: #75715E;">; </span><span style="color: #75715E;">&#22312;.emacs.d &#20013;&#29983;&#25104;&#19968;&#20010; Cask &#25991;&#20214;, &#20889;&#20837;&#28304;&#19982;&#29616;&#26377;&#21253;</span>
<span style="color: #AE81FF;">(</span>pallet-install<span style="color: #AE81FF;">)</span> <span style="color: #75715E;">; </span><span style="color: #75715E;">&#23558; elpa &#20013;&#30340; package &#25335;&#36125;&#21040;.Cask/&lt;you version&gt;/elpa &#30446;&#24405;&#20013;</span>
</pre>
</div>

<p>
然后在配置文件中加入以下代码(在其他包加载之前) :
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">cask</span> <span style="color: #E6DB74;">"&lt;path-to-cask&gt;/cask.el"</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>cask-initialize<span style="color: #AE81FF;">)</span>    <span style="color: #75715E;">; </span><span style="color: #75715E;">&#31867;&#20284;&#20110; package-initialize</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">pallet</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>pallet-mode t<span style="color: #AE81FF;">)</span>      <span style="color: #75715E;">; </span><span style="color: #75715E;">&#28608;&#27963; pallet, &#22312;&#23433;&#35013;&#21253;&#26102;&#23558; Cask &#25991;&#20214;&#20889;&#20837;&#30456;&#24212;&#20449;&#24687;</span>
</pre>
</div>

<p>
具体使用方式见文档: <a href="https://github.com/rdallasgray/pallet">Pallet</a>
</p>
</div>
</div>

<div id="outline-container-orgheadline79" class="outline-3">
<h3 id="orgheadline79"><span class="section-number-3">12.2</span> 为何使用 Cask</h3>
<div class="outline-text-3" id="text-12-2">
<ul class="org-ul">
<li>使用 Cask 文件保存包的信息, 可以通过 <b>Cask install</b> 自动安装</li>
<li>当有多个版本的 Emacs 时, 将各版本的包单独存放</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline82" class="outline-3">
<h3 id="orgheadline82"><span class="section-number-3">12.3</span> 故障排除</h3>
<div class="outline-text-3" id="text-12-3">
</div><div id="outline-container-orgheadline80" class="outline-4">
<h4 id="orgheadline80"><span class="section-number-4">12.3.1</span> Emacs24.5 时不能安装 <b>let-alist</b></h4>
<div class="outline-text-4" id="text-12-3-1">
<p>
解决方案: 将 Gnu 的源加入源列表中, 示例代码如下(加入 Cask 文件)
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>source <span style="color: #E6DB74;">"gnu"</span> <span style="color: #E6DB74;">"http://elpa.zilongshanren.com/gnu/"</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline81" class="outline-4">
<h4 id="orgheadline81"><span class="section-number-4">12.3.2</span> 在 Emacs24.5 中没有定义 define-advice</h4>
<div class="outline-text-4" id="text-12-3-2">
<p>
define-advice 是一个 Emacs25 中加入的宏, 在 Emacs24 中不能使用, 可以使用
<b>defadvice</b> 代替:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defadvice</span> <span style="color: #A6E22E;">show-paren-function</span> <span style="color: #66D9EF;">(</span>around fix-show-paren-function activate<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">cond</span> <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">(</span>looking-at-p <span style="color: #E6DB74;">"\\s("</span><span style="color: #E6DB74;">)</span> ad-do-it<span style="color: #A6E22E;">)</span>
  <span style="color: #A6E22E;">(</span>t <span style="color: #E6DB74;">(</span><span style="color: #F92672;">save-excursion</span>
       <span style="color: #FD971F;">(</span><span style="color: #F92672;">ignore-errors</span> <span style="color: #F92672;">(</span>backward-up-list<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span>
       ad-do-it<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
而且使用 defadvice 相比 define-advice 还有一个优点:
</p>

<p>
使用 define-advice 定义的代码, 当在 Normal 模式时光标两边的括号不会高亮, 而使用
defadvice 可以.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline96" class="outline-2">
<h2 id="orgheadline96"><span class="section-number-2">13</span> 第九天：Macro 与 Use-package</h2>
<div class="outline-text-2" id="text-13">
<p>
这次主要介绍 Emacs Lisp 中的宏(Macro)以及 Use-package 插件.
</p>
</div>

<div id="outline-container-orgheadline87" class="outline-3">
<h3 id="orgheadline87"><span class="section-number-3">13.1</span> Macro</h3>
<div class="outline-text-3" id="text-13-1">
</div><div id="outline-container-orgheadline84" class="outline-4">
<h4 id="orgheadline84"><span class="section-number-4">13.1.1</span> 什么是 Macro</h4>
<div class="outline-text-4" id="text-13-1-1">
<p>
宏是一种可以生成代码的代码. 类比与 C 语言中的宏以及 C++中的模板. 先看一个简单的例子:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defmacro</span> <span style="color: #A6E22E;">inc</span> <span style="color: #66D9EF;">(</span>var<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>list 'setq var <span style="color: #A6E22E;">(</span>list '1+ var<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>setq my-var <span style="color: #AE81FF;">1</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>setq my-var <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> my-var<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>macroexpand '<span style="color: #66D9EF;">(</span>inc my-var<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
以上这个宏的作用是将变量的值+1. 执行以上代码之后, <b>my-var</b> 的结果为 2.
</p>

<p>
可以使用 macroexpand 获得宏展开的结果, 如以上代码结果为:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq my-var <span style="color: #66D9EF;">(</span>1+ my-var<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
我们也可以使用函数来实现相同的功能, 但 Macro 与函数有以下两个区别:
</p>

<ol class="org-ol">
<li>宏的参数并不会被马上求值, 解释器会先展开宏, 宏展开之后解释器才会执行宏展开的
结果; 而函数的参数会马上求值</li>
<li>宏的执行结果是一个表达式, 该表达式会立即被解释器执行; 而函数的结果是一个值</li>
</ol>
</div>
</div>

<div id="outline-container-orgheadline85" class="outline-4">
<h4 id="orgheadline85"><span class="section-number-4">13.1.2</span> backquote</h4>
<div class="outline-text-4" id="text-13-1-2">
<p>
backquote 是指反引号(`), 即键盘上数字 1 左边的键.
</p>

<p>
当在 Emacs 输入 backquote 时会插入两个反引号, 可以使用以下代码关闭这个功能:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>sp-local-pair 'emacs-lisp-mode <span style="color: #E6DB74;">"`"</span> nil <span style="color: #F92672;">:actions</span> nil<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
先看以下例子来体会 backquote 的作用:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">my-print</span> <span style="color: #66D9EF;">(</span>number<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"This is a number: %d"</span> number<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>my-print <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>               <span style="color: #75715E;">; </span><span style="color: #75715E;">1. output= This is a number: 2</span>
<span style="color: #AE81FF;">(</span>my-print <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>         <span style="color: #75715E;">; </span><span style="color: #75715E;">2. output= This is a number: 5</span>

<span style="color: #AE81FF;">(</span>quote <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">return a list= (+ 1 1)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defmacro</span> <span style="color: #A6E22E;">my-print-2</span> <span style="color: #66D9EF;">(</span>number<span style="color: #66D9EF;">)</span>
  `<span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"This is a number: %d"</span> ,number<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>my-print-2 <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>             <span style="color: #75715E;">; </span><span style="color: #75715E;">3. output= This is a number: 2</span>
<span style="color: #AE81FF;">(</span>my-print-2 <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>       <span style="color: #75715E;">; </span><span style="color: #75715E;">4. output= This is a number: 5</span>

<span style="color: #AE81FF;">(</span>setq my-var <span style="color: #AE81FF;">2</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>inc my-var<span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defmacro</span> <span style="color: #A6E22E;">inc2</span> <span style="color: #66D9EF;">(</span>var1 var2<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>list 'progn <span style="color: #A6E22E;">(</span>list 'inc var1<span style="color: #A6E22E;">)</span> <span style="color: #A6E22E;">(</span>list 'inc var2<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>macroexpand '<span style="color: #66D9EF;">(</span>inc2 my-var my-var<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>macroexpand-all '<span style="color: #66D9EF;">(</span>inc2 my-var my-var<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
quote 的作用是返回后面的表达式, 不对表达式进行求值. 所以以下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>quote <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">1</span> <span style="color: #AE81FF;">1</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">return a list= (+ 1 1)</span>
</pre>
</div>

<p>
并没有对表达式 <b>(+ 1 1)</b> 进行求值返回 2, 而是返回一个 list.
</p>

<p>
backquote 的作用与 quote 相似, 同样不对后面的表达式求值, 但是当 backquote 在宏中
与逗号(,)一起使用时, 用逗号修饰的变量将进行求值.
</p>

<p>
例如以下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defmacro</span> <span style="color: #A6E22E;">my-print-2</span> <span style="color: #66D9EF;">(</span>number<span style="color: #66D9EF;">)</span>
  `<span style="color: #66D9EF;">(</span>message <span style="color: #E6DB74;">"This is a number: %d"</span> ,number<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span>pp <span style="color: #66D9EF;">(</span>macroexpand '<span style="color: #A6E22E;">(</span>my-print-2 <span style="color: #E6DB74;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">3</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>my-print-2 <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
当输出 message 且 number 不带逗号时, <b>my-print-2</b> 的执行将提示错误. 因为宏不对参
数进行求值, 所以以上宏展开相当于:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>message <span style="color: #E6DB74;">"This is a number:"</span> number<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
因为我们没有定义 number 变量, 所以执行出错.
</p>

<p>
而如果加入逗号, 则在宏展开时会对变量 <b>number</b> 进行求值, 展开结果为:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>message <span style="color: #E6DB74;">"This is a number: %d"</span> <span style="color: #66D9EF;">(</span>+ <span style="color: #AE81FF;">2</span> <span style="color: #AE81FF;">3</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在调试宏的过程中, 可以使用 <b>macroexpand</b> 和 <b>macroexpand-all</b> 获取宏展开的结果.
</p>

<p>
关于 backquote 的更多讨论, 可以见以下地址: <a href="https://emacs-china.org/t/lisp/357">lisp 中的`与，是怎么用的？</a>
</p>
</div>
</div>

<div id="outline-container-orgheadline86" class="outline-4">
<h4 id="orgheadline86"><span class="section-number-4">13.1.3</span> 为什么使用宏</h4>
<div class="outline-text-4" id="text-13-1-3">
<p>
使用宏可以减少重复的代码, 以下是一个使用宏来定义函数的例子:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">prelude-search</span> <span style="color: #66D9EF;">(</span>query-url prompt<span style="color: #66D9EF;">)</span>
  <span style="color: #75715E;">"Open the search url constructed with the QUERY-URL.</span>
<span style="color: #75715E;">PROMPT sets the `read-string prompt."</span>
  <span style="color: #66D9EF;">(</span>browse-url
   <span style="color: #A6E22E;">(</span>concat query-url
           <span style="color: #E6DB74;">(</span>url-hexify-string
            <span style="color: #FD971F;">(</span><span style="color: #F92672;">if</span> mark-active
                <span style="color: #F92672;">(</span>buffer-substring <span style="color: #AE81FF;">(</span>region-beginning<span style="color: #AE81FF;">)</span> <span style="color: #AE81FF;">(</span>region-end<span style="color: #AE81FF;">)</span><span style="color: #F92672;">)</span>
              <span style="color: #F92672;">(</span>read-string prompt<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defmacro</span> <span style="color: #A6E22E;">prelude-install-search-engine</span> <span style="color: #66D9EF;">(</span>search-engine-name search-engine-url search-engine-prompt<span style="color: #66D9EF;">)</span>                   <span style="color: #75715E;">; </span><span style="color: #75715E;">#1</span>
  <span style="color: #75715E;">"Given some information regarding a search engine, install the interactive command to search through them"</span>
  `<span style="color: #66D9EF;">(</span><span style="color: #F92672;">defun</span> ,<span style="color: #A6E22E;">(</span>intern <span style="color: #E6DB74;">(</span>format <span style="color: #E6DB74;">"prelude-%s"</span> search-engine-name<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span> <span style="color: #A6E22E;">()</span>                                                       <span style="color: #75715E;">; </span><span style="color: #75715E;">#2</span>
       ,<span style="color: #A6E22E;">(</span>format <span style="color: #E6DB74;">"Search %s with a query or region if any."</span> search-engine-name<span style="color: #A6E22E;">)</span>                                        <span style="color: #75715E;">; </span><span style="color: #75715E;">#3</span>
       <span style="color: #A6E22E;">(</span>interactive<span style="color: #A6E22E;">)</span>
       <span style="color: #A6E22E;">(</span>prelude-search ,search-engine-url ,search-engine-prompt<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>                                                    <span style="color: #75715E;">; </span><span style="color: #75715E;">#4</span>

<span style="color: #AE81FF;">(</span>prelude-install-search-engine <span style="color: #E6DB74;">"google"</span>     <span style="color: #E6DB74;">"http://www.google.com/search?q="</span>              <span style="color: #E6DB74;">"Google: "</span><span style="color: #AE81FF;">)</span>                <span style="color: #75715E;">; </span><span style="color: #75715E;">#5</span>
<span style="color: #AE81FF;">(</span>prelude-install-search-engine <span style="color: #E6DB74;">"youtube"</span>    <span style="color: #E6DB74;">"http://www.youtube.com/results?search_query="</span> <span style="color: #E6DB74;">"Search YouTube: "</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>prelude-install-search-engine <span style="color: #E6DB74;">"github"</span>     <span style="color: #E6DB74;">"https://github.com/search?q="</span>                 <span style="color: #E6DB74;">"Search GitHub: "</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>prelude-install-search-engine <span style="color: #E6DB74;">"duckduckgo"</span> <span style="color: #E6DB74;">"https://duckduckgo.com/?t=lm&amp;q="</span>              <span style="color: #E6DB74;">"Search DuckDuckGo: "</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
下面对以上代码进行讲解:
</p>

<p>
第#1 行, 通过 <b>prelude-install-search-engine</b> 定义了一个需要 3 个参数的宏, 这个
宏的作用是生成一个函数.
</p>

<p>
第#2 行, 通过 <b>intern</b> 生成一个符号作为函数名, 名称为　*prelude-xxx* , 其中 xxx
为第一个参数的值.
</p>

<p>
第#3 行, 生成了这个函数的描述.
</p>

<p>
第#4 行, 调用 <b>prelude-search</b> 函数进行搜索处理.
</p>

<p>
第#5 行, 调用这个宏定义了一个名为　*prelude-google* 的函数.
</p>

<p>
从以上代码可以知道, 我们利用宏生成了４个名称不同的函数, 避免了手动编写函数的问题
(因为这４个函数的代码非常相似, 根据 DRY 原则应该尽量避免做这种重复工作).
</p>

<p>
关于宏的更多内容, 可以阅读 <b>Paul Graham</b> 的著作　<a href="http://www.paulgraham.com/onlisp.html">《On Lisp》</a>
</p>

<pre class="example">
prelude-duckduckgo
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline95" class="outline-3">
<h3 id="orgheadline95"><span class="section-number-3">13.2</span> Use-package</h3>
<div class="outline-text-3" id="text-13-2">
</div><div id="outline-container-orgheadline88" class="outline-4">
<h4 id="orgheadline88"><span class="section-number-4">13.2.1</span> 简介</h4>
<div class="outline-text-4" id="text-13-2-1">
<p>
Use-package 是一个宏, 它能让你将一个包的 <b>require</b> 和它的相关的初始化等配置组织
在一起, 避免对同一个包的配置代码散落在不同的文件中.
</p>

<p>
Use-package 的更多信息参见以下地址: <a href="https://github.com/jwiegley/use-package">Use-package</a>
</p>
</div>
</div>

<div id="outline-container-orgheadline93" class="outline-4">
<h4 id="orgheadline93"><span class="section-number-4">13.2.2</span> 一些简单的用法</h4>
<div class="outline-text-4" id="text-13-2-2">
</div><ol class="org-ol"><li><a id="orgheadline89"></a>更安全的 require<br  /><div class="outline-text-5" id="text-13-2-2-1">
<p>
在 Emacs 中, 当我们要引入一个包时, 通常会使用以下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">package-name</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
但是当 <b>package-name</b> 不在 <b>load-path</b> 中时, 以上代码会抛出错误. 使用
<b>Use-package</b> 可以避免:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">package-name</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
以上代码展开的结果如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">if</span>
    <span style="color: #66D9EF;">(</span>not
     <span style="color: #A6E22E;">(</span><span style="color: #F92672;">require</span> '<span style="color: #AE81FF;">package-name</span> nil 't<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
    <span style="color: #66D9EF;">(</span>ignore
     <span style="color: #A6E22E;">(</span>message
      <span style="color: #E6DB74;">(</span>format <span style="color: #E6DB74;">"Cannot load %s"</span> 'package-name<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
可以看到, <b>Use-package</b> 使用 <b>ignore</b> 来避免抛出错误, 这样当某个包不存在时,
<b>eamcs</b> 也能够正常启动.
</p>
</div></li>

<li><a id="orgheadline90"></a>将配置集中<br  /><div class="outline-text-5" id="text-13-2-2-2">
<p>
当我们引入某个包时, 有可能需要定义一些与这个包相关的变量, 使用 <b>Use-package</b> 实
现这个需求如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">package-name</span>
  <span style="color: #F92672;">:init</span>
  <span style="color: #66D9EF;">(</span>setq my-var1 <span style="color: #E6DB74;">"xxx"</span><span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:config</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">progn</span>
    <span style="color: #A6E22E;">(</span>setq my-var2 <span style="color: #E6DB74;">"xxx"</span><span style="color: #A6E22E;">)</span>
    <span style="color: #A6E22E;">(</span>setq my-var3 <span style="color: #E6DB74;">"xxx"</span><span style="color: #A6E22E;">)</span>
    <span style="color: #66D9EF;">)</span>
  <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
在上例中, <b>init</b> 后的代码在包的 require 之前执行, 如果这段代码出错则跳过包的 require.
</p>

<p>
<b>config</b> 后的代码在包的 require 之后执行.
</p>

<p>
<b>init</b> 与 <b>config</b> 之后只能接单个表达式语句, 如果需要执行多个语句, 可以用 <b>progn</b> .
</p>
</div></li>

<li><a id="orgheadline91"></a>autoload<br  /><div class="outline-text-5" id="text-13-2-2-3">
<p>
使用 require 时会引入这个包, 但是当你的包很多时会影响启动速度. 而使用 autoload
则可以在真正需要这个包时再 require, 提高启动速度, 避免无谓的 require.
</p>

<p>
使用 <b>Use-package</b> 可以轻松的实现这个功能:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">package-name</span>
  <span style="color: #F92672;">:commands</span>
  <span style="color: #66D9EF;">(</span>global-company-mode<span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:defer</span> t
  <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
使用 <b>commands</b> 可以让 package 延迟加载, 如以上代码会首先判断 package 的符号是否
存在, 如果存在则在 <b>package-name</b> 的路径下加载. <b>defer</b> 也可以让 <b>package-name</b>
进行延迟加载.
</p>
</div></li>

<li><a id="orgheadline92"></a>键绑定<br  /><div class="outline-text-5" id="text-13-2-2-4">
<p>
在之前的代码中, 如果我们需要绑定一个键, 需要使用 <b>global-key-bind</b> 或
<b>define-key</b> 实现, 而使用*Use-package* 实现更简单:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">color-moccur</span>
  <span style="color: #F92672;">:commands</span> <span style="color: #66D9EF;">(</span>isearch-moccur isearch-all<span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:bind</span> <span style="color: #66D9EF;">(</span><span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"M-s O"</span> . moccur<span style="color: #A6E22E;">)</span>
         <span style="color: #F92672;">:map</span> isearch-mode-map
         <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"M-o"</span> . isearch-moccur<span style="color: #A6E22E;">)</span>
         <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"M-O"</span> . isearch-moccur-all<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:init</span>
  <span style="color: #66D9EF;">(</span>setq isearch-lazy-highlight t<span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:config</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">moccur-edit</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>
</div></li></ol>
</div>



<div id="outline-container-orgheadline94" class="outline-4">
<h4 id="orgheadline94"><span class="section-number-4">13.2.3</span> 为什么使用 Use-package</h4>
<div class="outline-text-4" id="text-13-2-3">
<ol class="org-ol">
<li>Use-package 能让相关的配置更为集中, 避免配置分散带来的维护困难</li>
<li>Use-package 有完善的错误处理, 使配置代码更为健壮</li>
<li>Spacemacs 也大量使用了 Use-package</li>
</ol>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline103" class="outline-2">
<h2 id="orgheadline103"><span class="section-number-2">14</span> 第十天: Company-mode 与 auto-completion</h2>
<div class="outline-text-2" id="text-14">
<p>
内容概要:
</p>

<ol class="org-ol">
<li>给出 Cask 和 Use-package 的简单示例</li>
<li>详细介绍 Company-mode 的工作原理, 各种 backend 及其用法</li>
</ol>

<p>
扩展阅读:
</p>

<ol class="org-ol">
<li><a href="http://sixty-north.com/blog/writing-the-simplest-emacs-company-mode-backend">编写一个简单的 comopany backend</a></li>
<li><a href="https://www.emacswiki.org/emacs/CompanyMode">Company Mode Emacs wiki</a></li>
</ol>
</div>

<div id="outline-container-orgheadline97" class="outline-3">
<h3 id="orgheadline97"><span class="section-number-3">14.1</span> 升级 Package 之后有 BUG 怎么办</h3>
<div class="outline-text-3" id="text-14-1">
<p>
有些时候我们将一个 Package 升级到最新的版本(例如 github 上最新的 commit), 而该版本可能会存在一些 BUG, 这就会导致我们的配置不能使用.
</p>

<p>
如果我们使用 stable 版本的 Package(例如使用 github 上最新的 release), 就可以尽量地减少因为升级包之后的 BUG 导致配置不可用的情况.
</p>

<p>
另一种解决方式是使用 Cask 进行包管理, 举例如下:
</p>

<p>
首先我们添加一个包, 例如我们编辑 Cask 文件, 添加 monokai-theme :
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>depends-on <span style="color: #E6DB74;">"monokai-theme"</span>
            <span style="color: #F92672;">:git</span> <span style="color: #E6DB74;">"https://github.com/oneKelvinSmith/monokai-emacs/releases"</span>
            <span style="color: #F92672;">:ref</span> <span style="color: #E6DB74;">"02c5f5d"</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
然后启动 emacs, 但是出现了 BUG.
这时我们可以直接将 ref 的值修改为最新的 commit, Cask 即会更新这个包, 而不用等待 melpa 对包进行更新.
</p>
</div>
</div>

<div id="outline-container-orgheadline98" class="outline-3">
<h3 id="orgheadline98"><span class="section-number-3">14.2</span> Use-package 的更多用法</h3>
<div class="outline-text-3" id="text-14-2">
<p>
如果我们启用 <b>exec-path-from-shell</b> , 在 emacs 启动时可能会提示 <b>PATH</b> 变量重复定义, 解决方案如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">exec-path-from-shell</span>
  <span style="color: #F92672;">:ensure</span> t
  <span style="color: #F92672;">:if</span> <span style="color: #66D9EF;">(</span>and <span style="color: #A6E22E;">(</span>eq system-type 'darwin<span style="color: #A6E22E;">)</span> <span style="color: #A6E22E;">(</span>display-graphic-p<span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
  <span style="color: #F92672;">:config</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">progn</span>
    <span style="color: #A6E22E;">(</span><span style="color: #F92672;">when</span> <span style="color: #E6DB74;">(</span>string-match-p <span style="color: #E6DB74;">"/zsh$"</span> <span style="color: #FD971F;">(</span>getenv <span style="color: #E6DB74;">"SHELL"</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
      <span style="color: #75715E;">;; </span><span style="color: #75715E;">Use a non-interactive login shell.  A login shell, because my</span>
      <span style="color: #75715E;">;; </span><span style="color: #75715E;">environment variables are mostly set in `</span><span style="color: #AE81FF;">.zprofile</span><span style="color: #75715E;">'.</span>
      <span style="color: #E6DB74;">(</span>setq exec-path-from-shell-arguments '<span style="color: #FD971F;">(</span><span style="color: #E6DB74;">"-l"</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>

    <span style="color: #A6E22E;">(</span>exec-path-from-shell-initialize<span style="color: #A6E22E;">)</span>
    <span style="color: #66D9EF;">)</span>
  <span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">(use-package monokai-theme</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">:ensure t)</span>
</pre>
</div>

<p>
其中 if 子句可以确定启用 Package 的条件, 在 config 子句中向 <b>exec-path-from-shell-arguments</b> 即可消除这个警告.
</p>

<p>
ensure 子句来确保 Package 被安装. 如果要使用 stable 版, 则添加以下子句:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #F92672;">:pin</span> melpa-stable
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline99" class="outline-3">
<h3 id="orgheadline99"><span class="section-number-3">14.3</span> Company-mode 的工作原理</h3>
<div class="outline-text-3" id="text-14-3">
<p>
Company-mode 需要配合后端使用, 所有的 backend 都保存在 <b>company-backends</b> 这个变量中, 例如在我的环境中该变量值如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>company-capf
 <span style="color: #66D9EF;">(</span>company-dabbrev-code company-gtags company-etags company-keywords<span style="color: #66D9EF;">)</span>
 company-files
 company-dabbrev
 <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
*company-backends*变量的值是一个列表, 其中的每一项都是一个后端或 Group Backend.
</p>

<p>
Company-mode 会依次调用该变量中的 backend, 并判断该 backend 是否合适当前 Buffer, 直到找到一个合适的补全后端.
</p>

<p>
在进行补全项选择的时候, 我们也可以在 mode-line 中看到是使用的哪一个后端.
</p>

<ol class="org-ol">
<li>company-dabbrev: 将当前打开的所有 buffer 中的关键字作为补全显示(默认不使用 scratch buffer).</li>
<li>company-files: 补全路径.</li>
</ol>

<p>
如果在补全过程中取消了补全, 也可以使用命令再次开启补全. 例如 <b>company-files</b> 补全方式就可以使用 company-files 函数开启.
</p>

<p>
在输入英文时可以使用 company-ispell 进行输入提示.
</p>
</div>
</div>

<div id="outline-container-orgheadline100" class="outline-3">
<h3 id="orgheadline100"><span class="section-number-3">14.4</span> 为什么有时 Python 的补全 不工作</h3>
<div class="outline-text-3" id="text-14-4">
<p>
有时在编写 Python 代码的时候补全不能工作, 这时我们可以先查看 <b>company-backends</b> 的值, 查看是否需要安装 <b>company-anaconda</b> 用于补全.
</p>

<p>
在 Mac 系统中, 如果 anaconda-mode 的安装过程出现错误, 可以参照以下解决方案: <a href="https://emacs-china.org/t/mac-python-anaconda-mode/207">Mac 上面编辑 python 的时候安装 anaconda-mode 出错</a>
</p>

<p>
然后确保在 <b>company-backends</b> 中有 <b>company-anaconda</b> 这个后端即可. 可以使用如下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'python-mode-hook
          <span style="color: #66D9EF;">(</span><span style="color: #F92672;">lambda</span> <span style="color: #A6E22E;">()</span>
            <span style="color: #A6E22E;">(</span>set <span style="color: #E6DB74;">(</span>make-local-variable 'company-backends<span style="color: #E6DB74;">)</span> '<span style="color: #E6DB74;">(</span>company-anaconda<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
以上代码在 python-mode 被激活时设置 <b>company-backends</b> 的变量值为 (company-anaconda), 则在编辑 python 代码时就可以使用 anaconda-mode 进行补全.
</p>

<p>
在 emacs 中有两种补全方式:
</p>
<ol class="org-ol">
<li>如 company-files 等, 根据关键字等进行补全, 只需要 emacs 自己进行一些处理即可得到补全数据;</li>
<li>如 company-anaconda 等, 需要使用客户端-服务端模式, 补全后端需要服务端的配合才能得到补全数据.</li>
</ol>

<p>
在进行编程时, 一般使用第二种补全后端, 例如 编写 python 代码使用 company-anaconda, 编写 C/C++代码使用 company-ycmd, 编写 javascript 代码使用 company-tern.
</p>

<p>
上述示例代码开启 company-anaconda 时有一个缺点, 比如当我们在 python 的注释时没法使用补全, 因为补全后端只有 company-anaconda, 在注释时不工作. 我们可以将 dabbrev 加入后端列表:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'python-mode-hook
          <span style="color: #66D9EF;">(</span><span style="color: #F92672;">lambda</span> <span style="color: #A6E22E;">()</span>
            <span style="color: #A6E22E;">(</span>set <span style="color: #E6DB74;">(</span>make-local-variable 'company-backends<span style="color: #E6DB74;">)</span> '<span style="color: #E6DB74;">(</span>company-anaconda company-dabbrev<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
当 company-anaconda 不合适时使用 company-dabbrev 进行补全, 即可满足上述需求.
</p>
</div>
</div>

<div id="outline-container-orgheadline101" class="outline-3">
<h3 id="orgheadline101"><span class="section-number-3">14.5</span> Group Backend</h3>
<div class="outline-text-3" id="text-14-5">
<p>
company-dabbrev-code: 类似于 company-dabbrev, 但是 dabbrev 对代码和注释都进行补全, dabbrev-code 只补全代码.
</p>

<p>
假设我们的配置代码如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>add-hook 'python-mode-hook
          <span style="color: #66D9EF;">(</span><span style="color: #F92672;">lambda</span> <span style="color: #A6E22E;">()</span>
            <span style="color: #A6E22E;">(</span>set <span style="color: #E6DB74;">(</span>make-local-variable 'company-backends<span style="color: #E6DB74;">)</span> '<span style="color: #E6DB74;">(</span><span style="color: #FD971F;">(</span>company-anaconda company-dabbrev-code<span style="color: #FD971F;">)</span>
                                                           company-dabbrev<span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span>
          <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
如果我们在注释中出现了 xxx 这个字符串, 在编写 python 代码时 xxx 不会出现在补全选项中. 因为在此时会先匹配到 company-anaconda, 并不会进入 company-dabbrev.
而因为 company-anaconda 是一个 Group Backend, 所以 company-dabbrev-code 的补全数据会出现在补全列表中.
</p>
</div>
</div>
<div id="outline-container-orgheadline102" class="outline-3">
<h3 id="orgheadline102"><span class="section-number-3">14.6</span> 怎样写一个简单的补全后端</h3>
<div class="outline-text-3" id="text-14-6">
<p>
因为视频时间关系, 大家可以去阅读以下文章:
</p>

<p>
<a href="http://sixty-north.com/blog/writing-the-simplest-emacs-company-mode-backend">Writing the Simplest Emacs company-mode Backend</a>
</p>

<p>
实现方式简单介绍如下:
</p>

<ol class="org-ol">
<li>定义一个补全数据列表</li>
<li>定义一个补全函数, 返回对应输入的补全数据</li>
</ol>

<p>
更多的内容可以查看该文档, 同时在网页右侧的链接中有更多的详细内容.
</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline114" class="outline-2">
<h2 id="orgheadline114"><span class="section-number-2">15</span> 第十一天: Spacemacs 简介及安装</h2>
<div class="outline-text-2" id="text-15">
<p>
从今天的内容开始介绍 Spacemacs. 地址: <a href="https://github.com/syl20bnr/spacemacs">Spacemacs</a>
</p>

<p>
今天的内容包括:
</p>

<ol class="org-ol">
<li>如何安装 Spacemacs</li>
<li>一些简单的配置, 以及 package 管理</li>
<li>管理自己的配置</li>
</ol>
</div>

<div id="outline-container-orgheadline104" class="outline-3">
<h3 id="orgheadline104"><span class="section-number-3">15.1</span> 安装 Spacemacs</h3>
<div class="outline-text-3" id="text-15-1">
<p>
安装 Spacemacs 非常简单, 只需要将 github 上的仓库克隆即可, 即执行以下命令(如有必要可以先备份以前的配置):
</p>

<div class="org-src-container">

<pre class="src src-shell"><span style="color: #F92672;">cd</span> ~
mv .emacs.d .emacs.d.bak
mv .emacs .emacs.bak
git clone https://github.com/syl20bnr/spacemacs ~/.emacs.d
</pre>
</div>

<p>
在克隆完成后直接运行 Emacs.
在第一次使用 Spacemacs 时需要下载一些 Package, 然后在 Bootstrap 完成之后你需要进行如下一些配置:
</p>

<ol class="org-ol">
<li>使用哪种编辑方式, 包括 vim 方式(默认) 以及 emacs 方式.</li>
<li>使用哪种 Spacemacs distribution. 包括标准版(默认)以及基础版. 区别在于标准版包含非常多的功能, 而基础版只包含核心功能.</li>
</ol>

<p>
在完成以上两个配置之后, 就会在 HOME 目录生成一个 ~/.spacemacs 配置文件.
然后 Spacemacs 会进行进一步的初始化, 下载更多的需要的 Package.
如果你需要使用 <a href="http://elpa.emacs-china.org/">emacs-china</a> 的配置源, 此时可以终止 emacs, 然后在~/.spacemacs 中的 dotspacemacs/user-init 函数中加入以下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq configuration-layer--elpa-archives
      '<span style="color: #66D9EF;">(</span><span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"melpa-cn"</span> . <span style="color: #E6DB74;">"http://elpa.zilongshanren.com/melpa/"</span><span style="color: #A6E22E;">)</span>
        <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"org-cn"</span>   . <span style="color: #E6DB74;">"http://elpa.zilongshanren.com/org/"</span><span style="color: #A6E22E;">)</span>
        <span style="color: #A6E22E;">(</span><span style="color: #E6DB74;">"gnu-cn"</span>   . <span style="color: #E6DB74;">"http://elpa.zilongshanren.com/gnu/"</span><span style="color: #A6E22E;">)</span><span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
重新启动 emacs, 等待 Spacemacs 完成安装即可.
</p>

<p>
如果你需要更方便的管理你自己的配置, 可以创建 ~/.spacemacs.d 目录, 然后将 ~/.spacemacs 文件移动到该目录中并重命名为 init.el.
</p>

<p>
在 Spacemacs 中的操作方式如下:
</p>

<ol class="org-ol">
<li>按下 <b>SPC f j</b> 打开 dired 目录</li>
<li>按下按键 + , 创建 ~/.spacemacs.d 目录</li>
<li>将光标移动到 .spacemacs 文件上, 按下 R, 将该文件移动到 .spacemacs.d 目录中</li>
<li>进入 .spacemacs.d 目录, 将光标移动到 .spacemacs 文件上, 按下 R, 将该文件重命名为 init.el</li>
<li>按下 qq 退出 dired</li>
</ol>

<p>
然后启动 emacs 即可.
</p>

<p>
使用这种方式管理配置, 你可以将自己的配置集中到 ~/.spacemacs.d 目录中, 更容易进行统一管理. 你也可以将自己的配置 push 到 github 上.
</p>
</div>
</div>

<div id="outline-container-orgheadline105" class="outline-3">
<h3 id="orgheadline105"><span class="section-number-3">15.2</span> 添加内置的 layer</h3>
<div class="outline-text-3" id="text-15-2">
<p>
在安装完成 Spacemacs 之后, 按下 <b>SPC f e d</b> 打开 ~/.spacemacs 文件, 修改 <b>dotspacemacs-configuration-layers</b> 变量的值,
将 auto-completion, better-defaults, emacs-lisp, git, markdown, org, spell-checking, syntax-checking 等 layer 加入列表.
</p>

<p>
然后退出 emacs 再重启, 或者按下 <b>SPC f e R</b> 安装需要的 package.
</p>
</div>
</div>

<div id="outline-container-orgheadline113" class="outline-3">
<h3 id="orgheadline113"><span class="section-number-3">15.3</span> 一些简单的配置</h3>
<div class="outline-text-3" id="text-15-3">
</div><div id="outline-container-orgheadline106" class="outline-4">
<h4 id="orgheadline106"><span class="section-number-4">15.3.1</span> 启动时全屏显示</h4>
<div class="outline-text-4" id="text-15-3-1">
<p>
在 dotspacemacs/init 函数中, 将 dotspacemacs-fullscreen-at-startup 变量设置为 t 即可. 代码如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">If non nil the frame is maximized when Emacs starts up.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Takes effect only if `</span><span style="color: #AE81FF;">dotspacemacs-fullscreen-at-startup</span><span style="color: #75715E;">' is nil.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">(default nil) (Emacs 24.4+ only)</span>
dotspacemacs-maximized-at-startup t
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline107" class="outline-4">
<h4 id="orgheadline107"><span class="section-number-4">15.3.2</span> ivy layer</h4>
<div class="outline-text-4" id="text-15-3-2">
<p>
将 ivy 加入 <b>dotspacemacs-configuration-layers</b> 列表中. 按下 <b>CTRL s</b> 使用 swiper 可以进行搜索.
</p>
</div>
</div>

<div id="outline-container-orgheadline108" class="outline-4">
<h4 id="orgheadline108"><span class="section-number-4">15.3.3</span> 查看 layer 下的 文档信息</h4>
<div class="outline-text-4" id="text-15-3-3">
<p>
按下 <b>SPC h SPC</b> 即会弹出一个信息窗口, 可以从窗口中选择具体的 layer 或者其他信息进行查看.
</p>
</div>
</div>

<div id="outline-container-orgheadline109" class="outline-4">
<h4 id="orgheadline109"><span class="section-number-4">15.3.4</span> 删除安装的 package</h4>
<div class="outline-text-4" id="text-15-3-4">
<p>
只需要将需要删除的 package 名称加入到 <b>dotspacemacs-excluded-packages</b> 变量中, 在下一次启动 emacs 时即会删除该 package.
示例代码如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">A list of packages and/or extensions that will not be install and loaded.</span>
dotspacemacs-excluded-packages '<span style="color: #AE81FF;">(</span>vi-tilde-fringe<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline110" class="outline-4">
<h4 id="orgheadline110"><span class="section-number-4">15.3.5</span> 安装 package</h4>
<div class="outline-text-4" id="text-15-3-5">
<p>
在 Spacemacs 中安装 package 时最好不要使用 <b>package-install</b>, 因为这样安装的 package 会在下一次启动时被删除.
</p>

<p>
Spacemacs 提供了一个方式, 你只需将需要安装的 package 加入到 <b>dotspacemacs-additional-package</b> 变量中即可,
示例代码如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">List of additional packages that will be installed without being</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">wrapped in a layer. If you need some configuration for these</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">packages, then consider creating a layer. You can also put the</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">configuration in `</span><span style="color: #AE81FF;">dotspacemacs/user-config</span><span style="color: #75715E;">'.</span>
dotspacemacs-additional-packages '<span style="color: #AE81FF;">(</span>youdao-dictionary<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline111" class="outline-4">
<h4 id="orgheadline111"><span class="section-number-4">15.3.6</span> 配置 customize-group</h4>
<div class="outline-text-4" id="text-15-3-6">
<p>
如果使用 customize-group 对配置进行了修改, 你可以以下代码将生成的 <b>custom.el</b> 配置文件纳入 ~/.spacemacs.d 目录中进行统一管理:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq custom-file <span style="color: #66D9EF;">(</span>expand-file-name <span style="color: #E6DB74;">"custom.el"</span> dotspacemacs-directory<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
<span style="color: #AE81FF;">(</span>load custom-file 'no-error 'no-message<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline112" class="outline-4">
<h4 id="orgheadline112"><span class="section-number-4">15.3.7</span> 修改主题</h4>
<div class="outline-text-4" id="text-15-3-7">
<p>
只需修改 <b>dotspacemacs-themes</b> 变量的值, 将主题加入列表即可. 在列表中靠前的主题会优先使用.
示例代码如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">List of themes, the first of the list is loaded when spacemacs starts.</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">Press &lt;SPC&gt; T n to cycle to the next theme in the list (works great</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">with 2 themes variants, one dark and one light)</span>
dotspacemacs-themes '<span style="color: #AE81FF;">(</span>
                      monokai
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">spacemacs-dark</span>
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">spacemacs-light</span>
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">solarized-light</span>
                      solarized-dark
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">leuven</span>
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">monokai</span>
                      <span style="color: #75715E;">;; </span><span style="color: #75715E;">zenburn</span>
                      <span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline120" class="outline-2">
<h2 id="orgheadline120"><span class="section-number-2">16</span> 第十二天: 创建你的第一个 Spacemacs Layer</h2>
<div class="outline-text-2" id="text-16">
<p>
主要内容:
</p>

<ol class="org-ol">
<li>如何更新 Spacemacs, 同步官方 develop 分支及注意事项</li>
<li>Layer 的 variables 变量及使用方法</li>
<li>如何创建自己的 Layer</li>
<li>如何定制 modeline</li>
<li>evlified state</li>
</ol>
</div>

<div id="outline-container-orgheadline115" class="outline-3">
<h3 id="orgheadline115"><span class="section-number-3">16.1</span> 如何更新 Sapcemacs</h3>
<div class="outline-text-3" id="text-16-1">
<p>
可以通过 git 的方式来更新代码, 假设我们使用的是 develop 分支:
</p>

<div class="org-src-container">

<pre class="src src-shell">git checkout develop
git fetch upstream
git merge upstream/develop
</pre>
</div>

<p>
一般来说, 如果你不熟悉 emacs 并且你的 Sapcemacs 配置能够正常工作, 则不需要频繁的更新代码, 以避免更新之后配置不能使用.
</p>
</div>
</div>

<div id="outline-container-orgheadline116" class="outline-3">
<h3 id="orgheadline116"><span class="section-number-3">16.2</span> variables 变量</h3>
<div class="outline-text-3" id="text-16-2">
<p>
每一个 layer 都可以配置一些变量, 可以通过 <b>SPC h SPC</b> 然后输入 layer 名称, 点击对应的选项即可打开该 layer 的 README.org 文件.
然后按下 SPC f j 进入 dired 模式, 选择 config.el 文件打开, 该文件中即定义了该 layer 的变量.
</p>

<p>
例如 better-default layer 的变量如下:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">better-defaults-move-to-beginning-of-code-first</span> t
  <span style="color: #75715E;">"when t, first stroke of C-a will move the cursor to the beginning of code.</span>
<span style="color: #75715E;">When nil, first stroke will go to the beginning of line.</span>
<span style="color: #75715E;">Subsequent strokes will toggle between beginning of line and beginning of code."</span><span style="color: #AE81FF;">)</span>

<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defvar</span> <span style="color: #FD971F;">better-defaults-move-to-end-of-code-first</span> nil
  <span style="color: #75715E;">"when t, first stroke of C-e will move the cursor to the end of code (before comments).</span>
<span style="color: #75715E;">When nil, first stroke will go to the end of line (after comments).</span>
<span style="color: #75715E;">Subsequent strokes will toggle between end of line and end of code."</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
要配置使用这些变量, 可以在启用 layer 时使用如下的代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>better-defaults <span style="color: #F92672;">:variables</span>
                 better-defaults-move-to-end-of-code-first t<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline117" class="outline-3">
<h3 id="orgheadline117"><span class="section-number-3">16.3</span> 定制 modeline</h3>
<div class="outline-text-3" id="text-16-3">
<p>
在 emacs25.1 中, 该版本的 modeline 和以前版本不同, 可以通过如下方式将 modeline 修改为以前的显示形状:
</p>

<p>
在 dotspacemacs/user-config 中加入如下代码:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #AE81FF;">(</span>setq ns-use-srgb-colorspace nil<span style="color: #AE81FF;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline118" class="outline-3">
<h3 id="orgheadline118"><span class="section-number-3">16.4</span> 创建自己的 layer</h3>
<div class="outline-text-3" id="text-16-4">
<p>
假设我们需要创建一个 layer, 名叫 zilongshanren, 并且在 layer 下包含一个名叫 youdao-dictionary 的 package.
</p>

<p>
首先利用 spacemacs 提供的函数创建 layer. 按下 M-x 并且输入 configuration-layer/create-layer, 然后选择路径 ~/.spacemacs.d,
确定创建 README, 然后我们就可以看到 layer 创建成功.
</p>

<p>
每一个 layer 的结构如下:
</p>

<pre class="example">
[layer_name]
  |__ [local]
  | |__ [package 1]
  | |     ...
  | |__ [package n]
  |-- layers.el
  |__ packages.el
  |__ funcs.el
  |__ config.el
  |__ keybindings.el

[] = directory
</pre>

<p>
即每一个 layer 目录下都可以包含 layers.el, packages.el 等文件, 以及一个名叫 local 的目录.
</p>

<p>
每一个文件的内容描述如下:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">文件名</th>
<th scope="col" class="org-left">用处</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">layers.el</td>
<td class="org-left">申明一些额外的 layer 依赖</td>
</tr>

<tr>
<td class="org-left">packages.el</td>
<td class="org-left">一些 layer 使用到的 package 以及相关配置函数</td>
</tr>

<tr>
<td class="org-left">funcs.el</td>
<td class="org-left">定义一些 layer 层次的函数, 即全局函数</td>
</tr>

<tr>
<td class="org-left">config.el</td>
<td class="org-left">layer 的配置, 此处定义的配置可以在 .spacemacs 中申明 layer 时进行配置, 也可以定义 emacs 的默认配置</td>
</tr>

<tr>
<td class="org-left">keybindings.el</td>
<td class="org-left">快捷键配置</td>
</tr>
</tbody>
</table>

<p>
现在我们可以把 youdao-dictionary 加入到 layer 中, 编辑 packages.el:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#28155;&#21152; package</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defconst</span> <span style="color: #FD971F;">zilongshanren-packages</span>
  '<span style="color: #66D9EF;">(</span>youdao-dictionary<span style="color: #66D9EF;">)</span>
  <span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#21021;&#22987;&#21270; package</span>
<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#21487;&#20197;&#20351;&#29992; , d m &#24555;&#25463;&#38190;, &#28982;&#21518;&#25353;&#19979; e &#23637;&#24320;&#23439;</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">zilongshanren/init-youdao-dictionary</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #66D9EF;">(</span><span style="color: #F92672;">use-package</span> <span style="color: #AE81FF;">youdao-dictionary</span>
    <span style="color: #F92672;">:deter</span> t
    <span style="color: #F92672;">:init</span>
    <span style="color: #A6E22E;">(</span>spacemacs/set-leader-keys <span style="color: #E6DB74;">"oy"</span> 'youdao-dictionary-search-at-point+<span style="color: #A6E22E;">)</span>
    <span style="color: #66D9EF;">)</span>
  <span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
编辑 config.el 文件:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">&#24320;&#21551;&#34892;&#21495;&#26174;&#31034;</span>
<span style="color: #AE81FF;">(</span>global-linum-mode t<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#23450;&#20041;&#24555;&#25463;&#38190;</span>
<span style="color: #AE81FF;">(</span>global-set-key <span style="color: #66D9EF;">(</span>kbd <span style="color: #E6DB74;">"M-s o"</span><span style="color: #66D9EF;">)</span> 'occur-dwim<span style="color: #AE81FF;">)</span>

<span style="color: #75715E;">;; </span><span style="color: #75715E;">&#23558; occur &#30340; buffer &#20013;&#30340;&#20809;&#26631;&#31227;&#21160;&#26041;&#24335;&#20462;&#25913;&#20026; HJKL</span>
<span style="color: #AE81FF;">(</span>evilified-state-evilify-map occur-mode-map
  <span style="color: #F92672;">:mode</span> occur-mode<span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
编辑 keybindings.el 文件:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #75715E;">;; </span><span style="color: #75715E;">dwin = do what i mean.</span>
<span style="color: #AE81FF;">(</span><span style="color: #F92672;">defun</span> <span style="color: #A6E22E;">occur-dwim</span> <span style="color: #66D9EF;">()</span>
  <span style="color: #75715E;">"Call `</span><span style="color: #AE81FF;">occur</span><span style="color: #75715E;">' with a sane default."</span>
  <span style="color: #66D9EF;">(</span>interactive<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>push <span style="color: #A6E22E;">(</span><span style="color: #F92672;">if</span> <span style="color: #E6DB74;">(</span>region-active-p<span style="color: #E6DB74;">)</span>
            <span style="color: #E6DB74;">(</span>buffer-substring-no-properties
             <span style="color: #FD971F;">(</span>region-beginning<span style="color: #FD971F;">)</span>
             <span style="color: #FD971F;">(</span>region-end<span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span>
          <span style="color: #E6DB74;">(</span><span style="color: #F92672;">let</span> <span style="color: #FD971F;">(</span><span style="color: #F92672;">(</span>sym <span style="color: #AE81FF;">(</span>thing-at-point 'symbol<span style="color: #AE81FF;">)</span><span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span>
            <span style="color: #FD971F;">(</span><span style="color: #F92672;">when</span> <span style="color: #F92672;">(</span>stringp sym<span style="color: #F92672;">)</span>
              <span style="color: #F92672;">(</span>regexp-quote sym<span style="color: #F92672;">)</span><span style="color: #FD971F;">)</span><span style="color: #E6DB74;">)</span><span style="color: #A6E22E;">)</span>
        regexp-history<span style="color: #66D9EF;">)</span>
  <span style="color: #66D9EF;">(</span>call-interactively 'occur<span style="color: #66D9EF;">)</span><span style="color: #AE81FF;">)</span>
</pre>
</div>

<p>
然后将 zilongshanren 加到 <b>dotspacemacs-configuration-layers</b> 变量中, 即可让 layer 配置生效.
</p>
</div>
</div>

<div id="outline-container-orgheadline119" class="outline-3">
<h3 id="orgheadline119"><span class="section-number-3">16.5</span> 文档</h3>
<div class="outline-text-3" id="text-16-5">
<p>
spacemacs 的文档保存在 doc 目录下, 包含有 CONVENTIONS.org, DOCUMENTATION.org 等文档文件, 建议大家多多阅读.
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline127" class="outline-2">
<h2 id="orgheadline127"><span class="section-number-2">17</span> emacs python workflow.</h2>
<div class="outline-text-2" id="text-17">
</div><div id="outline-container-orgheadline121" class="outline-3">
<h3 id="orgheadline121"><span class="section-number-3">17.1</span> install elpy, jedi</h3>
<div class="outline-text-3" id="text-17-1">
<div class="org-src-container">

<pre class="src src-shell">sudo pip install jedi epc pylint flake8 <span style="color: #FD971F;">ipython</span>==<span style="color: #AE81FF;">5.3</span>
</pre>
</div>

<p>
install package jedi elpy magit
</p>
</div>
</div>
<div id="outline-container-orgheadline122" class="outline-3">
<h3 id="orgheadline122"><span class="section-number-3">17.2</span> Keybinding</h3>
<div class="outline-text-3" id="text-17-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Keybinding</td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left">C-M-i</td>
<td class="org-left">anaconda-mode-complete</td>
</tr>

<tr>
<td class="org-left">M-.</td>
<td class="org-left">anaconda-mode-find-definitions</td>
</tr>

<tr>
<td class="org-left">M-,</td>
<td class="org-left">anaconda-mode-find-assignments</td>
</tr>

<tr>
<td class="org-left">M-r</td>
<td class="org-left">anaconda-mode-find-references</td>
</tr>

<tr>
<td class="org-left">M-*</td>
<td class="org-left">anaconda-mode-go-back</td>
</tr>

<tr>
<td class="org-left">M-?</td>
<td class="org-left">anaconda-mode-show-doc</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgheadline123" class="outline-3">
<h3 id="orgheadline123"><span class="section-number-3">17.3</span> upgrade git</h3>
<div class="outline-text-3" id="text-17-3">
<div class="org-src-container">

<pre class="src src-shell">sudo add-apt-repository ppa:git-core/ppa -y
sudo apt-get update
sudo apt-get install git -y
git --version
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline124" class="outline-3">
<h3 id="orgheadline124"><span class="section-number-3">17.4</span> reinstall EMACS</h3>
<div class="outline-text-3" id="text-17-4">
<div class="org-src-container">

<pre class="src src-shell">Check emacs version.
$ emacs --version
Download the same emacs version you have installed<span style="color: #F92672;"> in</span> the past.
$ wget https://ftp.gnu.org/gnu/emacs/emacs-$<span style="color: #FD971F;">VERSION</span>.tar.xz
Extract tarball.
$ tar xJvf emacs-$<span style="color: #FD971F;">VERSION</span>.tar.xz
Run ./configure to generate the make file. If you remember the option you have given when you install it, add those command line flags, too. <span style="color: #AE81FF;">(</span>e.g. --with-x=no<span style="color: #AE81FF;">)</span>
$ cd emacs-$<span style="color: #FD971F;">VERSION</span>
$ ./configure
Do make uninstall to uninstall.
$ sudo make uninstall
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline125" class="outline-3">
<h3 id="orgheadline125"><span class="section-number-3">17.5</span> Spacemacs Dired</h3>
<div class="outline-text-3" id="text-17-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Keybinding</td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left">SPC f j</td>
<td class="org-left">打开 dired 目录</td>
</tr>

<tr>
<td class="org-left">+</td>
<td class="org-left">创建目录</td>
</tr>

<tr>
<td class="org-left">R</td>
<td class="org-left">Rename</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-left">copy</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-left">delete</td>
</tr>

<tr>
<td class="org-left">qq</td>
<td class="org-left">exit</td>
</tr>

<tr>
<td class="org-left">---</td>
<td class="org-left">---</td>
</tr>

<tr>
<td class="org-left"><code>C-x 4 d</code></td>
<td class="org-left">To display the Dired buffer in another window</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">bury the Dired buffer</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">undo</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-left">execute flagged commands</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgheadline126" class="outline-3">
<h3 id="orgheadline126"><span class="section-number-3">17.6</span> magit</h3>
<div class="outline-text-3" id="text-17-6">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">workflow</th>
<th scope="col" class="org-left">Keybinding</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">init, commit</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">SPC g i</td>
<td class="org-left">magit-init</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">SPC g s</td>
<td class="org-left">magit-status</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s-1</td>
<td class="org-left">goto unstaged section</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>TAB</code></td>
<td class="org-left">view diffs(code review)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s</td>
<td class="org-left">stage all changes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>C-c C-c</code></td>
<td class="org-left">commit</td>
</tr>

<tr>
<td class="org-left">Commits in Action</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">c a</td>
<td class="org-left">Ammend</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">r</td>
<td class="org-left">squash unpushed commits</td>
</tr>

<tr>
<td class="org-left">Branching basics</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">b B</td>
<td class="org-left">create branch</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">m m</td>
<td class="org-left">merge</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">b b</td>
<td class="org-left">switch branch</td>
</tr>

<tr>
<td class="org-left">pull, push</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">P P</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">f f/ f o</td>
<td class="org-left">fetch branch</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">F</td>
<td class="org-left">pull</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s-g</td>
<td class="org-left">send pull request</td>
</tr>

<tr>
<td class="org-left">Misc</td>
<td class="org-left"><code>M-m g s</code></td>
<td class="org-left">view github files</td>
</tr>

<tr>
<td class="org-left">stage</td>
<td class="org-left">s</td>
<td class="org-left">stage</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">u</td>
<td class="org-left">unstage</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">c</td>
<td class="org-left">actions</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">e</td>
<td class="org-left">extend current commit HEAD</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">a</td>
<td class="org-left">amend commit msg</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">r</td>
<td class="org-left">reword, discard commit msg</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">s</td>
<td class="org-left">discard the latest commit</td>
</tr>

<tr>
<td class="org-left">login</td>
<td class="org-left">1</td>
<td class="org-left">short logs</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">h</td>
<td class="org-left">reflog</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2017-04-22 Sat&gt;</span></span></p>
<p class="author">Author: weiwu</p>
<p class="date">Created: 2017-05-31 Wed 22:33</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
