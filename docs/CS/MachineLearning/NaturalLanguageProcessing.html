<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-11-15 Wed 12:47 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title></title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="weiwu" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../styles/demo/css/demo.css"/>
<link href="https://fonts.proxy.ustclug.org/css?family=Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline2">1. Overview</a>
<ul>
<li><a href="#orgheadline1">1.1. Sentiment Lexicon and Its Issues</a></li>
</ul>
</li>
<li><a href="#orgheadline9">2. Neo4j</a>
<ul>
<li><a href="#orgheadline3">2.1. Graph Fundamentals</a></li>
<li><a href="#orgheadline4">2.2. A Graph Database</a></li>
<li><a href="#orgheadline5">2.3. Labels</a></li>
<li><a href="#orgheadline6">2.4. More Nodes</a></li>
<li><a href="#orgheadline7">2.5. Consider Relationships</a></li>
<li><a href="#orgheadline8">2.6. Relationship properties</a></li>
</ul>
</li>
<li><a href="#orgheadline12">3. Definition of Sentiment Analysis</a>
<ul>
<li><a href="#orgheadline10">3.1. Structure</a></li>
<li><a href="#orgheadline11">3.2. Opinion Defintion</a></li>
</ul>
</li>
<li><a href="#orgheadline14">4. Language Technology Processing</a>
<ul>
<li><a href="#orgheadline13">4.1. features:</a></li>
</ul>
</li>
<li><a href="#orgheadline18">5. Building the Wikipedia Knowledge Graph in Neo4j</a>
<ul>
<li><a href="#orgheadline15">5.1. Login</a></li>
<li><a href="#orgheadline16">5.2. Approach 1: Loading a reduced subset incrementally through the MediaWiki API</a></li>
<li><a href="#orgheadline17">5.3. Approach 2: Batch loading the data with LOAD CSV from an SQL dump</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">1</span> Overview</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>Document level:</li>
</ul>
<p>
The task at this level is to classify whether a whole opinion document expresses a positive or negative sentiment.
</p>
<ul class="org-ul">
<li>Sentence level:</li>
</ul>
<p>
The task at this level goes to the sentences and determines whether each sentence expressed a positive, negative, or neutral opinion.
</p>

<p>
This level of analysis is closely related to subjectivity classification (Wiebe, Bruce and O'Hara, 1999), which distinguishes sentences (called objective sentences) that express factual information from sentences (called subjective sentences) that express subjective views and opinions.
</p>

<ul class="org-ul">
<li>Entity and Aspect level:</li>
</ul>
<p>
It is based on the idea that an opinion consists of a sentiment (positive or negative) and a target (of opinion).
</p>

<ul class="org-ul">
<li>regular opinions and comparative opinions</li>
</ul>
<p>
A regular opinion expresses a sentiment only on an particular entity or an aspect of the entity, e.g., “Coke tastes very good,” which expresses a positive sentiment on the aspect taste of Coke. A comparative opinion compares multiple entities based on some of their shared aspects, e.g., “Coke tastes better than Pepsi,” which compares Coke and Pepsi based on their tastes (an aspect) and expresses a preference for Coke.
</p>
</div>

<div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1"><span class="section-number-3">1.1</span> Sentiment Lexicon and Its Issues</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>lexicon</li>
</ul>
<p>
opinions, positive and negative.
</p>
<ul class="org-ul">
<li>issue</li>
</ul>
<p>
spam review
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-2">
<h2 id="orgheadline9"><span class="section-number-2">2</span> Neo4j</h2>
<div class="outline-text-2" id="text-2">
<p>
An open-source NoSQL graph database.
</p>
</div>
<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">2.1</span> Graph Fundamentals</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Nodes - graph data records</li>
<li>Relationships - connect nodes</li>
<li>Properties - named data values</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-3">
<h3 id="orgheadline4"><span class="section-number-3">2.2</span> A Graph Database</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Neo4j stores data in a Graph, with records called Nodes.
</p>

<p>
The simplest graph has just a single node with some named values called Properties. Let's draw a social graph of our friends on the Neo4j team:
</p>

<p>
1.Start by drawing a circle for the node
2.Add the name Emil
3.Note that he is from Sweden
</p>
<ul class="org-ul">
<li>Nodes are the name for data records in a graph</li>
<li>Data is stored as Properties</li>
<li>Properties are simple name/value pairs</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline5" class="outline-3">
<h3 id="orgheadline5"><span class="section-number-3">2.3</span> Labels</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Associate a set of nodes.
</p>

<p>
Nodes can be grouped together by applying a Label to each member. In our social graph, we'll label each node that represents a Person.
</p>

<ol class="org-ol">
<li>Apply the label "Person" to the node we created for Emil</li>
<li>Color "Person" nodes red</li>
<li>A node can have zero or more labels</li>
<li>Labels do not have any properties</li>
</ol>
</div>
</div>
<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">2.4</span> More Nodes</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Schema-free, nodes can have a mix of common and unique properties.
</p>

<ul class="org-ul">
<li>Similar nodes can have different properties</li>
<li>Properties can be strings, numbers, or booleans</li>
<li>Neo4j can store billions of nodes</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">2.5</span> Consider Relationships</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Connect nodes in the graph
</p>

<p>
The real power of Neo4j is in connected data. To associate any two nodes, add a Relationship which describes how the records are related.
</p>

<p>
In our social graph, we simply say who KNOWS whom:
</p>

<p>
1.Emil KNOWS Johan and Ian
2.Johan KNOWS Ian and Rik
3.Rik and Ian KNOWS Allison
</p>
<ul class="org-ul">
<li>Relationships always have direction</li>
<li>Relationships always have a type</li>
<li>Relationships form patterns of data</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">2.6</span> Relationship properties</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Store information shared by two nodes.
</p>

<p>
In a property graph, relationships are data records that can also contain properties. Looking more closely at Emil's relationships, note that:
</p>

<ul class="org-ul">
<li>Emil has known Johan since 2001</li>
<li>Emil rates Ian 5 (out of 5)</li>
<li>Everyone else can have similar relationship properties</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-2">
<h2 id="orgheadline12"><span class="section-number-2">3</span> Definition of Sentiment Analysis</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10"><span class="section-number-3">3.1</span> Structure</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Due to a large collection of opinions on the Web, some form of summary of opinions is needed (Hu and Liu, 2004).
</p>
</div>
</div>
<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><span class="section-number-3">3.2</span> Opinion Defintion</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>Observation: An opinion consists of two key components: a target g and a sentiment s on the target.</li>

<li>Definition (Opinion): An opinion is a quadruple, (g, s, h, t), where g is the opinion (or sentiment) target, s is the sentiment about the target, h is the opinion holder and t is the time when the opinion was expressed.</li>

<li>Definition (entity): An entity e is a product, service, topic, issue, person, organization, or event. It is described with a pair, e: (T, W), where T is a hierarchy of parts, sub-parts, and so on, and W is a set of attributes of e.</li>

<li>Definition (opinion): An opinion is a quintuple, (ei, aij, sijkl, hk, tl), where ei is the name of an entity, aij is an aspect of ei, sijkl is the sentiment on aspect aij of entity ei, hk is the opinion holder, and tl is the time when the opinion is expressed by hk. The sentiment sijkl is positive, negative, or neutral, or expressed with different strength/intensity levels, e.g., 1 to 5 stars as used by most review sits on the Web.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgheadline14" class="outline-2">
<h2 id="orgheadline14"><span class="section-number-2">4</span> Language Technology Processing</h2>
<div class="outline-text-2" id="text-4">
<p>
[<a href="http://ltp.ai/docs/index.html">http://ltp.ai/docs/index.html</a>]
</p>
</div>
<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">4.1</span> features:</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>针对单一自然语言处理任务，生成统计机器学习模型的工具</li>
<li>针对单一自然语言处理任务，调用模型进行分析的编程接口</li>
<li>使用流水线方式将各个分析工具结合起来，形成一套统一的中文自然语言处理系统</li>
<li>系统可调用的，用于中文语言处理的模型文件</li>
<li>针对单一自然语言处理任务，基于云端的编程接口</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgheadline18" class="outline-2">
<h2 id="orgheadline18"><span class="section-number-2">5</span> Building the Wikipedia Knowledge Graph in Neo4j</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>guide:</li>
</ul>
<p>
<a href="http://guides.neo4j.com/wiki">http://guides.neo4j.com/wiki</a>
</p>

<ul class="org-ul">
<li>main topic classification:</li>
</ul>
<p>
<a href="https://en.wikipedia.org/wiki/Category:Main_topic_classifications">https://en.wikipedia.org/wiki/Category:Main_topic_classifications</a>
</p>
</div>
<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">5.1</span> Login</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-neo4j">:server connect
</pre>
</div>
<div class="org-src-container">

<pre class="src src-text">host:
bolt://ws-10-0-1-111-33640.neo4jsandbox.com:443

username:
neo4j

pwd:
darts-quota-alternation
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">5.2</span> Approach 1: Loading a reduced subset incrementally through the MediaWiki API</h3>
<div class="outline-text-3" id="text-5-2">
<p>
<a href="https://jesusbarrasa.wordpress.com/2016/08/03/quickgraph2-how-is-wikipedias-knowledge-organised/">https://jesusbarrasa.wordpress.com/2016/08/03/quickgraph2-how-is-wikipedias-knowledge-organised/</a>
</p>

<p>
<a href="https://jesusbarrasa.wordpress.com/2017/04/26/quickgraph6-building-the-wikipedia-knowledge-graph-in-neo4j-qg2-revisited/">https://jesusbarrasa.wordpress.com/2017/04/26/quickgraph6-building-the-wikipedia-knowledge-graph-in-neo4j-qg2-revisited/</a>
</p>

<p>
<a href="https://github.com/jbarrasa/datasets/blob/master/wikipedia/wiki-guide.adoc">https://github.com/jbarrasa/datasets/blob/master/wikipedia/wiki-guide.adoc</a>
</p>

<ul class="org-ul">
<li>Wiki API JSON format:</li>
</ul>
<p>
<a href="https://www.mediawiki.org/wiki/API:Categorymembers">https://www.mediawiki.org/wiki/API:Categorymembers</a>
</p>
<div class="org-src-container">

<pre class="src src-json">{
    "batchcomplete": "",
    "continue": {
        "cmcontinue": "page|2b273f2f3d29272b3b0445434d2f414d37273d0117018f16|55503653",
        "continue": "-||"
    },
    "query": {
        "categorymembers": [
            {
                "pageid": 22939,
                "ns": 0,
                "title": "Physics"
            },
            {
                "pageid": 3445246,
                "ns": 0,
                "title": "Glossary of classical physics"
            },
            {
                "pageid": 24489,
                "ns": 0,
                "title": "Outline of physics"
            },
            {
                "pageid": 1653925,
                "ns": 100,
                "title": "Portal:Physics"
            },
            {
                "pageid": 50926902,
                "ns": 0,
                "title": "Action angle coordinates"
            },
            {
                "pageid": 9079863,
                "ns": 0,
                "title": "Aerometer"
            },
            {
                "pageid": 52657328,
                "ns": 0,
                "title": "Bayesian model of computational anatomy"
            },
            {
                "pageid": 49342572,
                "ns": 0,
                "title": "Group actions in computational anatomy"
            },
            {
                "pageid": 50724262,
                "ns": 0,
                "title": "Blasius\u2013Chaplygin formula"
            },
            {
                "pageid": 33327002,
                "ns": 0,
                "title": "Cabbeling"
            }
        ]
    }
}
</pre>
</div>

<ul class="org-ul">
<li>Clause of building wikipedia graph</li>
</ul>
<div class="org-src-container">

<pre class="src src-neo4j">//Loading the data into Neo4j
//prepare the DB with a few indexes to accelerate the ingestion and querying of the data:
CREATE INDEX ON :Category(catId)
CREATE INDEX ON :Category(catName)
CREATE INDEX ON :Page(pageTitle)

//Loading a reduced subset incrementally through the MediaWiki API
//create the Wikipedia Knowledge Graph about Databases.
//create the root category: Databases.
CREATE (c:Category:RootCategory {catId: 0, catName: 'Databases', subcatsFetched : false, pagesFetched : false, level: 0 })

//iteratively load the next level of subcategories to a depth of our choice.
UNWIND range(0,3) as level
CALL apoc.cypher.doIt("
MATCH (c:Category { subcatsFetched: false, level: $level})
CALL apoc.load.json('https://en.wikipedia.org/w/api.php?format=json&amp;action=query&amp;list=categorymembers&amp;cmtype=subcat&amp;cmtitle=Category apoc.text.urlencode(c.catName) + '&amp;cmprop=ids%7Ctitle&amp;cmlimit=500')
YIELD value as results
UNWIND results.query.categorymembers AS subcat
MERGE (sc:Category {catId: subcat.pageid})
ON CREATE SET sc.catName = substring(subcat.title,9),
 sc.subcatsFetched = false,
 sc.pagesFetched = false,
 sc.level = $level + 1
WITH sc,c
CALL apoc.create.addLabels(sc,['Level' + ($level + 1) + 'Category']) YIELD node
MERGE (sc)-[:SUBCAT_OF]-&gt;(c)
WITH DISTINCT c
SET c.subcatsFetched = true", { level: level }) YIELD value
RETURN value
//load the pages in a similar way
UNWIND range(0,4) as level
CALL apoc.cypher.doIt("
MATCH (c:Category { pagesFetched: false, level: $level })
CALL apoc.load.json('https://en.wikipedia.org/w/api.php?format=json&amp;action=query&amp;list=categorymembers&amp;cmtype=page&amp;cmtitle=Category apoc.text.urlencode(c.catName) + '&amp;cmprop=ids%7Ctitle&amp;cmlimit=500')
YIELD value as results
UNWIND results.query.categorymembers AS page
MERGE (p:Page {pageId: page.pageid})
ON CREATE SET p.pageTitle = page.title, p.pageUrl = 'http://en.wikipedia.org/wiki/' + apoc.text.urlencode(replace(page.title, ' ', '_'))
WITH p,c
MERGE (p)-[:IN_CATEGORY]-&gt;(c)
WITH DISTINCT c
SET c.pagesFetched = true", { level: level }) yield value
return value
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17"><span class="section-number-3">5.3</span> Approach 2: Batch loading the data with LOAD CSV from an SQL dump</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>basics</li>
</ul>
<p>
wiki page structure:
<a href="https://en.wikipedia.org/wiki/Category:Graph_databases">https://en.wikipedia.org/wiki/Category:Graph_databases</a>
</p>

<p>
Category:Graph databases
From Wikipedia, the free encyclopedia
</p>

<p>
Subcategories
This category has only the following subcategory.
R
► Resource Description Framework‎ (5 C, 24 P)
</p>

<p>
Pages in category "Graph databases"
The following 15 pages are in this category, out of 15 total. This list may not reflect recent changes (learn more).
</p>

<p>
Graph database
A
AllegroGraph
ArangoDB
C
Cypher Query Language
D
DataStax
Sparksee (graph database)
F
FlockDB
G
GRAKN.AI
I
InfiniteGraph
L
Linkurious
M
Mulgara (software)
N
Neo4j
O
Oracle Spatial and Graph
OrientDB
S
Sones GraphDB
</p>

<p>
Categories: Types of databasesGraph theory
</p>


<ul class="org-ul">
<li>steps</li>
</ul>
<p>
loop the level of categories
</p>

<p>
different colors on each level of categories
</p>

<ul class="org-ul">
<li>category content sample:</li>
</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">category id</td>
<td class="org-left">category</td>
<td class="org-left">category name</td>
<td class="org-left">page count</td>
<td class="org-left">sub-category count</td>
</tr>

<tr>
<td class="org-left">"895945",</td>
<td class="org-left">"3",</td>
<td class="org-left">"Computer<sub>storage</sub><sub>devices</sub>",</td>
<td class="org-left">"86",</td>
<td class="org-left">"10"</td>
</tr>
</tbody>
</table>


<p>
wiki API
</p>

<p>
categorymembers
</p>

<p>
pageid
</p>

<p>
name space
</p>

<p>
title
</p>

<p>
root category
sub category
</p>
</div>
</div>
</div>
</div>
</body>
</html>
